"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getAndroidPlatformAndPath = getAndroidPlatformAndPath;
exports.unzipFile = unzipFile;
exports.getIMEListFromOutput = getIMEListFromOutput;
exports.isShowingLockscreen = isShowingLockscreen;
exports.isCurrentFocusOnKeyguard = isCurrentFocusOnKeyguard;
exports.getSurfaceOrientation = getSurfaceOrientation;
exports.isScreenOnFully = isScreenOnFully;
exports.buildStartCmd = buildStartCmd;
exports.getJavaHome = getJavaHome;
exports.getApksignerForOs = getApksignerForOs;
exports.getApkanalyzerForOs = getApkanalyzerForOs;
exports.buildInstallArgs = buildInstallArgs;
exports.parseManifest = parseManifest;
exports.parseAaptStrings = parseAaptStrings;
exports.parseAapt2Strings = parseAapt2Strings;
exports.formatConfigMarker = formatConfigMarker;
exports.DEFAULT_ADB_EXEC_TIMEOUT = exports.APK_EXTENSION = exports.APKS_INSTALL_TIMEOUT = exports.APK_INSTALL_TIMEOUT = exports.APKS_EXTENSION = exports.extractMatchingPermissions = exports.getOpenSslForOs = exports.getBuildToolsDirs = exports.getSdkToolsVersion = exports.rootDir = exports.getJavaForOs = void 0;

require("source-map-support/register");

var _path = _interopRequireDefault(require("path"));

var _appiumSupport = require("appium-support");

var _logger = _interopRequireDefault(require("./logger.js"));

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _semver = _interopRequireDefault(require("semver"));

var _xmldom = _interopRequireDefault(require("xmldom"));

var _xpath = _interopRequireDefault(require("xpath"));

var _os = _interopRequireDefault(require("os"));

const rootDir = _path.default.resolve(__dirname, process.env.NO_PRECOMPILE ? '..' : '../..');

exports.rootDir = rootDir;
const APKS_EXTENSION = '.apks';
exports.APKS_EXTENSION = APKS_EXTENSION;
const APK_EXTENSION = '.apk';
exports.APK_EXTENSION = APK_EXTENSION;
const APK_INSTALL_TIMEOUT = 60000;
exports.APK_INSTALL_TIMEOUT = APK_INSTALL_TIMEOUT;
const APKS_INSTALL_TIMEOUT = APK_INSTALL_TIMEOUT * 2;
exports.APKS_INSTALL_TIMEOUT = APKS_INSTALL_TIMEOUT;
const DEFAULT_ADB_EXEC_TIMEOUT = 20000;
exports.DEFAULT_ADB_EXEC_TIMEOUT = DEFAULT_ADB_EXEC_TIMEOUT;

async function getAndroidPlatformAndPath() {
  const sdkRoot = process.env.ANDROID_HOME || process.env.ANDROID_SDK_ROOT;

  if (_lodash.default.isEmpty(sdkRoot)) {
    throw new Error('Neither ANDROID_HOME nor ANDROID_SDK_ROOT environment variable was exported');
  }

  let propsPaths = await _appiumSupport.fs.glob(_path.default.resolve(sdkRoot, 'platforms', '*', 'build.prop'), {
    absolute: true
  });
  const platformsMapping = {};

  for (const propsPath of propsPaths) {
    const propsContent = await _appiumSupport.fs.readFile(propsPath, 'utf-8');

    const platformPath = _path.default.dirname(propsPath);

    const platform = _path.default.basename(platformPath);

    const match = /ro\.build\.version\.sdk=(\d+)/.exec(propsContent);

    if (!match) {
      _logger.default.warn(`Cannot read the SDK version from '${propsPath}'. Skipping '${platform}'`);

      continue;
    }

    platformsMapping[parseInt(match[1], 10)] = {
      platform,
      platformPath
    };
  }

  if (_lodash.default.isEmpty(platformsMapping)) {
    _logger.default.warn(`Found zero platform folders at '${_path.default.resolve(sdkRoot, 'platforms')}'. ` + `Do you have any Android SDKs installed?`);

    return {
      platform: null,
      platformPath: null
    };
  }

  const recentSdkVersion = _lodash.default.keys(platformsMapping).sort().reverse()[0];

  const result = platformsMapping[recentSdkVersion];

  _logger.default.debug(`Found the most recent Android platform: ${JSON.stringify(result)}`);

  return result;
}

async function unzipFile(zipPath, dstRoot = _path.default.dirname(zipPath)) {
  _logger.default.debug(`Unzipping '${zipPath}' to '${dstRoot}'`);

  await _appiumSupport.zip.assertValidZip(zipPath);
  await _appiumSupport.zip.extractAllTo(zipPath, dstRoot);

  _logger.default.debug('Unzip successful');
}

function getIMEListFromOutput(stdout) {
  let engines = [];

  for (let line of stdout.split('\n')) {
    if (line.length > 0 && line[0] !== ' ') {
      engines.push(line.trim().replace(/:$/, ''));
    }
  }

  return engines;
}

const getJavaForOs = _lodash.default.memoize(() => {
  return _path.default.resolve(getJavaHome(), 'bin', `java${_appiumSupport.system.isWindows() ? '.exe' : ''}`);
});

exports.getJavaForOs = getJavaForOs;

const getOpenSslForOs = async function () {
  const binaryName = `openssl${_appiumSupport.system.isWindows() ? '.exe' : ''}`;

  try {
    return await _appiumSupport.fs.which(binaryName);
  } catch (err) {
    throw new Error('The openssl tool must be installed on the system and available on the path');
  }
};

exports.getOpenSslForOs = getOpenSslForOs;

function getJavaHome() {
  if (process.env.JAVA_HOME) {
    return process.env.JAVA_HOME;
  }

  throw new Error('JAVA_HOME is not set currently. Please set JAVA_HOME.');
}

async function getApksignerForOs(sysHelpers) {
  return await sysHelpers.getBinaryFromSdkRoot('apksigner');
}

async function getApkanalyzerForOs(sysHelpers) {
  return await sysHelpers.getBinaryFromSdkRoot('apkanalyzer');
}

function isShowingLockscreen(dumpsys) {
  return /(mShowingLockscreen=true|mDreamingLockscreen=true)/gi.test(dumpsys);
}

function isCurrentFocusOnKeyguard(dumpsys) {
  let m = /mCurrentFocus.+Keyguard/gi.exec(dumpsys);
  return m && m.length && m[0] ? true : false;
}

function getSurfaceOrientation(dumpsys) {
  let m = /SurfaceOrientation: \d/gi.exec(dumpsys);
  return m && parseInt(m[0].split(':')[1], 10);
}

function isScreenOnFully(dumpsys) {
  let m = /mScreenOnFully=\w+/gi.exec(dumpsys);
  return !m || m && m.length > 0 && m[0].split('=')[1] === 'true' || false;
}

function buildStartCmd(startAppOptions, apiLevel) {
  const {
    user,
    waitForLaunch,
    pkg,
    activity,
    action,
    category,
    stopApp,
    flags
  } = startAppOptions;
  const cmd = ['am', 'start'];

  if (_appiumSupport.util.hasValue(user)) {
    cmd.push('--user', user);
  }

  if (waitForLaunch) {
    cmd.push('-W');
  }

  cmd.push('-n', `${pkg}/${activity}`);

  if (stopApp && apiLevel >= 15) {
    cmd.push('-S');
  }

  if (action) {
    cmd.push('-a', action);
  }

  if (category) {
    cmd.push('-c', category);
  }

  if (flags) {
    cmd.push('-f', flags);
  }

  if (startAppOptions.optionalIntentArguments) {
    let parseKeyValue = function (str) {
      str = str.trim();
      let space = str.indexOf(' ');

      if (space === -1) {
        return str.length ? [str] : [];
      } else {
        return [str.substring(0, space).trim(), str.substring(space + 1).trim()];
      }
    };

    let optionalIntentArguments = ` ${startAppOptions.optionalIntentArguments}`;
    let re = / (-[^\s]+) (.+)/;

    while (true) {
      let args = re.exec(optionalIntentArguments);

      if (!args) {
        if (optionalIntentArguments.length) {
          cmd.push.apply(cmd, parseKeyValue(optionalIntentArguments));
        }

        break;
      }

      let flag = args[1];
      let flagPos = optionalIntentArguments.indexOf(flag);

      if (flagPos !== 0) {
        let prevArgs = optionalIntentArguments.substring(0, flagPos);
        cmd.push.apply(cmd, parseKeyValue(prevArgs));
      }

      cmd.push(flag);
      optionalIntentArguments = args[2];
    }
  }

  return cmd;
}

const getSdkToolsVersion = _lodash.default.memoize(async function getSdkToolsVersion() {
  const androidHome = process.env.ANDROID_HOME;

  if (!androidHome) {
    throw new Error('ANDROID_HOME environment variable is expected to be set');
  }

  const propertiesPath = _path.default.resolve(androidHome, 'tools', 'source.properties');

  if (!(await _appiumSupport.fs.exists(propertiesPath))) {
    _logger.default.warn(`Cannot find ${propertiesPath} file to read SDK version from`);

    return;
  }

  const propertiesContent = await _appiumSupport.fs.readFile(propertiesPath, 'utf8');
  const versionMatcher = new RegExp(/Pkg\.Revision=(\d+)\.?(\d+)?\.?(\d+)?/);
  const match = versionMatcher.exec(propertiesContent);

  if (match) {
    return {
      major: parseInt(match[1], 10),
      minor: match[2] ? parseInt(match[2], 10) : 0,
      build: match[3] ? parseInt(match[3], 10) : 0
    };
  }

  _logger.default.warn(`Cannot parse "Pkg.Revision" value from ${propertiesPath}`);
});

exports.getSdkToolsVersion = getSdkToolsVersion;

const getBuildToolsDirs = _lodash.default.memoize(async function getBuildToolsDirs(sdkRoot) {
  let buildToolsDirs = await _appiumSupport.fs.glob(_path.default.resolve(sdkRoot, 'build-tools', '*'), {
    absolute: true
  });

  try {
    buildToolsDirs = buildToolsDirs.map(dir => [_path.default.basename(dir), dir]).sort((a, b) => _semver.default.rcompare(a[0], b[0])).map(pair => pair[1]);
  } catch (err) {
    _logger.default.warn(`Cannot sort build-tools folders ${JSON.stringify(buildToolsDirs.map(dir => _path.default.basename(dir)))} ` + `by semantic version names.`);

    _logger.default.warn(`Falling back to sorting by modification date. Original error: ${err.message}`);

    const pairs = await _bluebird.default.map(buildToolsDirs, async dir => [(await _appiumSupport.fs.stat(dir)).mtime.valueOf(), dir]);
    buildToolsDirs = pairs.sort((a, b) => a[0] < b[0]).map(pair => pair[1]);
  }

  _logger.default.info(`Found ${buildToolsDirs.length} 'build-tools' folders under '${sdkRoot}' (newest first):`);

  for (let dir of buildToolsDirs) {
    _logger.default.info(`    ${dir}`);
  }

  return buildToolsDirs;
});

exports.getBuildToolsDirs = getBuildToolsDirs;

const extractMatchingPermissions = function (dumpsysOutput, groupNames, grantedState = null) {
  const groupPatternByName = groupName => new RegExp(`^(\\s*${_lodash.default.escapeRegExp(groupName)} permissions:[\\s\\S]+)`, 'm');

  const indentPattern = /\S|$/;
  const permissionNamePattern = /android\.permission\.\w+/;
  const grantedStatePattern = /\bgranted=(\w+)/;
  const result = [];

  for (const groupName of groupNames) {
    const groupMatch = groupPatternByName(groupName).exec(dumpsysOutput);

    if (!groupMatch) {
      continue;
    }

    const lines = groupMatch[1].split('\n');

    if (lines.length < 2) {
      continue;
    }

    const titleIndent = lines[0].search(indentPattern);

    for (const line of lines.slice(1)) {
      const currentIndent = line.search(indentPattern);

      if (currentIndent <= titleIndent) {
        break;
      }

      const permissionNameMatch = permissionNamePattern.exec(line);

      if (!permissionNameMatch) {
        continue;
      }

      const item = {
        permission: permissionNameMatch[0]
      };
      const grantedStateMatch = grantedStatePattern.exec(line);

      if (grantedStateMatch) {
        item.granted = grantedStateMatch[1] === 'true';
      }

      result.push(item);
    }
  }

  const filteredResult = result.filter(item => !_lodash.default.isBoolean(grantedState) || item.granted === grantedState).map(item => item.permission);

  _logger.default.debug(`Retrieved ${filteredResult.length} permission(s) from ${JSON.stringify(groupNames)} group(s)`);

  return filteredResult;
};

exports.extractMatchingPermissions = extractMatchingPermissions;

function buildInstallArgs(apiLevel, options = {}) {
  const result = [];

  if (!_appiumSupport.util.hasValue(options.replace) || options.replace) {
    result.push('-r');
  }

  if (options.allowTestPackages) {
    result.push('-t');
  }

  if (options.useSdcard) {
    result.push('-s');
  }

  if (options.grantPermissions) {
    if (apiLevel < 23) {
      _logger.default.debug(`Skipping permissions grant option, since ` + `the current API level ${apiLevel} does not support applications ` + `permissions customization`);
    } else {
      result.push('-g');
    }
  }

  return result;
}

function parseManifest(manifestXml) {
  const doc = new _xmldom.default.DOMParser().parseFromString(manifestXml);
  const documentElement = doc.documentElement;
  const result = {
    pkg: documentElement.getAttribute('package'),
    versionCode: parseInt(documentElement.getAttribute('android:versionCode'), 10),
    versionName: documentElement.getAttribute('android:versionName')
  };

  const apkActivityAttribute = _xpath.default.select1("//application/*[starts-with(name(), 'activity') " + "and (not(@*[local-name()='enabled']) or @*[local-name()='enabled' and .='true']) " + "and .//action[@*[local-name()='name' and .='android.intent.action.MAIN']] " + "and .//category[@*[local-name()='name' and .='android.intent.category.LAUNCHER']]]" + "/@*[local-name()='name']", doc);

  if (apkActivityAttribute) {
    result.activity = apkActivityAttribute.value;
  }

  return result;
}

function parseAaptStrings(rawOutput, configMarker) {
  const normalizeStringMatch = function (s) {
    return s.replace(/"$/, '').replace(/^"/, '').replace(/\\"/g, '"');
  };

  const apkStrings = {};
  let isInConfig = false;
  let currentResourceId = null;
  let isInPluralGroup = false;
  const quotedStringPattern = /"[^"\\]*(?:\\.[^"\\]*)*"/;

  for (const line of rawOutput.split(_os.default.EOL)) {
    const trimmedLine = line.trim();

    if (_lodash.default.isEmpty(trimmedLine)) {
      continue;
    }

    if (['config', 'type', 'spec', 'Package'].some(x => trimmedLine.startsWith(x))) {
      isInConfig = trimmedLine.startsWith(`config ${configMarker}:`);
      currentResourceId = null;
      isInPluralGroup = false;
      continue;
    }

    if (!isInConfig) {
      continue;
    }

    if (trimmedLine.startsWith('resource')) {
      isInPluralGroup = false;
      currentResourceId = null;

      if (trimmedLine.includes(':string/')) {
        const match = /:string\/(\S+):/.exec(trimmedLine);

        if (match) {
          currentResourceId = match[1];
        }
      } else if (trimmedLine.includes(':plurals/')) {
        const match = /:plurals\/(\S+):/.exec(trimmedLine);

        if (match) {
          currentResourceId = match[1];
          isInPluralGroup = true;
        }
      }

      continue;
    }

    if (currentResourceId && trimmedLine.startsWith('(string')) {
      const match = quotedStringPattern.exec(trimmedLine);

      if (match) {
        apkStrings[currentResourceId] = normalizeStringMatch(match[0]);
      }

      currentResourceId = null;
      continue;
    }

    if (currentResourceId && isInPluralGroup && trimmedLine.includes(': (string')) {
      const match = quotedStringPattern.exec(trimmedLine);

      if (match) {
        apkStrings[currentResourceId] = [...(apkStrings[currentResourceId] || []), normalizeStringMatch(match[0])];
      }

      continue;
    }
  }

  return apkStrings;
}

function parseAapt2Strings(rawOutput, configMarker) {
  const allLines = rawOutput.split(_os.default.EOL);

  function extractContent(startIdx) {
    let idx = startIdx;
    const startCharPos = allLines[startIdx].indexOf('"');

    if (startCharPos < 0) {
      return [null, idx];
    }

    let result = '';

    while (idx < allLines.length) {
      const terminationCharMatch = /"$/.exec(allLines[idx]);

      if (terminationCharMatch) {
        const terminationCharPos = terminationCharMatch.index;

        if (startIdx === idx) {
          return [allLines[idx].substring(startCharPos + 1, terminationCharPos), idx];
        }

        return [`${result}\\n${_lodash.default.trimStart(allLines[idx].substring(0, terminationCharPos))}`, idx];
      }

      if (idx > startIdx) {
        result += `\\n${_lodash.default.trimStart(allLines[idx])}`;
      } else {
        result += allLines[idx].substring(startCharPos + 1);
      }

      ++idx;
    }

    return [result, idx];
  }

  const apkStrings = {};
  let currentResourceId = null;
  let isInPluralGroup = false;
  let isInCurrentConfig = false;
  let lineIndex = 0;

  while (lineIndex < allLines.length) {
    const trimmedLine = allLines[lineIndex].trim();

    if (_lodash.default.isEmpty(trimmedLine)) {
      ++lineIndex;
      continue;
    }

    if (['type', 'Package'].some(x => trimmedLine.startsWith(x))) {
      currentResourceId = null;
      isInPluralGroup = false;
      isInCurrentConfig = false;
      ++lineIndex;
      continue;
    }

    if (trimmedLine.startsWith('resource')) {
      isInPluralGroup = false;
      currentResourceId = null;
      isInCurrentConfig = false;

      if (trimmedLine.includes('string/')) {
        const match = /string\/(\S+)/.exec(trimmedLine);

        if (match) {
          currentResourceId = match[1];
        }
      } else if (trimmedLine.includes('plurals/')) {
        const match = /plurals\/(\S+)/.exec(trimmedLine);

        if (match) {
          currentResourceId = match[1];
          isInPluralGroup = true;
        }
      }

      ++lineIndex;
      continue;
    }

    if (currentResourceId) {
      if (isInPluralGroup) {
        if (trimmedLine.startsWith('(')) {
          isInCurrentConfig = trimmedLine.startsWith(`(${configMarker})`);
          ++lineIndex;
          continue;
        }

        if (isInCurrentConfig) {
          const [content, idx] = extractContent(lineIndex);
          lineIndex = idx;

          if (_lodash.default.isString(content)) {
            apkStrings[currentResourceId] = [...(apkStrings[currentResourceId] || []), content];
          }
        }
      } else if (trimmedLine.startsWith(`(${configMarker})`)) {
        const [content, idx] = extractContent(lineIndex);
        lineIndex = idx;

        if (_lodash.default.isString(content)) {
          apkStrings[currentResourceId] = content;
        }

        currentResourceId = null;
      }
    }

    ++lineIndex;
  }

  return apkStrings;
}

async function formatConfigMarker(configsGetter, desiredMarker, defaultMarker) {
  let configMarker = desiredMarker || defaultMarker;

  if (configMarker.includes('-') && !configMarker.includes('-r')) {
    configMarker = configMarker.replace('-', '-r');
  }

  if (configMarker.toLowerCase().startsWith('en')) {
    if (!(await configsGetter()).map(x => x.trim()).includes(configMarker)) {
      _logger.default.debug(`There is no '${configMarker}' configuration. ` + `Replacing it with '${defaultMarker || 'default'}'`);

      configMarker = defaultMarker;
    }
  }

  return configMarker;
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9oZWxwZXJzLmpzIl0sIm5hbWVzIjpbInJvb3REaXIiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsInByb2Nlc3MiLCJlbnYiLCJOT19QUkVDT01QSUxFIiwiQVBLU19FWFRFTlNJT04iLCJBUEtfRVhURU5TSU9OIiwiQVBLX0lOU1RBTExfVElNRU9VVCIsIkFQS1NfSU5TVEFMTF9USU1FT1VUIiwiREVGQVVMVF9BREJfRVhFQ19USU1FT1VUIiwiZ2V0QW5kcm9pZFBsYXRmb3JtQW5kUGF0aCIsInNka1Jvb3QiLCJBTkRST0lEX0hPTUUiLCJBTkRST0lEX1NES19ST09UIiwiXyIsImlzRW1wdHkiLCJFcnJvciIsInByb3BzUGF0aHMiLCJmcyIsImdsb2IiLCJhYnNvbHV0ZSIsInBsYXRmb3Jtc01hcHBpbmciLCJwcm9wc1BhdGgiLCJwcm9wc0NvbnRlbnQiLCJyZWFkRmlsZSIsInBsYXRmb3JtUGF0aCIsImRpcm5hbWUiLCJwbGF0Zm9ybSIsImJhc2VuYW1lIiwibWF0Y2giLCJleGVjIiwibG9nIiwid2FybiIsInBhcnNlSW50IiwicmVjZW50U2RrVmVyc2lvbiIsImtleXMiLCJzb3J0IiwicmV2ZXJzZSIsInJlc3VsdCIsImRlYnVnIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuemlwRmlsZSIsInppcFBhdGgiLCJkc3RSb290IiwiemlwIiwiYXNzZXJ0VmFsaWRaaXAiLCJleHRyYWN0QWxsVG8iLCJnZXRJTUVMaXN0RnJvbU91dHB1dCIsInN0ZG91dCIsImVuZ2luZXMiLCJsaW5lIiwic3BsaXQiLCJsZW5ndGgiLCJwdXNoIiwidHJpbSIsInJlcGxhY2UiLCJnZXRKYXZhRm9yT3MiLCJtZW1vaXplIiwiZ2V0SmF2YUhvbWUiLCJzeXN0ZW0iLCJpc1dpbmRvd3MiLCJnZXRPcGVuU3NsRm9yT3MiLCJiaW5hcnlOYW1lIiwid2hpY2giLCJlcnIiLCJKQVZBX0hPTUUiLCJnZXRBcGtzaWduZXJGb3JPcyIsInN5c0hlbHBlcnMiLCJnZXRCaW5hcnlGcm9tU2RrUm9vdCIsImdldEFwa2FuYWx5emVyRm9yT3MiLCJpc1Nob3dpbmdMb2Nrc2NyZWVuIiwiZHVtcHN5cyIsInRlc3QiLCJpc0N1cnJlbnRGb2N1c09uS2V5Z3VhcmQiLCJtIiwiZ2V0U3VyZmFjZU9yaWVudGF0aW9uIiwiaXNTY3JlZW5PbkZ1bGx5IiwiYnVpbGRTdGFydENtZCIsInN0YXJ0QXBwT3B0aW9ucyIsImFwaUxldmVsIiwidXNlciIsIndhaXRGb3JMYXVuY2giLCJwa2ciLCJhY3Rpdml0eSIsImFjdGlvbiIsImNhdGVnb3J5Iiwic3RvcEFwcCIsImZsYWdzIiwiY21kIiwidXRpbCIsImhhc1ZhbHVlIiwib3B0aW9uYWxJbnRlbnRBcmd1bWVudHMiLCJwYXJzZUtleVZhbHVlIiwic3RyIiwic3BhY2UiLCJpbmRleE9mIiwic3Vic3RyaW5nIiwicmUiLCJhcmdzIiwiYXBwbHkiLCJmbGFnIiwiZmxhZ1BvcyIsInByZXZBcmdzIiwiZ2V0U2RrVG9vbHNWZXJzaW9uIiwiYW5kcm9pZEhvbWUiLCJwcm9wZXJ0aWVzUGF0aCIsImV4aXN0cyIsInByb3BlcnRpZXNDb250ZW50IiwidmVyc2lvbk1hdGNoZXIiLCJSZWdFeHAiLCJtYWpvciIsIm1pbm9yIiwiYnVpbGQiLCJnZXRCdWlsZFRvb2xzRGlycyIsImJ1aWxkVG9vbHNEaXJzIiwibWFwIiwiZGlyIiwiYSIsImIiLCJzZW12ZXIiLCJyY29tcGFyZSIsInBhaXIiLCJtZXNzYWdlIiwicGFpcnMiLCJCIiwic3RhdCIsIm10aW1lIiwidmFsdWVPZiIsImluZm8iLCJleHRyYWN0TWF0Y2hpbmdQZXJtaXNzaW9ucyIsImR1bXBzeXNPdXRwdXQiLCJncm91cE5hbWVzIiwiZ3JhbnRlZFN0YXRlIiwiZ3JvdXBQYXR0ZXJuQnlOYW1lIiwiZ3JvdXBOYW1lIiwiZXNjYXBlUmVnRXhwIiwiaW5kZW50UGF0dGVybiIsInBlcm1pc3Npb25OYW1lUGF0dGVybiIsImdyYW50ZWRTdGF0ZVBhdHRlcm4iLCJncm91cE1hdGNoIiwibGluZXMiLCJ0aXRsZUluZGVudCIsInNlYXJjaCIsInNsaWNlIiwiY3VycmVudEluZGVudCIsInBlcm1pc3Npb25OYW1lTWF0Y2giLCJpdGVtIiwicGVybWlzc2lvbiIsImdyYW50ZWRTdGF0ZU1hdGNoIiwiZ3JhbnRlZCIsImZpbHRlcmVkUmVzdWx0IiwiZmlsdGVyIiwiaXNCb29sZWFuIiwiYnVpbGRJbnN0YWxsQXJncyIsIm9wdGlvbnMiLCJhbGxvd1Rlc3RQYWNrYWdlcyIsInVzZVNkY2FyZCIsImdyYW50UGVybWlzc2lvbnMiLCJwYXJzZU1hbmlmZXN0IiwibWFuaWZlc3RYbWwiLCJkb2MiLCJ4bWxkb20iLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJkb2N1bWVudEVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJ2ZXJzaW9uQ29kZSIsInZlcnNpb25OYW1lIiwiYXBrQWN0aXZpdHlBdHRyaWJ1dGUiLCJ4cGF0aCIsInNlbGVjdDEiLCJ2YWx1ZSIsInBhcnNlQWFwdFN0cmluZ3MiLCJyYXdPdXRwdXQiLCJjb25maWdNYXJrZXIiLCJub3JtYWxpemVTdHJpbmdNYXRjaCIsInMiLCJhcGtTdHJpbmdzIiwiaXNJbkNvbmZpZyIsImN1cnJlbnRSZXNvdXJjZUlkIiwiaXNJblBsdXJhbEdyb3VwIiwicXVvdGVkU3RyaW5nUGF0dGVybiIsIm9zIiwiRU9MIiwidHJpbW1lZExpbmUiLCJzb21lIiwieCIsInN0YXJ0c1dpdGgiLCJpbmNsdWRlcyIsInBhcnNlQWFwdDJTdHJpbmdzIiwiYWxsTGluZXMiLCJleHRyYWN0Q29udGVudCIsInN0YXJ0SWR4IiwiaWR4Iiwic3RhcnRDaGFyUG9zIiwidGVybWluYXRpb25DaGFyTWF0Y2giLCJ0ZXJtaW5hdGlvbkNoYXJQb3MiLCJpbmRleCIsInRyaW1TdGFydCIsImlzSW5DdXJyZW50Q29uZmlnIiwibGluZUluZGV4IiwiY29udGVudCIsImlzU3RyaW5nIiwiZm9ybWF0Q29uZmlnTWFya2VyIiwiY29uZmlnc0dldHRlciIsImRlc2lyZWRNYXJrZXIiLCJkZWZhdWx0TWFya2VyIiwi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QixJQUF0QixDQUFuQyxFQUFnRTtBQUM5RGQsSUFBQUEsWUFBWSxHQUFHQSxZQUFZLENBQUN2SCxPQUFiLENBQXFCLEdBQXJCLEVBQTBCLElBQTFCLENBQWY7QUFDRDs7QUFDRCxNQUFJdUgsWUFBWSxDQUFDaUMsV0FBYixHQUEyQnBCLFVBQTNCLENBQXNDLElBQXRDLENBQUosRUFBaUQ7QUFFL0MsUUFBSSxDQUFDLENBQUMsTUFBTWlCLGFBQWEsRUFBcEIsRUFBd0J6RixHQUF4QixDQUE2QnVFLENBQUQsSUFBT0EsQ0FBQyxDQUFDcEksSUFBRixFQUFuQyxFQUE2Q3NJLFFBQTdDLENBQXNEZCxZQUF0RCxDQUFMLEVBQTBFO0FBQ3hFaEosc0JBQUlRLEtBQUosQ0FBVyxnQkFBZXdJLFlBQWEsbUJBQTdCLEdBQ1Asc0JBQXFCZ0MsYUFBYSxJQUFJLFNBQVUsR0FEbkQ7O0FBRUFoQyxNQUFBQSxZQUFZLEdBQUdnQyxhQUFmO0FBQ0Q7QUFDRjs7QUFDRCxTQUFPaEMsWUFBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBzeXN0ZW0sIGZzLCB6aXAsIHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgbG9nIGZyb20gJy4vbG9nZ2VyLmpzJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7XG5pbXBvcnQgeG1sZG9tIGZyb20gJ3htbGRvbSc7XG5pbXBvcnQgeHBhdGggZnJvbSAneHBhdGgnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcblxuY29uc3Qgcm9vdERpciA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIHByb2Nlc3MuZW52Lk5PX1BSRUNPTVBJTEUgPyAnLi4nIDogJy4uLy4uJyk7XG5jb25zdCBBUEtTX0VYVEVOU0lPTiA9ICcuYXBrcyc7XG5jb25zdCBBUEtfRVhURU5TSU9OID0gJy5hcGsnO1xuY29uc3QgQVBLX0lOU1RBTExfVElNRU9VVCA9IDYwMDAwO1xuY29uc3QgQVBLU19JTlNUQUxMX1RJTUVPVVQgPSBBUEtfSU5TVEFMTF9USU1FT1VUICogMjtcbmNvbnN0IERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCA9IDIwMDAwOyAvLyBpbiBtaWxsaXNlY29uZHNcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBQbGF0Zm9ybUluZm9cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gcGxhdGZvcm0gLSBUaGUgcGxhdGZvcm0gbmFtZSwgZm9yIGV4YW1wbGUgYGFuZHJvaWQtMjRgXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgYG51bGxgIGlmIGl0IGNhbm5vdCBiZSBmb3VuZFxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBwbGF0Zm9ybVBhdGggLSBGdWxsIHBhdGggdG8gdGhlIHBsYXRmb3JtIFNESyBmb2xkZXJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3IgYG51bGxgIGlmIGl0IGNhbm5vdCBiZSBmb3VuZFxuICovXG5cbi8qKlxuICogUmV0cmlldmUgdGhlIHBhdGggdG8gdGhlIHJlY2VudCBpbnN0YWxsZWQgQW5kcm9pZCBwbGF0Zm9ybS5cbiAqXG4gKiBAcmV0dXJuIHtQbGF0Zm9ybUluZm99IFRoZSByZXN1bHRpbmcgcGF0aCB0byB0aGUgbmV3ZXN0IGluc3RhbGxlZCBwbGF0Zm9ybS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0QW5kcm9pZFBsYXRmb3JtQW5kUGF0aCAoKSB7XG4gIGNvbnN0IHNka1Jvb3QgPSBwcm9jZXNzLmVudi5BTkRST0lEX0hPTUUgfHwgcHJvY2Vzcy5lbnYuQU5EUk9JRF9TREtfUk9PVDtcbiAgaWYgKF8uaXNFbXB0eShzZGtSb290KSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTmVpdGhlciBBTkRST0lEX0hPTUUgbm9yIEFORFJPSURfU0RLX1JPT1QgZW52aXJvbm1lbnQgdmFyaWFibGUgd2FzIGV4cG9ydGVkJyk7XG4gIH1cblxuICBsZXQgcHJvcHNQYXRocyA9IGF3YWl0IGZzLmdsb2IocGF0aC5yZXNvbHZlKHNka1Jvb3QsICdwbGF0Zm9ybXMnLCAnKicsICdidWlsZC5wcm9wJyksIHtcbiAgICBhYnNvbHV0ZTogdHJ1ZVxuICB9KTtcbiAgY29uc3QgcGxhdGZvcm1zTWFwcGluZyA9IHt9O1xuICBmb3IgKGNvbnN0IHByb3BzUGF0aCBvZiBwcm9wc1BhdGhzKSB7XG4gICAgY29uc3QgcHJvcHNDb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUocHJvcHNQYXRoLCAndXRmLTgnKTtcbiAgICBjb25zdCBwbGF0Zm9ybVBhdGggPSBwYXRoLmRpcm5hbWUocHJvcHNQYXRoKTtcbiAgICBjb25zdCBwbGF0Zm9ybSA9IHBhdGguYmFzZW5hbWUocGxhdGZvcm1QYXRoKTtcbiAgICBjb25zdCBtYXRjaCA9IC9yb1xcLmJ1aWxkXFwudmVyc2lvblxcLnNkaz0oXFxkKykvLmV4ZWMocHJvcHNDb250ZW50KTtcbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdGhlIFNESyB2ZXJzaW9uIGZyb20gJyR7cHJvcHNQYXRofScuIFNraXBwaW5nICcke3BsYXRmb3JtfSdgKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBwbGF0Zm9ybXNNYXBwaW5nW3BhcnNlSW50KG1hdGNoWzFdLCAxMCldID0ge1xuICAgICAgcGxhdGZvcm0sXG4gICAgICBwbGF0Zm9ybVBhdGgsXG4gICAgfTtcbiAgfVxuICBpZiAoXy5pc0VtcHR5KHBsYXRmb3Jtc01hcHBpbmcpKSB7XG4gICAgbG9nLndhcm4oYEZvdW5kIHplcm8gcGxhdGZvcm0gZm9sZGVycyBhdCAnJHtwYXRoLnJlc29sdmUoc2RrUm9vdCwgJ3BsYXRmb3JtcycpfScuIGAgK1xuICAgICAgYERvIHlvdSBoYXZlIGFueSBBbmRyb2lkIFNES3MgaW5zdGFsbGVkP2ApO1xuICAgIHJldHVybiB7XG4gICAgICBwbGF0Zm9ybTogbnVsbCxcbiAgICAgIHBsYXRmb3JtUGF0aDogbnVsbCxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcmVjZW50U2RrVmVyc2lvbiA9IF8ua2V5cyhwbGF0Zm9ybXNNYXBwaW5nKS5zb3J0KCkucmV2ZXJzZSgpWzBdO1xuICBjb25zdCByZXN1bHQgPSBwbGF0Zm9ybXNNYXBwaW5nW3JlY2VudFNka1ZlcnNpb25dO1xuICBsb2cuZGVidWcoYEZvdW5kIHRoZSBtb3N0IHJlY2VudCBBbmRyb2lkIHBsYXRmb3JtOiAke0pTT04uc3RyaW5naWZ5KHJlc3VsdCl9YCk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVuemlwRmlsZSAoemlwUGF0aCwgZHN0Um9vdCA9IHBhdGguZGlybmFtZSh6aXBQYXRoKSkge1xuICBsb2cuZGVidWcoYFVuemlwcGluZyAnJHt6aXBQYXRofScgdG8gJyR7ZHN0Um9vdH0nYCk7XG4gIGF3YWl0IHppcC5hc3NlcnRWYWxpZFppcCh6aXBQYXRoKTtcbiAgYXdhaXQgemlwLmV4dHJhY3RBbGxUbyh6aXBQYXRoLCBkc3RSb290KTtcbiAgbG9nLmRlYnVnKCdVbnppcCBzdWNjZXNzZnVsJyk7XG59XG5cbmZ1bmN0aW9uIGdldElNRUxpc3RGcm9tT3V0cHV0IChzdGRvdXQpIHtcbiAgbGV0IGVuZ2luZXMgPSBbXTtcbiAgZm9yIChsZXQgbGluZSBvZiBzdGRvdXQuc3BsaXQoJ1xcbicpKSB7XG4gICAgaWYgKGxpbmUubGVuZ3RoID4gMCAmJiBsaW5lWzBdICE9PSAnICcpIHtcbiAgICAgIC8vIHJlbW92ZSBuZXdsaW5lIGFuZCB0cmFpbGluZyBjb2xvbiwgYW5kIGFkZCB0byB0aGUgbGlzdFxuICAgICAgZW5naW5lcy5wdXNoKGxpbmUudHJpbSgpLnJlcGxhY2UoLzokLywgJycpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGVuZ2luZXM7XG59XG5cbmNvbnN0IGdldEphdmFGb3JPcyA9IF8ubWVtb2l6ZSgoKSA9PiB7XG4gIHJldHVybiBwYXRoLnJlc29sdmUoZ2V0SmF2YUhvbWUoKSwgJ2JpbicsIGBqYXZhJHtzeXN0ZW0uaXNXaW5kb3dzKCkgPyAnLmV4ZScgOiAnJ31gKTtcbn0pO1xuXG5jb25zdCBnZXRPcGVuU3NsRm9yT3MgPSBhc3luYyBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGJpbmFyeU5hbWUgPSBgb3BlbnNzbCR7c3lzdGVtLmlzV2luZG93cygpID8gJy5leGUnIDogJyd9YDtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZnMud2hpY2goYmluYXJ5TmFtZSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRocm93IG5ldyBFcnJvcignVGhlIG9wZW5zc2wgdG9vbCBtdXN0IGJlIGluc3RhbGxlZCBvbiB0aGUgc3lzdGVtIGFuZCBhdmFpbGFibGUgb24gdGhlIHBhdGgnKTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0SmF2YUhvbWUgKCkge1xuICBpZiAocHJvY2Vzcy5lbnYuSkFWQV9IT01FKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MuZW52LkpBVkFfSE9NRTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoJ0pBVkFfSE9NRSBpcyBub3Qgc2V0IGN1cnJlbnRseS4gUGxlYXNlIHNldCBKQVZBX0hPTUUuJyk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBhYnNvbHV0ZSBwYXRoIHRvIGFwa3NpZ25lciB0b29sXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHN5c0hlbHBlcnMgLSBBbiBpbnN0YW5jZSBjb250YWluaW5nIHN5c3RlbUNhbGxNZXRob2RzIGhlbHBlciBtZXRob2RzXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBBbiBhYnNvbHV0ZSBwYXRoIHRvIGFwa3NpZ25lciB0b29sLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSB0b29sIGlzIG5vdCBwcmVzZW50IG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0QXBrc2lnbmVyRm9yT3MgKHN5c0hlbHBlcnMpIHtcbiAgcmV0dXJuIGF3YWl0IHN5c0hlbHBlcnMuZ2V0QmluYXJ5RnJvbVNka1Jvb3QoJ2Fwa3NpZ25lcicpO1xufVxuXG4vKipcbiAqIEdldCB0aGUgYWJzb2x1dGUgcGF0aCB0byBhcGthbmFseXplciB0b29sLlxuICogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vc3R1ZGlvL2NvbW1hbmQtbGluZS9hcGthbmFseXplci5odG1sXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHN5c0hlbHBlcnMgLSBBbiBpbnN0YW5jZSBjb250YWluaW5nIHN5c3RlbUNhbGxNZXRob2RzIGhlbHBlciBtZXRob2RzXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBBbiBhYnNvbHV0ZSBwYXRoIHRvIGFwa2FuYWx5emVyIHRvb2wuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIHRvb2wgaXMgbm90IHByZXNlbnQgb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRBcGthbmFseXplckZvck9zIChzeXNIZWxwZXJzKSB7XG4gIHJldHVybiBhd2FpdCBzeXNIZWxwZXJzLmdldEJpbmFyeUZyb21TZGtSb290KCdhcGthbmFseXplcicpO1xufVxuXG4vKipcbiAqIENoZWNrcyBtU2hvd2luZ0xvY2tzY3JlZW4gb3IgbURyZWFtaW5nTG9ja3NjcmVlbiBpbiBkdW1wc3lzIG91dHB1dCB0byBkZXRlcm1pbmVcbiAqIGlmIGxvY2sgc2NyZWVuIGlzIHNob3dpbmdcbiAqXG4gKiBBIG5vdGU6IGBhZGIgc2hlbGwgZHVtcHN5cyB0cnVzdGAgcGVyZm9ybXMgYmV0dGVyIHdoaWxlIGRldGVjdGluZyB0aGUgbG9ja2VkIHNjcmVlbiBzdGF0ZVxuICogaW4gY29tcGFyaXNvbiB0byBgYWRiIGR1bXBzeXMgd2luZG93YCBvdXRwdXQgcGFyc2luZy5cbiAqIEJ1dCB0aGUgdHJ1c3QgY29tbWFuZCBkb2VzIG5vdCB3b3JrIGZvciBgU3dpcGVgIHVubG9jayBwYXR0ZXJuLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBkdW1wc3lzIC0gVGhlIG91dHB1dCBvZiBkdW1wc3lzIHdpbmRvdyBjb21tYW5kLlxuICogQHJldHVybiB7Ym9vbGVhbn0gVHJ1ZSBpZiBsb2NrIHNjcmVlbiBpcyBzaG93aW5nLlxuICovXG5mdW5jdGlvbiBpc1Nob3dpbmdMb2Nrc2NyZWVuIChkdW1wc3lzKSB7XG4gIHJldHVybiAvKG1TaG93aW5nTG9ja3NjcmVlbj10cnVlfG1EcmVhbWluZ0xvY2tzY3JlZW49dHJ1ZSkvZ2kudGVzdChkdW1wc3lzKTtcbn1cblxuLypcbiAqIENoZWNrcyBtQ3VycmVudEZvY3VzIGluIGR1bXBzeXMgb3V0cHV0IHRvIGRldGVybWluZSBpZiBLZXlndWFyZCBpcyBhY3RpdmF0ZWRcbiAqL1xuZnVuY3Rpb24gaXNDdXJyZW50Rm9jdXNPbktleWd1YXJkIChkdW1wc3lzKSB7XG4gIGxldCBtID0gL21DdXJyZW50Rm9jdXMuK0tleWd1YXJkL2dpLmV4ZWMoZHVtcHN5cyk7XG4gIHJldHVybiAobSAmJiBtLmxlbmd0aCAmJiBtWzBdKSA/IHRydWUgOiBmYWxzZTtcbn1cblxuLypcbiAqIFJlYWRzIFN1cmZhY2VPcmllbnRhdGlvbiBpbiBkdW1wc3lzIG91dHB1dFxuICovXG5mdW5jdGlvbiBnZXRTdXJmYWNlT3JpZW50YXRpb24gKGR1bXBzeXMpIHtcbiAgbGV0IG0gPSAvU3VyZmFjZU9yaWVudGF0aW9uOiBcXGQvZ2kuZXhlYyhkdW1wc3lzKTtcbiAgcmV0dXJuIG0gJiYgcGFyc2VJbnQobVswXS5zcGxpdCgnOicpWzFdLCAxMCk7XG59XG5cbi8qXG4gKiBDaGVja3MgbVNjcmVlbk9uRnVsbHkgaW4gZHVtcHN5cyBvdXRwdXQgdG8gZGV0ZXJtaW5lIGlmIHNjcmVlbiBpcyBzaG93aW5nXG4gKiBEZWZhdWx0IGlzIHRydWVcbiAqL1xuZnVuY3Rpb24gaXNTY3JlZW5PbkZ1bGx5IChkdW1wc3lzKSB7XG4gIGxldCBtID0gL21TY3JlZW5PbkZ1bGx5PVxcdysvZ2kuZXhlYyhkdW1wc3lzKTtcbiAgcmV0dXJuICFtIHx8IC8vIGlmIGluZm9ybWF0aW9uIGlzIG1pc3Npbmcgd2UgYXNzdW1lIHNjcmVlbiBpcyBmdWxseSBvblxuICAgICAgICAgKG0gJiYgbS5sZW5ndGggPiAwICYmIG1bMF0uc3BsaXQoJz0nKVsxXSA9PT0gJ3RydWUnKSB8fCBmYWxzZTtcbn1cblxuLyoqXG4gKiBCdWlsZHMgY29tbWFuZCBsaW5lIHJlcHJlc2VudGF0aW9uIGZvciB0aGUgZ2l2ZW5cbiAqIGFwcGxpY2F0aW9uIHN0YXJ0dXAgb3B0aW9uc1xuICpcbiAqIEBwYXJhbSB7U3RhcnRBcHBPcHRpb25zfSBzdGFydEFwcE9wdGlvbnMgLSBBcHBsaWNhdGlvbiBvcHRpb25zIG1hcHBpbmdcbiAqIEBwYXJhbSB7bnVtYmVyfSBhcGlMZXZlbCAtIFRoZSBhY3R1YWwgT1MgQVBJIGxldmVsXG4gKiBAcmV0dXJucyB7QXJyYXk8U3RyaW5nPn0gVGhlIGFjdHVhbCBjb21tYW5kIGxpbmUgYXJyYXlcbiAqL1xuZnVuY3Rpb24gYnVpbGRTdGFydENtZCAoc3RhcnRBcHBPcHRpb25zLCBhcGlMZXZlbCkge1xuICBjb25zdCB7XG4gICAgdXNlcixcbiAgICB3YWl0Rm9yTGF1bmNoLFxuICAgIHBrZyxcbiAgICBhY3Rpdml0eSxcbiAgICBhY3Rpb24sXG4gICAgY2F0ZWdvcnksXG4gICAgc3RvcEFwcCxcbiAgICBmbGFncyxcbiAgfSA9IHN0YXJ0QXBwT3B0aW9ucztcbiAgY29uc3QgY21kID0gWydhbScsICdzdGFydCddO1xuICBpZiAodXRpbC5oYXNWYWx1ZSh1c2VyKSkge1xuICAgIGNtZC5wdXNoKCctLXVzZXInLCB1c2VyKTtcbiAgfVxuICBpZiAod2FpdEZvckxhdW5jaCkge1xuICAgIGNtZC5wdXNoKCctVycpO1xuICB9XG4gIGNtZC5wdXNoKCctbicsIGAke3BrZ30vJHthY3Rpdml0eX1gKTtcbiAgaWYgKHN0b3BBcHAgJiYgYXBpTGV2ZWwgPj0gMTUpIHtcbiAgICBjbWQucHVzaCgnLVMnKTtcbiAgfVxuICBpZiAoYWN0aW9uKSB7XG4gICAgY21kLnB1c2goJy1hJywgYWN0aW9uKTtcbiAgfVxuICBpZiAoY2F0ZWdvcnkpIHtcbiAgICBjbWQucHVzaCgnLWMnLCBjYXRlZ29yeSk7XG4gIH1cbiAgaWYgKGZsYWdzKSB7XG4gICAgY21kLnB1c2goJy1mJywgZmxhZ3MpO1xuICB9XG4gIGlmIChzdGFydEFwcE9wdGlvbnMub3B0aW9uYWxJbnRlbnRBcmd1bWVudHMpIHtcbiAgICAvLyBleHBlY3Qgb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgdG8gYmUgYSBzaW5nbGUgc3RyaW5nIG9mIHRoZSBmb3JtOlxuICAgIC8vICAgICBcIi1mbGFnIGtleVwiXG4gICAgLy8gICAgIFwiLWZsYWcga2V5IHZhbHVlXCJcbiAgICAvLyBvciBhIGNvbWJpbmF0aW9uIG9mIHRoZXNlIChlLmcuLCBcIi1mbGFnMSBrZXkxIC1mbGFnMiBrZXkyIHZhbHVlMlwiKVxuXG4gICAgLy8gdGFrZSBhIHN0cmluZyBhbmQgcGFyc2Ugb3V0IHRoZSBwYXJ0IGJlZm9yZSBhbnkgc3BhY2VzLCBhbmQgYW55dGhpbmcgYWZ0ZXJcbiAgICAvLyB0aGUgZmlyc3Qgc3BhY2VcbiAgICBsZXQgcGFyc2VLZXlWYWx1ZSA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgIHN0ciA9IHN0ci50cmltKCk7XG4gICAgICBsZXQgc3BhY2UgPSBzdHIuaW5kZXhPZignICcpO1xuICAgICAgaWYgKHNwYWNlID09PSAtMSkge1xuICAgICAgICByZXR1cm4gc3RyLmxlbmd0aCA/IFtzdHJdIDogW107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gW3N0ci5zdWJzdHJpbmcoMCwgc3BhY2UpLnRyaW0oKSwgc3RyLnN1YnN0cmluZyhzcGFjZSArIDEpLnRyaW0oKV07XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIGN5Y2xlIHRocm91Z2ggdGhlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIGFuZCBwdWxsIG91dCB0aGUgYXJndW1lbnRzXG4gICAgLy8gYWRkIGEgc3BhY2UgaW5pdGlhbGx5IHNvIGZsYWdzIGNhbiBiZSBkaXN0aW5ndWlzaGVkIGZyb20gYXJndW1lbnRzIHRoYXRcbiAgICAvLyBoYXZlIGludGVybmFsIGh5cGhlbnNcbiAgICBsZXQgb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgPSBgICR7c3RhcnRBcHBPcHRpb25zLm9wdGlvbmFsSW50ZW50QXJndW1lbnRzfWA7XG4gICAgbGV0IHJlID0gLyAoLVteXFxzXSspICguKykvO1xuICAgIHdoaWxlICh0cnVlKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgICBsZXQgYXJncyA9IHJlLmV4ZWMob3B0aW9uYWxJbnRlbnRBcmd1bWVudHMpO1xuICAgICAgaWYgKCFhcmdzKSB7XG4gICAgICAgIGlmIChvcHRpb25hbEludGVudEFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAvLyBubyBtb3JlIGZsYWdzLCBzbyB0aGUgcmVtYWluZGVyIGNhbiBiZSB0cmVhdGVkIGFzICdrZXknIG9yICdrZXkgdmFsdWUnXG4gICAgICAgICAgY21kLnB1c2guYXBwbHkoY21kLCBwYXJzZUtleVZhbHVlKG9wdGlvbmFsSW50ZW50QXJndW1lbnRzKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gd2UgYXJlIGRvbmVcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIHRha2UgdGhlIGZsYWcgYW5kIHNlZSBpZiBpdCBpcyBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBzdHJpbmdcbiAgICAgIC8vIGlmIGl0IGlzIG5vdCwgdGhlbiBpdCBtZWFucyB3ZSBoYXZlIGJlZW4gdGhyb3VnaCBhbHJlYWR5LCBhbmRcbiAgICAgIC8vIHdoYXQgaXMgYmVmb3JlIHRoZSBmbGFnIGlzIHRoZSBhcmd1bWVudCBmb3IgdGhlIHByZXZpb3VzIGZsYWdcbiAgICAgIGxldCBmbGFnID0gYXJnc1sxXTtcbiAgICAgIGxldCBmbGFnUG9zID0gb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMuaW5kZXhPZihmbGFnKTtcbiAgICAgIGlmIChmbGFnUG9zICE9PSAwKSB7XG4gICAgICAgIGxldCBwcmV2QXJncyA9IG9wdGlvbmFsSW50ZW50QXJndW1lbnRzLnN1YnN0cmluZygwLCBmbGFnUG9zKTtcbiAgICAgICAgY21kLnB1c2guYXBwbHkoY21kLCBwYXJzZUtleVZhbHVlKHByZXZBcmdzKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIGFkZCB0aGUgZmxhZywgYXMgdGhlcmUgYXJlIG5vIG1vcmUgZWFybGllciBhcmd1bWVudHNcbiAgICAgIGNtZC5wdXNoKGZsYWcpO1xuXG4gICAgICAvLyBtYWtlIG9wdGlvbmFsSW50ZW50QXJndW1lbnRzIGhvbGQgdGhlIHJlbWFpbmRlclxuICAgICAgb3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgPSBhcmdzWzJdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY21kO1xufVxuXG5jb25zdCBnZXRTZGtUb29sc1ZlcnNpb24gPSBfLm1lbW9pemUoYXN5bmMgZnVuY3Rpb24gZ2V0U2RrVG9vbHNWZXJzaW9uICgpIHtcbiAgY29uc3QgYW5kcm9pZEhvbWUgPSBwcm9jZXNzLmVudi5BTkRST0lEX0hPTUU7XG4gIGlmICghYW5kcm9pZEhvbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FORFJPSURfSE9NRSBlbnZpcm9ubWVudCB2YXJpYWJsZSBpcyBleHBlY3RlZCB0byBiZSBzZXQnKTtcbiAgfVxuICBjb25zdCBwcm9wZXJ0aWVzUGF0aCA9IHBhdGgucmVzb2x2ZShhbmRyb2lkSG9tZSwgJ3Rvb2xzJywgJ3NvdXJjZS5wcm9wZXJ0aWVzJyk7XG4gIGlmICghYXdhaXQgZnMuZXhpc3RzKHByb3BlcnRpZXNQYXRoKSkge1xuICAgIGxvZy53YXJuKGBDYW5ub3QgZmluZCAke3Byb3BlcnRpZXNQYXRofSBmaWxlIHRvIHJlYWQgU0RLIHZlcnNpb24gZnJvbWApO1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBwcm9wZXJ0aWVzQ29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKHByb3BlcnRpZXNQYXRoLCAndXRmOCcpO1xuICBjb25zdCB2ZXJzaW9uTWF0Y2hlciA9IG5ldyBSZWdFeHAoL1BrZ1xcLlJldmlzaW9uPShcXGQrKVxcLj8oXFxkKyk/XFwuPyhcXGQrKT8vKTtcbiAgY29uc3QgbWF0Y2ggPSB2ZXJzaW9uTWF0Y2hlci5leGVjKHByb3BlcnRpZXNDb250ZW50KTtcbiAgaWYgKG1hdGNoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1ham9yOiBwYXJzZUludChtYXRjaFsxXSwgMTApLFxuICAgICAgbWlub3I6IG1hdGNoWzJdID8gcGFyc2VJbnQobWF0Y2hbMl0sIDEwKSA6IDAsXG4gICAgICBidWlsZDogbWF0Y2hbM10gPyBwYXJzZUludChtYXRjaFszXSwgMTApIDogMFxuICAgIH07XG4gIH1cbiAgbG9nLndhcm4oYENhbm5vdCBwYXJzZSBcIlBrZy5SZXZpc2lvblwiIHZhbHVlIGZyb20gJHtwcm9wZXJ0aWVzUGF0aH1gKTtcbn0pO1xuXG4vKipcbiAqIFJldHJpZXZlcyBmdWxsIHBhdGhzIHRvIGFsbCAnYnVpbGQtdG9vbHMnIHN1YmZvbGRlcnMgdW5kZXIgdGhlIHBhcnRpY3VsYXJcbiAqIFNESyByb290IGZvbGRlclxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzZGtSb290IC0gVGhlIGZ1bGwgcGF0aCB0byB0aGUgQW5kcm9pZCBTREsgcm9vdCBmb2xkZXJcbiAqIEByZXR1cm5zIHtBcnJheTxzdHJpbmc+fSBUaGUgZnVsbCBwYXRocyB0byB0aGUgcmVzdWx0aW5nIGZvbGRlcnMgc29ydGVkIGJ5XG4gKiBtb2RpZmljYXRpb24gZGF0ZSAodGhlIG5ld2VzdCBjb21lcyBmaXJzdCkgb3IgYW4gZW1wdHkgbGlzdCBpZiBubyBtYWN0aGVzIHdlcmUgZm91bmRcbiAqL1xuY29uc3QgZ2V0QnVpbGRUb29sc0RpcnMgPSBfLm1lbW9pemUoYXN5bmMgZnVuY3Rpb24gZ2V0QnVpbGRUb29sc0RpcnMgKHNka1Jvb3QpIHtcbiAgbGV0IGJ1aWxkVG9vbHNEaXJzID0gYXdhaXQgZnMuZ2xvYihwYXRoLnJlc29sdmUoc2RrUm9vdCwgJ2J1aWxkLXRvb2xzJywgJyonKSwge2Fic29sdXRlOiB0cnVlfSk7XG4gIHRyeSB7XG4gICAgYnVpbGRUb29sc0RpcnMgPSBidWlsZFRvb2xzRGlyc1xuICAgICAgLm1hcCgoZGlyKSA9PiBbcGF0aC5iYXNlbmFtZShkaXIpLCBkaXJdKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IHNlbXZlci5yY29tcGFyZShhWzBdLCBiWzBdKSlcbiAgICAgIC5tYXAoKHBhaXIpID0+IHBhaXJbMV0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cud2FybihgQ2Fubm90IHNvcnQgYnVpbGQtdG9vbHMgZm9sZGVycyAke0pTT04uc3RyaW5naWZ5KGJ1aWxkVG9vbHNEaXJzLm1hcCgoZGlyKSA9PiBwYXRoLmJhc2VuYW1lKGRpcikpKX0gYCArXG4gICAgICBgYnkgc2VtYW50aWMgdmVyc2lvbiBuYW1lcy5gKTtcbiAgICBsb2cud2FybihgRmFsbGluZyBiYWNrIHRvIHNvcnRpbmcgYnkgbW9kaWZpY2F0aW9uIGRhdGUuIE9yaWdpbmFsIGVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIGNvbnN0IHBhaXJzID0gYXdhaXQgQi5tYXAoYnVpbGRUb29sc0RpcnMsIGFzeW5jIChkaXIpID0+IFsoYXdhaXQgZnMuc3RhdChkaXIpKS5tdGltZS52YWx1ZU9mKCksIGRpcl0pO1xuICAgIGJ1aWxkVG9vbHNEaXJzID0gcGFpcnNcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhWzBdIDwgYlswXSlcbiAgICAgIC5tYXAoKHBhaXIpID0+IHBhaXJbMV0pO1xuICB9XG4gIGxvZy5pbmZvKGBGb3VuZCAke2J1aWxkVG9vbHNEaXJzLmxlbmd0aH0gJ2J1aWxkLXRvb2xzJyBmb2xkZXJzIHVuZGVyICcke3Nka1Jvb3R9JyAobmV3ZXN0IGZpcnN0KTpgKTtcbiAgZm9yIChsZXQgZGlyIG9mIGJ1aWxkVG9vbHNEaXJzKSB7XG4gICAgbG9nLmluZm8oYCAgICAke2Rpcn1gKTtcbiAgfVxuICByZXR1cm4gYnVpbGRUb29sc0RpcnM7XG59KTtcblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIGxpc3Qgb2YgcGVybWlzc2lvbiBuYW1lcyBlbmNvZGVkIGluIGBkdW1wc3lzIHBhY2thZ2VgIGNvbW1hbmQgb3V0cHV0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBkdW1wc3lzT3V0cHV0IC0gVGhlIGFjdHVhbCBjb21tYW5kIG91dHB1dC5cbiAqIEBwYXJhbSB7QXJyYXk8c3RyaW5nPn0gZ3JvdXBOYW1lcyAtIFRoZSBsaXN0IG9mIGdyb3VwIG5hbWVzIHRvIGxpc3QgcGVybWlzc2lvbnMgZm9yLlxuICogQHBhcmFtIHs/Ym9vbGVhbn0gZ3JhbnRlZFN0YXRlIC0gVGhlIGV4cGVjdGVkIHN0YXRlIG9mIGBncmFudGVkYCBhdHRyaWJ1dGUgdG8gZmlsdGVyIHdpdGguXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBObyBmaWx0ZXJpbmcgaXMgZG9uZSBpZiB0aGUgcGFyYW1ldGVyIGlzIG5vdCBzZXQuXG4gKiBAcmV0dXJucyB7QXJyYXk8c3RyaW5nPn0gVGhlIGxpc3Qgb2YgbWF0Y2hlZCBwZXJtaXNzaW9uIG5hbWVzIG9yIGFuIGVtcHR5IGxpc3QgaWYgbm8gbWF0Y2hlcyB3ZXJlIGZvdW5kLlxuICovXG5jb25zdCBleHRyYWN0TWF0Y2hpbmdQZXJtaXNzaW9ucyA9IGZ1bmN0aW9uIChkdW1wc3lzT3V0cHV0LCBncm91cE5hbWVzLCBncmFudGVkU3RhdGUgPSBudWxsKSB7XG4gIGNvbnN0IGdyb3VwUGF0dGVybkJ5TmFtZSA9IChncm91cE5hbWUpID0+IG5ldyBSZWdFeHAoYF4oXFxcXHMqJHtfLmVzY2FwZVJlZ0V4cChncm91cE5hbWUpfSBwZXJtaXNzaW9uczpbXFxcXHNcXFxcU10rKWAsICdtJyk7XG4gIGNvbnN0IGluZGVudFBhdHRlcm4gPSAvXFxTfCQvO1xuICBjb25zdCBwZXJtaXNzaW9uTmFtZVBhdHRlcm4gPSAvYW5kcm9pZFxcLnBlcm1pc3Npb25cXC5cXHcrLztcbiAgY29uc3QgZ3JhbnRlZFN0YXRlUGF0dGVybiA9IC9cXGJncmFudGVkPShcXHcrKS87XG4gIGNvbnN0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGNvbnN0IGdyb3VwTmFtZSBvZiBncm91cE5hbWVzKSB7XG4gICAgY29uc3QgZ3JvdXBNYXRjaCA9IGdyb3VwUGF0dGVybkJ5TmFtZShncm91cE5hbWUpLmV4ZWMoZHVtcHN5c091dHB1dCk7XG4gICAgaWYgKCFncm91cE1hdGNoKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCBsaW5lcyA9IGdyb3VwTWF0Y2hbMV0uc3BsaXQoJ1xcbicpO1xuICAgIGlmIChsaW5lcy5sZW5ndGggPCAyKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCB0aXRsZUluZGVudCA9IGxpbmVzWzBdLnNlYXJjaChpbmRlbnRQYXR0ZXJuKTtcbiAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMuc2xpY2UoMSkpIHtcbiAgICAgIGNvbnN0IGN1cnJlbnRJbmRlbnQgPSBsaW5lLnNlYXJjaChpbmRlbnRQYXR0ZXJuKTtcbiAgICAgIGlmIChjdXJyZW50SW5kZW50IDw9IHRpdGxlSW5kZW50KSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwZXJtaXNzaW9uTmFtZU1hdGNoID0gcGVybWlzc2lvbk5hbWVQYXR0ZXJuLmV4ZWMobGluZSk7XG4gICAgICBpZiAoIXBlcm1pc3Npb25OYW1lTWF0Y2gpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCBpdGVtID0ge1xuICAgICAgICBwZXJtaXNzaW9uOiBwZXJtaXNzaW9uTmFtZU1hdGNoWzBdLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IGdyYW50ZWRTdGF0ZU1hdGNoID0gZ3JhbnRlZFN0YXRlUGF0dGVybi5leGVjKGxpbmUpO1xuICAgICAgaWYgKGdyYW50ZWRTdGF0ZU1hdGNoKSB7XG4gICAgICAgIGl0ZW0uZ3JhbnRlZCA9IGdyYW50ZWRTdGF0ZU1hdGNoWzFdID09PSAndHJ1ZSc7XG4gICAgICB9XG4gICAgICByZXN1bHQucHVzaChpdGVtKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBmaWx0ZXJlZFJlc3VsdCA9IHJlc3VsdFxuICAgIC5maWx0ZXIoKGl0ZW0pID0+ICFfLmlzQm9vbGVhbihncmFudGVkU3RhdGUpIHx8IGl0ZW0uZ3JhbnRlZCA9PT0gZ3JhbnRlZFN0YXRlKVxuICAgIC5tYXAoKGl0ZW0pID0+IGl0ZW0ucGVybWlzc2lvbik7XG4gIGxvZy5kZWJ1ZyhgUmV0cmlldmVkICR7ZmlsdGVyZWRSZXN1bHQubGVuZ3RofSBwZXJtaXNzaW9uKHMpIGZyb20gJHtKU09OLnN0cmluZ2lmeShncm91cE5hbWVzKX0gZ3JvdXAocylgKTtcbiAgcmV0dXJuIGZpbHRlcmVkUmVzdWx0O1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBJbnN0YWxsT3B0aW9uc1xuICogQHByb3BlcnR5IHtib29sZWFufSBhbGxvd1Rlc3RQYWNrYWdlcyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMgaW5zdGFsbGF0aW9uLlxuICogQHByb3BlcnR5IHtib29sZWFufSB1c2VTZGNhcmQgW2ZhbHNlXSAtIFNldCB0byB0cnVlIHRvIGluc3RhbGwgdGhlIGFwcCBvbiBzZGNhcmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0ZWFkIG9mIHRoZSBkZXZpY2UgbWVtb3J5LlxuICogQHByb3BlcnR5IHtib29sZWFufSBncmFudFBlcm1pc3Npb25zIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBncmFudCBhbGwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zIHJlcXVlc3RlZCBpbiB0aGUgYXBwbGljYXRpb24ncyBtYW5pZmVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBpbnN0YWxsYXRpb24gaXMgY29tcGxldGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVyIEFuZHJvaWQgNisuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IHJlcGxhY2UgW3RydWVdIC0gU2V0IGl0IHRvIGZhbHNlIGlmIHlvdSBkb24ndCB3YW50XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGFwcGxpY2F0aW9uIHRvIGJlIHVwZ3JhZGVkL3JlaW5zdGFsbGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXQgaXMgYWxyZWFkeSBwcmVzZW50IG9uIHRoZSBkZXZpY2UuXG4gKi9cblxuLyoqXG4gKiBUcmFuc2Zvcm1zIGdpdmVuIG9wdGlvbnMgaW50byB0aGUgbGlzdCBvZiBgYWRiIGluc3RhbGwuaW5zdGFsbC1tdWx0aXBsZWAgY29tbWFuZCBhcmd1bWVudHNcbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gYXBpTGV2ZWwgLSBUaGUgY3VycmVudCBBUEkgbGV2ZWxcbiAqIEBwYXJhbSB7P0luc3RhbGxPcHRpb25zfSBvcHRpb25zIC0gVGhlIG9wdGlvbnMgbWFwcGluZyB0byB0cmFuc2Zvcm1cbiAqIEByZXR1cm5zIHtBcnJheTxTdHJpbmc+fSBUaGUgYXJyYXkgb2YgYXJndW1lbnRzXG4gKi9cbmZ1bmN0aW9uIGJ1aWxkSW5zdGFsbEFyZ3MgKGFwaUxldmVsLCBvcHRpb25zID0ge30pIHtcbiAgY29uc3QgcmVzdWx0ID0gW107XG5cbiAgaWYgKCF1dGlsLmhhc1ZhbHVlKG9wdGlvbnMucmVwbGFjZSkgfHwgb3B0aW9ucy5yZXBsYWNlKSB7XG4gICAgcmVzdWx0LnB1c2goJy1yJyk7XG4gIH1cbiAgaWYgKG9wdGlvbnMuYWxsb3dUZXN0UGFja2FnZXMpIHtcbiAgICByZXN1bHQucHVzaCgnLXQnKTtcbiAgfVxuICBpZiAob3B0aW9ucy51c2VTZGNhcmQpIHtcbiAgICByZXN1bHQucHVzaCgnLXMnKTtcbiAgfVxuICBpZiAob3B0aW9ucy5ncmFudFBlcm1pc3Npb25zKSB7XG4gICAgaWYgKGFwaUxldmVsIDwgMjMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgU2tpcHBpbmcgcGVybWlzc2lvbnMgZ3JhbnQgb3B0aW9uLCBzaW5jZSBgICtcbiAgICAgICAgICAgICAgICBgdGhlIGN1cnJlbnQgQVBJIGxldmVsICR7YXBpTGV2ZWx9IGRvZXMgbm90IHN1cHBvcnQgYXBwbGljYXRpb25zIGAgK1xuICAgICAgICAgICAgICAgIGBwZXJtaXNzaW9ucyBjdXN0b21pemF0aW9uYCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdC5wdXNoKCctZycpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gTWFuaWZlc3RJbmZvXG4gKiBAcHJvcGVydHkge3N0cmluZ30gcGtnIC0gVGhlIGFwcGxpY2F0aW9uIGlkZW50aWZpZXJcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBtYWluIHBhY2thZ2UgYWN0aXZpdHlcbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gdmVyc2lvbkNvZGUgLSBUaGUgdmVyc2lvbiBjb2RlIG51bWJlciAobWlnaHQgYmUgYE5hTmApXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHZlcnNpb25OYW1lIC0gVGhlIHZlcnNpb24gbmFtZSAobWlnaHQgYmUgYG51bGxgKVxuICovXG5cbi8qKlxuICogUGVyZm9ybSBwYXJzaW5nIG9mIHRoZSBtYW5pZmVzdCBYTUwgZmlsZSB0byBpbiBvcmRlclxuICogdG8gZXh0cmFjdCBzb21lIHZpdGFsIHZhbHVlcyBmcm9tIGl0XG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hbmlmZXN0WG1sIFRoZSBvcmlnaW5hbCBtYW5pZmVzdCBjb250ZW50IGFzIGEgc3RyaW5nXG4gKiBAcmV0dXJucyB7TWFuaWZlc3RJbmZvfVxuICovXG5mdW5jdGlvbiBwYXJzZU1hbmlmZXN0IChtYW5pZmVzdFhtbCkge1xuICBjb25zdCBkb2MgPSBuZXcgeG1sZG9tLkRPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhtYW5pZmVzdFhtbCk7XG4gIGNvbnN0IGRvY3VtZW50RWxlbWVudCA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gIGNvbnN0IHJlc3VsdCA9IHtcbiAgICBwa2c6IGRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3BhY2thZ2UnKSxcbiAgICB2ZXJzaW9uQ29kZTogcGFyc2VJbnQoZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnYW5kcm9pZDp2ZXJzaW9uQ29kZScpLCAxMCksXG4gICAgdmVyc2lvbk5hbWU6IGRvY3VtZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2FuZHJvaWQ6dmVyc2lvbk5hbWUnKSxcbiAgfTtcbiAgLy8gTG9vayBmb3IgYWN0aXZpdHkgb3IgYWN0aXZpdHktYWxpYXMgd2l0aFxuICAvLyBhY3Rpb24gPT0gYW5kcm9pZC5pbnRlbnQuYWN0aW9uLk1BSU4gYW5kXG4gIC8vIGNhdGVnb3J5ID09IGFuZHJvaWQuaW50ZW50LmNhdGVnb3J5LkxBVU5DSEVSXG4gIC8vIGRlc2NlbmRhbnRzXG4gIGNvbnN0IGFwa0FjdGl2aXR5QXR0cmlidXRlID0geHBhdGguc2VsZWN0MShcbiAgICBcIi8vYXBwbGljYXRpb24vKltzdGFydHMtd2l0aChuYW1lKCksICdhY3Rpdml0eScpIFwiICtcbiAgICBcImFuZCAobm90KEAqW2xvY2FsLW5hbWUoKT0nZW5hYmxlZCddKSBvciBAKltsb2NhbC1uYW1lKCk9J2VuYWJsZWQnIGFuZCAuPSd0cnVlJ10pIFwiICtcbiAgICBcImFuZCAuLy9hY3Rpb25bQCpbbG9jYWwtbmFtZSgpPSduYW1lJyBhbmQgLj0nYW5kcm9pZC5pbnRlbnQuYWN0aW9uLk1BSU4nXV0gXCIgK1xuICAgIFwiYW5kIC4vL2NhdGVnb3J5W0AqW2xvY2FsLW5hbWUoKT0nbmFtZScgYW5kIC49J2FuZHJvaWQuaW50ZW50LmNhdGVnb3J5LkxBVU5DSEVSJ11dXVwiICtcbiAgICBcIi9AKltsb2NhbC1uYW1lKCk9J25hbWUnXVwiLCBkb2MpO1xuICBpZiAoYXBrQWN0aXZpdHlBdHRyaWJ1dGUpIHtcbiAgICByZXN1bHQuYWN0aXZpdHkgPSBhcGtBY3Rpdml0eUF0dHJpYnV0ZS52YWx1ZTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIFBhcnNlcyBhcGsgc3RyaW5ncyBmcm9tIGFhcHQgdG9vbCBvdXRwdXRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcmF3T3V0cHV0IFRoZSBhY3R1YWwgdG9vbCBvdXRwdXRcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb25maWdNYXJrZXIgVGhlIGNvbmZpZyBtYXJrZXIuIFVzdWFsbHlcbiAqIGEgbGFuZ3VhZ2UgYWJicmV2aWF0aW9uIG9yIGAoZGVmYXVsdClgXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBTdHJpbmdzIGlkcyB0byB2YWx1ZXMgbWFwcGluZy4gUGx1cmFsXG4gKiB2YWx1ZXMgYXJlIHJlcHJlc2VudGVkIGFzIGFycmF5cy4gSWYgbm8gY29uZmlnIGZvdW5kIGZvciB0aGVcbiAqIGdpdmVuIG1hcmtlciB0aGVuIGFuIGVtcHR5IG1hcHBpbmcgaXMgcmV0dXJuZWQuXG4gKi9cbmZ1bmN0aW9uIHBhcnNlQWFwdFN0cmluZ3MgKHJhd091dHB1dCwgY29uZmlnTWFya2VyKSB7XG4gIGNvbnN0IG5vcm1hbGl6ZVN0cmluZ01hdGNoID0gZnVuY3Rpb24gKHMpIHtcbiAgICByZXR1cm4gcy5yZXBsYWNlKC9cIiQvLCAnJykucmVwbGFjZSgvXlwiLywgJycpLnJlcGxhY2UoL1xcXFxcIi9nLCAnXCInKTtcbiAgfTtcblxuICBjb25zdCBhcGtTdHJpbmdzID0ge307XG4gIGxldCBpc0luQ29uZmlnID0gZmFsc2U7XG4gIGxldCBjdXJyZW50UmVzb3VyY2VJZCA9IG51bGw7XG4gIGxldCBpc0luUGx1cmFsR3JvdXAgPSBmYWxzZTtcbiAgLy8gVGhlIHBhdHRlcm4gbWF0Y2hlcyBhbnkgcXVvdGVkIGNvbnRlbnQgaW5jbHVkaW5nIGVzY2FwZWQgcXVvdGVzXG4gIGNvbnN0IHF1b3RlZFN0cmluZ1BhdHRlcm4gPSAvXCJbXlwiXFxcXF0qKD86XFxcXC5bXlwiXFxcXF0qKSpcIi87XG4gIGZvciAoY29uc3QgbGluZSBvZiByYXdPdXRwdXQuc3BsaXQob3MuRU9MKSkge1xuICAgIGNvbnN0IHRyaW1tZWRMaW5lID0gbGluZS50cmltKCk7XG4gICAgaWYgKF8uaXNFbXB0eSh0cmltbWVkTGluZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChbJ2NvbmZpZycsICd0eXBlJywgJ3NwZWMnLCAnUGFja2FnZSddLnNvbWUoKHgpID0+IHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoeCkpKSB7XG4gICAgICBpc0luQ29uZmlnID0gdHJpbW1lZExpbmUuc3RhcnRzV2l0aChgY29uZmlnICR7Y29uZmlnTWFya2VyfTpgKTtcbiAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgICAgIGlzSW5QbHVyYWxHcm91cCA9IGZhbHNlO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKCFpc0luQ29uZmlnKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAodHJpbW1lZExpbmUuc3RhcnRzV2l0aCgncmVzb3VyY2UnKSkge1xuICAgICAgaXNJblBsdXJhbEdyb3VwID0gZmFsc2U7XG4gICAgICBjdXJyZW50UmVzb3VyY2VJZCA9IG51bGw7XG5cbiAgICAgIGlmICh0cmltbWVkTGluZS5pbmNsdWRlcygnOnN0cmluZy8nKSkge1xuICAgICAgICBjb25zdCBtYXRjaCA9IC86c3RyaW5nXFwvKFxcUyspOi8uZXhlYyh0cmltbWVkTGluZSk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbWF0Y2hbMV07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHJpbW1lZExpbmUuaW5jbHVkZXMoJzpwbHVyYWxzLycpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gLzpwbHVyYWxzXFwvKFxcUyspOi8uZXhlYyh0cmltbWVkTGluZSk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbWF0Y2hbMV07XG4gICAgICAgICAgaXNJblBsdXJhbEdyb3VwID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRSZXNvdXJjZUlkICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJyhzdHJpbmcnKSkge1xuICAgICAgY29uc3QgbWF0Y2ggPSBxdW90ZWRTdHJpbmdQYXR0ZXJuLmV4ZWModHJpbW1lZExpbmUpO1xuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGFwa1N0cmluZ3NbY3VycmVudFJlc291cmNlSWRdID0gbm9ybWFsaXplU3RyaW5nTWF0Y2gobWF0Y2hbMF0pO1xuICAgICAgfVxuICAgICAgY3VycmVudFJlc291cmNlSWQgPSBudWxsO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKGN1cnJlbnRSZXNvdXJjZUlkICYmIGlzSW5QbHVyYWxHcm91cCAmJiB0cmltbWVkTGluZS5pbmNsdWRlcygnOiAoc3RyaW5nJykpIHtcbiAgICAgIGNvbnN0IG1hdGNoID0gcXVvdGVkU3RyaW5nUGF0dGVybi5leGVjKHRyaW1tZWRMaW5lKTtcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICBhcGtTdHJpbmdzW2N1cnJlbnRSZXNvdXJjZUlkXSA9IFtcbiAgICAgICAgICAuLi4oYXBrU3RyaW5nc1tjdXJyZW50UmVzb3VyY2VJZF0gfHwgW10pLFxuICAgICAgICAgIG5vcm1hbGl6ZVN0cmluZ01hdGNoKG1hdGNoWzBdKSxcbiAgICAgICAgXTtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gYXBrU3RyaW5ncztcbn1cblxuLyoqXG4gKiBQYXJzZXMgYXBrIHN0cmluZ3MgZnJvbSBhYXB0MiB0b29sIG91dHB1dFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSByYXdPdXRwdXQgVGhlIGFjdHVhbCB0b29sIG91dHB1dFxuICogQHBhcmFtIHtzdHJpbmd9IGNvbmZpZ01hcmtlciBUaGUgY29uZmlnIG1hcmtlci4gVXN1YWxseVxuICogYSBsYW5ndWFnZSBhYmJyZXZpYXRpb24gb3IgYW4gZW1wdHkgc3RyaW5nIGZvciB0aGUgZGVmYXVsdCBvbmVcbiAqIEByZXR1cm5zIHtPYmplY3R9IFN0cmluZ3MgaWRzIHRvIHZhbHVlcyBtYXBwaW5nLiBQbHVyYWxcbiAqIHZhbHVlcyBhcmUgcmVwcmVzZW50ZWQgYXMgYXJyYXlzLiBJZiBubyBjb25maWcgZm91bmQgZm9yIHRoZVxuICogZ2l2ZW4gbWFya2VyIHRoZW4gYW4gZW1wdHkgbWFwcGluZyBpcyByZXR1cm5lZC5cbiAqL1xuZnVuY3Rpb24gcGFyc2VBYXB0MlN0cmluZ3MgKHJhd091dHB1dCwgY29uZmlnTWFya2VyKSB7XG4gIGNvbnN0IGFsbExpbmVzID0gcmF3T3V0cHV0LnNwbGl0KG9zLkVPTCk7XG4gIGZ1bmN0aW9uIGV4dHJhY3RDb250ZW50IChzdGFydElkeCkge1xuICAgIGxldCBpZHggPSBzdGFydElkeDtcbiAgICBjb25zdCBzdGFydENoYXJQb3MgPSBhbGxMaW5lc1tzdGFydElkeF0uaW5kZXhPZignXCInKTtcbiAgICBpZiAoc3RhcnRDaGFyUG9zIDwgMCkge1xuICAgICAgcmV0dXJuIFtudWxsLCBpZHhdO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0ID0gJyc7XG4gICAgd2hpbGUgKGlkeCA8IGFsbExpbmVzLmxlbmd0aCkge1xuICAgICAgY29uc3QgdGVybWluYXRpb25DaGFyTWF0Y2ggPSAvXCIkLy5leGVjKGFsbExpbmVzW2lkeF0pO1xuICAgICAgaWYgKHRlcm1pbmF0aW9uQ2hhck1hdGNoKSB7XG4gICAgICAgIGNvbnN0IHRlcm1pbmF0aW9uQ2hhclBvcyA9IHRlcm1pbmF0aW9uQ2hhck1hdGNoLmluZGV4O1xuICAgICAgICBpZiAoc3RhcnRJZHggPT09IGlkeCkge1xuICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBhbGxMaW5lc1tpZHhdLnN1YnN0cmluZyhzdGFydENoYXJQb3MgKyAxLCB0ZXJtaW5hdGlvbkNoYXJQb3MpLFxuICAgICAgICAgICAgaWR4XG4gICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIGAke3Jlc3VsdH1cXFxcbiR7Xy50cmltU3RhcnQoYWxsTGluZXNbaWR4XS5zdWJzdHJpbmcoMCwgdGVybWluYXRpb25DaGFyUG9zKSl9YCxcbiAgICAgICAgICBpZHgsXG4gICAgICAgIF07XG4gICAgICB9XG4gICAgICBpZiAoaWR4ID4gc3RhcnRJZHgpIHtcbiAgICAgICAgcmVzdWx0ICs9IGBcXFxcbiR7Xy50cmltU3RhcnQoYWxsTGluZXNbaWR4XSl9YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCArPSBhbGxMaW5lc1tpZHhdLnN1YnN0cmluZyhzdGFydENoYXJQb3MgKyAxKTtcbiAgICAgIH1cbiAgICAgICsraWR4O1xuICAgIH1cbiAgICByZXR1cm4gW3Jlc3VsdCwgaWR4XTtcbiAgfVxuXG4gIGNvbnN0IGFwa1N0cmluZ3MgPSB7fTtcbiAgbGV0IGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgbGV0IGlzSW5QbHVyYWxHcm91cCA9IGZhbHNlO1xuICBsZXQgaXNJbkN1cnJlbnRDb25maWcgPSBmYWxzZTtcbiAgbGV0IGxpbmVJbmRleCA9IDA7XG4gIHdoaWxlIChsaW5lSW5kZXggPCBhbGxMaW5lcy5sZW5ndGgpIHtcbiAgICBjb25zdCB0cmltbWVkTGluZSA9IGFsbExpbmVzW2xpbmVJbmRleF0udHJpbSgpO1xuICAgIGlmIChfLmlzRW1wdHkodHJpbW1lZExpbmUpKSB7XG4gICAgICArK2xpbmVJbmRleDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmIChbJ3R5cGUnLCAnUGFja2FnZSddLnNvbWUoKHgpID0+IHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoeCkpKSB7XG4gICAgICBjdXJyZW50UmVzb3VyY2VJZCA9IG51bGw7XG4gICAgICBpc0luUGx1cmFsR3JvdXAgPSBmYWxzZTtcbiAgICAgIGlzSW5DdXJyZW50Q29uZmlnID0gZmFsc2U7XG4gICAgICArK2xpbmVJbmRleDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICh0cmltbWVkTGluZS5zdGFydHNXaXRoKCdyZXNvdXJjZScpKSB7XG4gICAgICBpc0luUGx1cmFsR3JvdXAgPSBmYWxzZTtcbiAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgICAgIGlzSW5DdXJyZW50Q29uZmlnID0gZmFsc2U7XG5cbiAgICAgIGlmICh0cmltbWVkTGluZS5pbmNsdWRlcygnc3RyaW5nLycpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gL3N0cmluZ1xcLyhcXFMrKS8uZXhlYyh0cmltbWVkTGluZSk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbWF0Y2hbMV07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHJpbW1lZExpbmUuaW5jbHVkZXMoJ3BsdXJhbHMvJykpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSAvcGx1cmFsc1xcLyhcXFMrKS8uZXhlYyh0cmltbWVkTGluZSk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbWF0Y2hbMV07XG4gICAgICAgICAgaXNJblBsdXJhbEdyb3VwID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgKytsaW5lSW5kZXg7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudFJlc291cmNlSWQpIHtcbiAgICAgIGlmIChpc0luUGx1cmFsR3JvdXApIHtcbiAgICAgICAgaWYgKHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJygnKSkge1xuICAgICAgICAgIGlzSW5DdXJyZW50Q29uZmlnID0gdHJpbW1lZExpbmUuc3RhcnRzV2l0aChgKCR7Y29uZmlnTWFya2VyfSlgKTtcbiAgICAgICAgICArK2xpbmVJbmRleDtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNJbkN1cnJlbnRDb25maWcpIHtcbiAgICAgICAgICBjb25zdCBbY29udGVudCwgaWR4XSA9IGV4dHJhY3RDb250ZW50KGxpbmVJbmRleCk7XG4gICAgICAgICAgbGluZUluZGV4ID0gaWR4O1xuICAgICAgICAgIGlmIChfLmlzU3RyaW5nKGNvbnRlbnQpKSB7XG4gICAgICAgICAgICBhcGtTdHJpbmdzW2N1cnJlbnRSZXNvdXJjZUlkXSA9IFtcbiAgICAgICAgICAgICAgLi4uKGFwa1N0cmluZ3NbY3VycmVudFJlc291cmNlSWRdIHx8IFtdKSxcbiAgICAgICAgICAgICAgY29udGVudCxcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoYCgke2NvbmZpZ01hcmtlcn0pYCkpIHtcbiAgICAgICAgY29uc3QgW2NvbnRlbnQsIGlkeF0gPSBleHRyYWN0Q29udGVudChsaW5lSW5kZXgpO1xuICAgICAgICBsaW5lSW5kZXggPSBpZHg7XG4gICAgICAgIGlmIChfLmlzU3RyaW5nKGNvbnRlbnQpKSB7XG4gICAgICAgICAgYXBrU3RyaW5nc1tjdXJyZW50UmVzb3VyY2VJZF0gPSBjb250ZW50O1xuICAgICAgICB9XG4gICAgICAgIGN1cnJlbnRSZXNvdXJjZUlkID0gbnVsbDtcbiAgICAgIH1cbiAgICB9XG4gICAgKytsaW5lSW5kZXg7XG4gIH1cbiAgcmV0dXJuIGFwa1N0cmluZ3M7XG59XG5cbi8qKlxuICogRm9ybWF0cyB0aGUgY29uZmlnIG1hcmtlciwgd2hpY2ggaXMgdGhlbiBwYXNzZWQgdG8gcGFyc2UuLiBtZXRob2RzXG4gKiB0byBtYWtlIGl0IGNvbXBhdGlibGUgd2l0aCByZXNvdXJjZSBmb3JtYXRzIGdlbmVyYXRlZCBieSBhYXB0KDIpIHRvb2xcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb25maWdzR2V0dGVyIFRoZSBmdW5jdGlvbiB3aG9zZSByZXN1bHQgaXMgYSBsaXN0XG4gKiBvZiBhcGsgY29uZmlnc1xuICogQHBhcmFtIHtzdHJpbmd9IGRlc2lyZWRNYXJrZXIgVGhlIGRlc2lyZWQgY29uZmlnIG1hcmtlciB2YWx1ZVxuICogQHBhcmFtIHtzdHJpbmd9IGRlZmF1bHRNYXJrZXIgVGhlIGRlZmF1bHQgY29uZmlnIG1hcmtlciB2YWx1ZVxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgZm9ybWF0dGVkIGNvbmZpZyBtYXJrZXJcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZm9ybWF0Q29uZmlnTWFya2VyIChjb25maWdzR2V0dGVyLCBkZXNpcmVkTWFya2VyLCBkZWZhdWx0TWFya2VyKSB7XG4gIGxldCBjb25maWdNYXJrZXIgPSBkZXNpcmVkTWFya2VyIHx8IGRlZmF1bHRNYXJrZXI7XG4gIGlmIChjb25maWdNYXJrZXIuaW5jbHVkZXMoJy0nKSAmJiAhY29uZmlnTWFya2VyLmluY2x1ZGVzKCctcicpKSB7XG4gICAgY29uZmlnTWFya2VyID0gY29uZmlnTWFya2VyLnJlcGxhY2UoJy0nLCAnLXInKTtcbiAgfVxuICBpZiAoY29uZmlnTWFya2VyLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgnZW4nKSkge1xuICAgIC8vIEFzc3VtZSB0aGUgJ2VuJyBjb25maWd1cmF0aW9uIGlzIHRoZSBkZWZhdWx0IG9uZVxuICAgIGlmICghKGF3YWl0IGNvbmZpZ3NHZXR0ZXIoKSkubWFwKCh4KSA9PiB4LnRyaW0oKSkuaW5jbHVkZXMoY29uZmlnTWFya2VyKSkge1xuICAgICAgbG9nLmRlYnVnKGBUaGVyZSBpcyBubyAnJHtjb25maWdNYXJrZXJ9JyBjb25maWd1cmF0aW9uLiBgICtcbiAgICAgICAgYFJlcGxhY2luZyBpdCB3aXRoICcke2RlZmF1bHRNYXJrZXIgfHwgJ2RlZmF1bHQnfSdgKTtcbiAgICAgIGNvbmZpZ01hcmtlciA9IGRlZmF1bHRNYXJrZXI7XG4gICAgfVxuICB9XG4gIHJldHVybiBjb25maWdNYXJrZXI7XG59XG5cbmV4cG9ydCB7XG4gIGdldEFuZHJvaWRQbGF0Zm9ybUFuZFBhdGgsIHVuemlwRmlsZSxcbiAgZ2V0SU1FTGlzdEZyb21PdXRwdXQsIGdldEphdmFGb3JPcywgaXNTaG93aW5nTG9ja3NjcmVlbiwgaXNDdXJyZW50Rm9jdXNPbktleWd1YXJkLFxuICBnZXRTdXJmYWNlT3JpZW50YXRpb24sIGlzU2NyZWVuT25GdWxseSwgYnVpbGRTdGFydENtZCwgZ2V0SmF2YUhvbWUsXG4gIHJvb3REaXIsIGdldFNka1Rvb2xzVmVyc2lvbiwgZ2V0QXBrc2lnbmVyRm9yT3MsIGdldEJ1aWxkVG9vbHNEaXJzLFxuICBnZXRBcGthbmFseXplckZvck9zLCBnZXRPcGVuU3NsRm9yT3MsIGV4dHJhY3RNYXRjaGluZ1Blcm1pc3Npb25zLCBBUEtTX0VYVEVOU0lPTixcbiAgQVBLX0lOU1RBTExfVElNRU9VVCwgQVBLU19JTlNUQUxMX1RJTUVPVVQsIGJ1aWxkSW5zdGFsbEFyZ3MsIEFQS19FWFRFTlNJT04sXG4gIERFRkFVTFRfQURCX0VYRUNfVElNRU9VVCwgcGFyc2VNYW5pZmVzdCwgcGFyc2VBYXB0U3RyaW5ncywgcGFyc2VBYXB0MlN0cmluZ3MsXG4gIGZvcm1hdENvbmZpZ01hcmtlcixcbn07XG4iXSwiZmlsZSI6ImxpYi9oZWxwZXJzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
