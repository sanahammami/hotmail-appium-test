"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getMostRecentChromedriver = getMostRecentChromedriver;
exports.default = exports.CD_VER = exports.CHROMEDRIVER_CHROME_MAPPING = exports.Chromedriver = void 0;

require("source-map-support/register");

var _events = _interopRequireDefault(require("events"));

var _appiumBaseDriver = require("appium-base-driver");

var _child_process = _interopRequireDefault(require("child_process"));

var _appiumSupport = require("appium-support");

var _asyncbox = require("asyncbox");

var _teen_process = require("teen_process");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _utils = require("./utils");

var _semver = _interopRequireDefault(require("semver"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _compareVersions = _interopRequireDefault(require("compare-versions"));

var _storageClient = _interopRequireDefault(require("./storage-client"));

var _protocolHelpers = require("./protocol-helpers");

const log = _appiumSupport.logger.getLogger('Chromedriver');

const NEW_CD_VERSION_FORMAT_MAJOR_VERSION = 73;
const DEFAULT_HOST = '127.0.0.1';
const MIN_CD_VERSION_WITH_W3C_SUPPORT = 75;
const DEFAULT_PORT = 9515;
const CHROMEDRIVER_CHROME_MAPPING = {
  '76.0.3809.126': '76.0.3809.126',
  '76.0.3809.68': '76.0.3809.68',
  '76.0.3809.25': '76.0.3809.25',
  '76.0.3809.12': '76.0.3809.12',
  '75.0.3770.140': '75.0.3770.140',
  '75.0.3770.90': '75.0.3770.90',
  '75.0.3770.8': '75.0.3770.8',
  '74.0.3729.6': '74.0.3729',
  '73.0.3683.68': '70.0.3538',
  '2.46': '71.0.3578',
  '2.45': '70.0.0',
  '2.44': '69.0.3497',
  '2.43': '69.0.3497',
  '2.42': '68.0.3440',
  '2.41': '67.0.3396',
  '2.40': '66.0.3359',
  '2.39': '66.0.3359',
  '2.38': '65.0.3325',
  '2.37': '64.0.3282',
  '2.36': '63.0.3239',
  '2.35': '62.0.3202',
  '2.34': '61.0.3163',
  '2.33': '60.0.3112',
  '2.32': '59.0.3071',
  '2.31': '58.0.3029',
  '2.30': '58.0.3029',
  '2.29': '57.0.2987',
  '2.28': '55.0.2883',
  '2.27': '54.0.2840',
  '2.26': '53.0.2785',
  '2.25': '53.0.2785',
  '2.24': '52.0.2743',
  '2.23': '51.0.2704',
  '2.22': '49.0.2623',
  '2.21': '46.0.2490',
  '2.20': '43.0.2357',
  '2.19': '43.0.2357',
  '2.18': '43.0.2357',
  '2.17': '42.0.2311',
  '2.16': '42.0.2311',
  '2.15': '40.0.2214',
  '2.14': '39.0.2171',
  '2.13': '38.0.2125',
  '2.12': '36.0.1985',
  '2.11': '36.0.1985',
  '2.10': '33.0.1751',
  '2.9': '31.0.1650',
  '2.8': '30.0.1573',
  '2.7': '30.0.1573',
  '2.6': '29.0.1545',
  '2.5': '29.0.1545',
  '2.4': '29.0.1545',
  '2.3': '28.0.1500',
  '2.2': '27.0.1453',
  '2.1': '27.0.1453',
  '2.0': '27.0.1453'
};
exports.CHROMEDRIVER_CHROME_MAPPING = CHROMEDRIVER_CHROME_MAPPING;
const CHROME_BUNDLE_ID = 'com.android.chrome';
const WEBVIEW_BUNDLE_IDS = ['com.google.android.webview', 'com.android.webview'];
const CHROMEDRIVER_TUTORIAL = 'https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/web/chromedriver.md';
const CD_VER = process.env.npm_config_chromedriver_version || process.env.CHROMEDRIVER_VERSION || getMostRecentChromedriver();
exports.CD_VER = CD_VER;
const CD_VERSION_TIMEOUT = 5000;

function getMostRecentChromedriver(mapping = CHROMEDRIVER_CHROME_MAPPING) {
  if (_lodash.default.isEmpty(mapping)) {
    throw new Error('Unable to get most recent Chromedriver from empty mapping');
  }

  return _lodash.default.last(_lodash.default.keys(mapping).sort(_compareVersions.default));
}

class Chromedriver extends _events.default.EventEmitter {
  constructor(args = {}) {
    super();
    const {
      host = DEFAULT_HOST,
      port = DEFAULT_PORT,
      useSystemExecutable = false,
      executable,
      executableDir = (0, _utils.getChromedriverDir)(),
      bundleId,
      mappingPath,
      cmdArgs,
      adb,
      verbose,
      logPath,
      disableBuildCheck,
      isAutodownloadEnabled = false
    } = args;
    this.proxyHost = host;
    this.proxyPort = port;
    this.adb = adb;
    this.cmdArgs = cmdArgs;
    this.proc = null;
    this.useSystemExecutable = useSystemExecutable;
    this.chromedriver = executable;
    this.executableDir = executableDir;
    this.mappingPath = mappingPath;
    this.bundleId = bundleId;
    this.executableVerified = false;
    this.state = Chromedriver.STATE_STOPPED;
    this.jwproxy = new _appiumBaseDriver.JWProxy({
      server: this.proxyHost,
      port: this.proxyPort
    });
    this.verbose = verbose;
    this.logPath = logPath;
    this.disableBuildCheck = !!disableBuildCheck;
    this.storageClient = isAutodownloadEnabled ? new _storageClient.default({
      chromedriverDir: this.executableDir
    }) : null;
    this.capabilities = {};
    this.desiredProtocol = _appiumBaseDriver.PROTOCOLS.MJSONWP;
  }

  async getMapping() {
    let mapping = CHROMEDRIVER_CHROME_MAPPING;

    if (this.mappingPath) {
      log.debug(`Attempting to use Chromedriver-Chrome mapping from '${this.mappingPath}'`);

      if (!(await _appiumSupport.fs.exists(this.mappingPath))) {
        log.warn(`No file found at '${this.mappingPath}'. Using default mapping`);
      } else {
        try {
          mapping = JSON.parse((await _appiumSupport.fs.readFile(this.mappingPath)));
        } catch (err) {
          log.error(`Error parsing mapping from '${this.mappingPath}': ${err.message}`);
          log.warn('Using default mapping');
        }
      }
    }

    for (const [cdVersion, chromeVersion] of _lodash.default.toPairs(mapping)) {
      mapping[cdVersion] = _semver.default.coerce(chromeVersion);
    }

    return mapping;
  }

  async getChromedrivers(mapping) {
    const executables = await _appiumSupport.fs.glob(`${this.executableDir}/*`);
    log.debug(`Found ${executables.length} executable${executables.length === 1 ? '' : 's'} ` + `in '${this.executableDir}'`);
    const cds = (await (0, _asyncbox.asyncmap)(executables, async function mapChromedriver(executable) {
      const logError = ({
        message,
        stdout = null,
        stderr = null
      }) => {
        let errMsg = `Cannot retrieve version number from '${_path.default.basename(executable)}' Chromedriver binary. ` + `Make sure it returns a valid version string in response to '--version' command line argument. ${message}`;

        if (stdout) {
          errMsg += `\nStdout: ${stdout}`;
        }

        if (stderr) {
          errMsg += `\nStderr: ${stderr}`;
        }

        log.warn(errMsg);
        return null;
      };

      let stdout;
      let stderr;

      try {
        ({
          stdout,
          stderr
        } = await (0, _teen_process.exec)(executable, ['--version'], {
          timeout: CD_VERSION_TIMEOUT
        }));
      } catch (err) {
        if (!(err.message || '').includes('timed out') && !(err.stdout || '').includes('Starting ChromeDriver')) {
          return logError(err);
        }

        stdout = err.stdout;
      }

      const match = /ChromeDriver\s+\(?v?([\d.]+)\)?/i.exec(stdout);

      if (!match) {
        return logError({
          message: 'Cannot parse the version string',
          stdout,
          stderr
        });
      }

      let version = match[1];

      const coercedVersion = _semver.default.coerce(version);

      if (coercedVersion) {
        if (coercedVersion.major < NEW_CD_VERSION_FORMAT_MAJOR_VERSION) {
          version = `${coercedVersion.major}.${coercedVersion.minor}`;
        }
      }

      return {
        executable,
        version,
        minChromeVersion: mapping[version]
      };
    })).filter(cd => !!cd).sort((a, b) => (0, _compareVersions.default)(b.version, a.version));

    if (_lodash.default.isEmpty(cds)) {
      log.errorAndThrow(`No Chromedrivers found in '${this.executableDir}'`);
    }

    log.debug(`The following Chromedriver executables were found:`);

    for (const cd of cds) {
      log.debug(`    '${cd.executable}' (version '${cd.version}', minimum Chrome version '${cd.minChromeVersion ? cd.minChromeVersion : 'Unknown'}')`);
    }

    return cds;
  }

  async getChromeVersion() {
    let chromeVersion;

    if (this.adb && (await this.adb.getApiLevel()) >= 24) {
      this.bundleId = CHROME_BUNDLE_ID;
    }

    if (!this.bundleId) {
      this.bundleId = CHROME_BUNDLE_ID;

      for (const bundleId of WEBVIEW_BUNDLE_IDS) {
        chromeVersion = await (0, _utils.getChromeVersion)(this.adb, bundleId);

        if (chromeVersion) {
          this.bundleId = bundleId;
          break;
        }
      }
    }

    if (!chromeVersion) {
      chromeVersion = await (0, _utils.getChromeVersion)(this.adb, this.bundleId);
    }

    return chromeVersion ? _semver.default.coerce(chromeVersion) : null;
  }

  async getCompatibleChromedriver() {
    if (!this.adb) {
      return await (0, _utils.getChromedriverBinaryPath)();
    }

    const mapping = await this.getMapping();
    let didStorageSync = false;

    const syncChromedrivers = async chromeVersion => {
      didStorageSync = true;
      const retrievedMapping = await this.storageClient.retrieveMapping();
      log.debug('Got chromedrivers mapping from the storage: ' + JSON.stringify(retrievedMapping, null, 2));
      const driverKeys = await this.storageClient.syncDrivers({
        minBrowserVersion: chromeVersion.major
      });

      if (_lodash.default.isEmpty(driverKeys)) {
        return false;
      }

      const synchronizedDriversMapping = driverKeys.reduce((acc, x) => {
        const {
          version,
          minBrowserVersion
        } = retrievedMapping[x];
        acc[version] = minBrowserVersion;
        return acc;
      }, {});
      Object.assign(mapping, synchronizedDriversMapping);
      let shouldUpdateGlobalMapping = true;

      if (await _appiumSupport.fs.exists(this.mappingPath)) {
        try {
          await _appiumSupport.fs.writeFile(this.mappingPath, JSON.stringify(mapping, null, 2), 'utf8');
          shouldUpdateGlobalMapping = false;
        } catch (e) {
          log.warn(`Cannot store the updated chromedrivers mapping into '${this.mappingPath}'. ` + `This may reduce the performance of further executions. Original error: ${e.message}`);
        }
      }

      if (shouldUpdateGlobalMapping) {
        Object.assign(CHROMEDRIVER_CHROME_MAPPING, mapping);
      }

      return true;
    };

    do {
      const cds = await this.getChromedrivers(mapping);

      if (this.disableBuildCheck) {
        const {
          version,
          executable
        } = cds[0];
        log.warn(`Chrome build check disabled. Using most recent Chromedriver version (${version}, at '${executable}')`);
        log.warn(`If this is wrong, set 'chromedriverDisableBuildCheck' capability to 'false'`);
        return executable;
      }

      const chromeVersion = await this.getChromeVersion();

      if (!chromeVersion) {
        const {
          version,
          executable
        } = cds[0];
        log.warn(`Unable to discover Chrome version. Using Chromedriver ${version} at '${executable}'`);
        return executable;
      }

      log.debug(`Found Chrome bundle '${this.bundleId}' version '${chromeVersion}'`);
      const autodownloadMsg = this.storageClient && didStorageSync ? '' : '. You could also try to enable automated chromedrivers download server feature';

      if (_semver.default.gt(chromeVersion, _lodash.default.values(mapping)[0]) && cds[0] && !cds[0].minChromeVersion) {
        if (this.storageClient && !didStorageSync) {
          try {
            if (await syncChromedrivers(chromeVersion)) {
              continue;
            }
          } catch (e) {
            log.warn(e.stack);
          }
        }

        const {
          version,
          executable
        } = cds[0];
        log.warn(`No known Chromedriver available to automate Chrome version '${chromeVersion}'.\n` + `Using Chromedriver version '${version}', which has not been tested with Appium` + autodownloadMsg);
        return executable;
      }

      const workingCds = cds.filter(cd => {
        const versionObj = _semver.default.coerce(cd.minChromeVersion);

        return versionObj && chromeVersion.major === versionObj.major;
      });

      if (_lodash.default.isEmpty(workingCds)) {
        if (this.storageClient && !didStorageSync) {
          try {
            if (await syncChromedrivers(chromeVersion)) {
              continue;
            }
          } catch (e) {
            log.warn(e.stack);
          }
        }

        log.errorAndThrow(`No Chromedriver found that can automate Chrome '${chromeVersion}'. ` + `See ${CHROMEDRIVER_TUTORIAL} for more details` + autodownloadMsg);
      }

      const binPath = workingCds[0].executable;
      log.debug(`Found ${workingCds.length} Chromedriver executable${workingCds.length === 1 ? '' : 's'} ` + `capable of automating Chrome '${chromeVersion}'.\nChoosing the most recent, '${binPath}'.`);
      log.debug('If a specific version is required, specify it with the `chromedriverExecutable`' + 'desired capability.');
      return binPath;
    } while (true);
  }

  async initChromedriverPath() {
    if (this.executableVerified) return;

    if (!this.chromedriver) {
      this.chromedriver = this.useSystemExecutable ? await (0, _utils.getChromedriverBinaryPath)() : await this.getCompatibleChromedriver();
    }

    if (!(await _appiumSupport.fs.exists(this.chromedriver))) {
      throw new Error(`Trying to use a chromedriver binary at the path ` + `${this.chromedriver}, but it doesn't exist!`);
    }

    this.executableVerified = true;
    log.info(`Set chromedriver binary as: ${this.chromedriver}`);
  }

  syncProtocol(cdVersion = null) {
    const coercedVersion = _semver.default.coerce(cdVersion);

    if (!coercedVersion || coercedVersion.major < MIN_CD_VERSION_WITH_W3C_SUPPORT) {
      log.debug(`Chromedriver v. ${cdVersion} does not fully support ${_appiumBaseDriver.PROTOCOLS.W3C} protocol. ` + `Defaulting to ${_appiumBaseDriver.PROTOCOLS.MJSONWP}`);
      return;
    }

    const chromeOptions = (0, _protocolHelpers.getCapValue)(this.capabilities, 'chromeOptions', {});

    if (chromeOptions.w3c === false) {
      log.info(`Chromedriver v. ${cdVersion} supports ${_appiumBaseDriver.PROTOCOLS.W3C} protocol, ` + `but ${_appiumBaseDriver.PROTOCOLS.MJSONWP} one has been explicitly requested`);
      return;
    }

    this.desiredProtocol = _appiumBaseDriver.PROTOCOLS.W3C;
    this.capabilities = (0, _protocolHelpers.toW3cCapNames)(this.capabilities);
  }

  async start(caps, emitStartingState = true) {
    this.capabilities = _lodash.default.cloneDeep(caps);
    this.capabilities.loggingPrefs = _lodash.default.cloneDeep((0, _protocolHelpers.getCapValue)(caps, 'loggingPrefs', {}));

    if (_lodash.default.isEmpty(this.capabilities.loggingPrefs.browser)) {
      this.capabilities.loggingPrefs.browser = 'ALL';
    }

    if (emitStartingState) {
      this.changeState(Chromedriver.STATE_STARTING);
    }

    const args = ['--url-base=wd/hub', `--port=${this.proxyPort}`];

    if (this.adb && this.adb.adbPort) {
      args.push(`--adb-port=${this.adb.adbPort}`);
    }

    if (_lodash.default.isArray(this.cmdArgs)) {
      args.push(...this.cmdArgs);
    }

    if (this.logPath) {
      args.push(`--log-path=${this.logPath}`);
    }

    if (this.disableBuildCheck) {
      args.push('--disable-build-check');
    }

    args.push('--verbose');

    const startDetector = stdout => {
      return stdout.indexOf('Starting ') === 0;
    };

    let processIsAlive = false;
    let webviewVersion;

    try {
      await this.initChromedriverPath();
      await this.killAll();
      this.proc = new _teen_process.SubProcess(this.chromedriver, args);
      processIsAlive = true;
      this.proc.on('output', (stdout, stderr) => {
        const out = stdout + stderr;
        let match = /"Browser": "(.*)"/.exec(out);

        if (match) {
          webviewVersion = match[1];
          log.debug(`Webview version: '${webviewVersion}'`);
        }

        match = /Starting ChromeDriver ([.\d]+)/.exec(out);

        if (match) {
          log.debug(`Chromedriver version: '${match[1]}'`);
          this.syncProtocol(match[1]);
        }

        if (this.verbose) {
          for (let line of (stdout || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.debug(`[STDOUT] ${line}`);
          }

          for (let line of (stderr || '').trim().split('\n')) {
            if (!line.trim().length) continue;
            log.error(`[STDERR] ${line}`);
          }
        }
      });
      this.proc.on('exit', (code, signal) => {
        processIsAlive = false;

        if (this.state !== Chromedriver.STATE_STOPPED && this.state !== Chromedriver.STATE_STOPPING && this.state !== Chromedriver.STATE_RESTARTING) {
          let msg = `Chromedriver exited unexpectedly with code ${code}, ` + `signal ${signal}`;
          log.error(msg);
          this.changeState(Chromedriver.STATE_STOPPED);
        }
      });
      log.info(`Spawning chromedriver with: ${this.chromedriver} ` + `${args.join(' ')}`);
      await this.proc.start(startDetector);
      await this.waitForOnline();
      await this.startSession();
    } catch (e) {
      this.emit(Chromedriver.EVENT_ERROR, e);

      if (processIsAlive) {
        await this.proc.stop();
      }

      let message = '';

      if (e.message.includes('Chrome version must be')) {
        message += 'Unable to automate Chrome version because it is too old for this version of Chromedriver.\n';

        if (webviewVersion) {
          message += `Chrome version on the device: ${webviewVersion}\n`;
        }

        message += `Visit '${CHROMEDRIVER_TUTORIAL}' to troubleshoot the problem.\n`;
      }

      message += e.message;
      log.errorAndThrow(message);
    }
  }

  sessionId() {
    if (this.state !== Chromedriver.STATE_ONLINE) {
      return null;
    }

    return this.jwproxy.sessionId;
  }

  async restart() {
    log.info('Restarting chromedriver');

    if (this.state !== Chromedriver.STATE_ONLINE) {
      throw new Error("Can't restart when we're not online");
    }

    this.changeState(Chromedriver.STATE_RESTARTING);
    await this.stop(false);
    await this.start(this.capabilities, false);
  }

  async waitForOnline() {
    let chromedriverStopped = false;
    await (0, _asyncbox.retryInterval)(20, 200, async () => {
      if (this.state === Chromedriver.STATE_STOPPED) {
        chromedriverStopped = true;
        return;
      }

      await this.getStatus();
    });

    if (chromedriverStopped) {
      throw new Error('ChromeDriver crashed during startup.');
    }
  }

  async getStatus() {
    return await this.jwproxy.command('/status', 'GET');
  }

  async startSession() {
    const sessionCaps = this.desiredProtocol === _appiumBaseDriver.PROTOCOLS.W3C ? {
      capabilities: {
        alwaysMatch: this.capabilities
      }
    } : {
      desiredCapabilities: this.capabilities
    };
    log.info(`Starting ${this.desiredProtocol} Chromedriver session with capabilities: ` + JSON.stringify(sessionCaps, null, 2));
    await (0, _asyncbox.retryInterval)(4, 200, async () => {
      try {
        await this.jwproxy.command('/session', 'POST', sessionCaps);
      } catch (err) {
        log.warn(`Failed to start Chromedriver session: ${err.message}`);
        throw err;
      }
    });
    this.changeState(Chromedriver.STATE_ONLINE);
  }

  async stop(emitStates = true) {
    if (emitStates) {
      this.changeState(Chromedriver.STATE_STOPPING);
    }

    try {
      await this.jwproxy.command('', 'DELETE');
      await this.proc.stop('SIGTERM', 20000);

      if (emitStates) {
        this.changeState(Chromedriver.STATE_STOPPED);
      }
    } catch (e) {
      log.error(e);
    }
  }

  changeState(state) {
    this.state = state;
    log.debug(`Changed state to '${state}'`);
    this.emit(Chromedriver.EVENT_CHANGED, {
      state
    });
  }

  async sendCommand(url, method, body) {
    return await this.jwproxy.command(url, method, body);
  }

  async proxyReq(req, res) {
    return await this.jwproxy.proxyReqRes(req, res);
  }

  async killAll() {
    let cmd = _appiumSupport.system.isWindows() ? `wmic process where "commandline like '%chromedriver.exe%--port=${this.proxyPort}%'" delete` : `pkill -15 -f "${this.chromedriver}.*--port=${this.proxyPort}"`;
    log.debug(`Killing any old chromedrivers, running: ${cmd}`);

    try {
      await _bluebird.default.promisify(_child_process.default.exec)(cmd);
      log.debug('Successfully cleaned up old chromedrivers');
    } catch (err) {
      log.warn('No old chromedrivers seem to exist');
    }

    if (this.adb) {
      log.debug(`Cleaning any old adb forwarded port socket connections`);

      try {
        for (let conn of await this.adb.getForwardList()) {
          if (conn.indexOf('webview_devtools') !== -1) {
            let params = conn.split(/\s+/);

            if (params.length > 1) {
              await this.adb.removePortForward(params[1].replace(/[\D]*/, ''));
            }
          }
        }
      } catch (err) {
        log.warn(`Unable to clean forwarded ports. Error: '${err.message}'. Continuing.`);
      }
    }
  }

  async hasWorkingWebview() {
    try {
      await this.jwproxy.command('/url', 'GET');
      return true;
    } catch (e) {
      return false;
    }
  }

}

exports.Chromedriver = Chromedriver;
Chromedriver.EVENT_ERROR = 'chromedriver_error';
Chromedriver.EVENT_CHANGED = 'stateChanged';
Chromedriver.STATE_STOPPED = 'stopped';
Chromedriver.STATE_STARTING = 'starting';
Chromedriver.STATE_ONLINE = 'online';
Chromedriver.STATE_STOPPING = 'stopping';
Chromedriver.STATE_RESTARTING = 'restarting';
var _default = Chromedriver;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jaHJvbWVkcml2ZXIuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiTkVXX0NEX1ZFUlNJT05fRk9STUFUX01BSk9SX1ZFUlNJT04iLCJERUZBVUxUX0hPU1QiLCJNSU5fQ0RfVkVSU0lPTl9XSVRIX1czQ19TVVBQT1JUIiwiREVGQVVMVF9QT1JUIiwiQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HIiwiQ0hST01FX0JVTkRMRV9JRCIsIldFQlZJRVdfQlVORExFX0lEUyIsIkNIUk9NRURSSVZFUl9UVVRPUklBTCIsIkNEX1ZFUiIsInByb2Nlc3MiLCJlbnYiLCJucG1fY29uZmlnX2Nocm9tZWRyaXZlcl92ZXJzaW9uIiwiQ0hST01FRFJJVkVSX1ZFUlNJT04iLCJnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyIiwiQ0RfVkVSU0lPTl9USU1FT1VUIiwibWFwcGluZyIsIl8iLCJpc0VtcHR5IiwiRXJyb3IiLCJsYXN0Iiwia2V5cyIsInNvcnQiLCJjb21wYXJlVmVyc2lvbnMiLCJDaHJvbWVkcml2ZXIiLCJldmVudHMiLCJFdmVudEVtaXR0ZXIiLCJjb25zdHJ1Y3RvciIsImFyZ3MiLCJob3N0IiwicG9ydCIsInVzZVN5c3RlbUV4ZWN1dGFibGUiLCJleGVjdXRhYmxlIiwiZXhlY3V0YWJsZURpciIsImJ1bmRsZUlkIiwibWFwcGluZ1BhdGgiLCJjbWRBcmdzIiwiYWRiIiwidmVyYm9zZSIsImxvZ1BhdGgiLCJkaXNhYmxlQnVpbGRDaGVjayIsImlzQXV0b2Rvd25sb2FkRW5hYmxlZCIsInByb3h5SG9zdCIsInByb3h5UG9ydCIsInByb2MiLCJjaHJvbWVkcml2ZXIiLCJleGVjdXRhYmxlVmVyaWZpZWQiLCJzdGF0ZSIsIlNUQVRFX1NUT1BQRUQiLCJqd3Byb3h5IiwiSldQcm94eSIsInNlcnZlciIsInN0b3JhZ2VDbGllbnQiLCJDaHJvbWVkcml2ZXJTdG9yYWdlQ2xpZW50IiwiY2hyb21lZHJpdmVyRGlyIiwiY2FwYWJpbGl0aWVzIiwiZGVzaXJlZFByb3RvY29sIiwiUFJPVE9DT0xTIiwiTUpTT05XUCIsImdldE1hcHBpbmciLCJkZWJ1ZyIsImZzIiwiZXhpc3RzIiwid2FybiIsIkpTT04iLCJwYXJzZSIsInJlYWRGaWxlIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIiwiY2RWZXJzaW9uIiwiY2hyb21lVmVyc2lvbiIsInRvUGFpcnMiLCJzZW12ZXIiLCJjb2VyY2UiLCJnZXRDaHJvbWVkcml2ZXJzIiwiZXhlY3V0YWJsZXMiLCJnbG9iIiwibGVuZ3RoIiwiY2RzIiwibWFwQ2hyb21lZHJpdmVyIiwibG9nRXJyb3IiLCJzdGRvdXQiLCJzdGRlcnIiLCJlcnJNc2ciLCJwYXRoIiwiYmFzZW5hbWUiLCJ0aW1lb3V0IiwiaW5jbHVkZXMiLCJtYXRjaCIsImV4ZWMiLCJ2ZXJzaW9uIiwiY29lcmNlZFZlcnNpb24iLCJtYWpvciIsIm1pbm9yIiwibWluQ2hyb21lVmVyc2lvbiIsImZpbHRlciIsImNkIiwiYSIsImIiLCJlcnJvckFuZFRocm93IiwiZ2V0Q2hyb21lVmVyc2lvbiIsImdldEFwaUxldmVsIiwiZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciIsImRpZFN0b3JhZ2VTeW5jIiwic3luY0Nocm9tZWRyaXZlcnMiLCJyZXRyaWV2ZWRNYXBwaW5nIiwicmV0cmlldmVNYXBwaW5nIiwic3RyaW5naWZ5IiwiZHJpdmVyS2V5cyIsInN5bmNEcml2ZXJzIiwibWluQnJvd3NlclZlcnNpb24iLCJzeW5jaHJvbml6ZWREcml2ZXJzTWFwcGluZyIsInJlZHVjZSIsImFjYyIsIngiLCJPYmplY3QiLCJhc3NpZ24iLCJzaG91bGRVcGRhdGVHbG9iYWxNYXBwaW5nIiwid3JpdGVGaWxlIiwiZSIsImF1dG9kb3dubG9hZE1zZyIsImd0IiwidmFsdWVzIiwic3RhY2siLCJ3b3JraW5nQ2RzIiwidmVyc2lvbk9iaiIsImJpblBhdGgiLCJpbml0Q2hyb21lZHJpdmVyUGF0aCIsImluZm8iLCJzeW5jUHJvdG9jb2wiLCJXM0MiLCJjaHJvbWVPcHRpb25zIiwidzNjIiwic3RhcnQiLCJjYXBzIiwiZW1pdFN0YXJ0aW5nU3RhdGUiLCJjbG9uZURlZXAiLCJsb2dnaW5nUHJlZnMiLCJicm93c2VyIiwiY2hhbmdlU3RhdGUiLCJTVEFURV9TVEFSVElORyIsImFkYlBvcnQiLCJwdXNoIiwiaXNBcnJheSIsInN0YXJ0RGV0ZWN0b3IiLCJpbmRleE9mIiwicHJvY2Vzc0lzQWxpdmUiLCJ3ZWJ2aWV3VmVyc2lvbiIsImtpbGxBbGwiLCJTdWJQcm9jZXNzIiwib24iLCJvdXQiLCJsaW5lIiwidHJpbSIsInNwbGl0IiwiY29kZSIsInNpZ25hbCIsIlNUQVRFX1NUT1BQSU5HIiwiU1RBVEVfUkVTVEFSVElORyIsIm1zZyIsImpvaW4iLCJ3YWl0Rm9yT25saW5lIiwic3RhcnRTZXNzaW9uIiwiZW1pdCIsIkVWRU5UX0VSUk9SIiwic3RvcCIsInNlc3Npb25JZCIsIlNUQVRFX09OTElORSIsInJlc3RhcnQiLCJjaHJvbWVkcml2ZXJTdG9wcGVkIiwiZ2V0U3RhdHVzIiwiY29tbWFuZCIsInNlc3Npb25DYXBzIiwiYWx3YXlzTWF0Y2giLCJkZXNpcmVkQ2FwYWJpbGl0aWVzIiwiZW1pdFN0YXRlcyIsIkVWRU5UX0NIQU5HRUQiLCJzZW5kQ29tbWFuZCIsInVybCIsIm1ldGhvZCIsImJvZHkiLCJwcm94eVJlcSIsInJlcSIsInJlcyIsInByb3h5UmVxUmVzIiwiY21kIiwic3lzdGVtIiwiaXNXaW5kb3dzIiwiQiIsInByb21pc2lmeSIsImNwIiwiY29ubiIsImdldEZvcndhcmRMaXN0IiwicGFyYW1zIiwicmVtb3ZlUG9ydEZvcndhcmQiLCJyZXBsYWNlIiwiaGFzV29ya2luZ1dlYnZpZXciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUdBLE1BQU1BLEdBQUcsR0FBR0Msc0JBQU9DLFNBQVAsQ0FBaUIsY0FB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LFVBQTlCO0FBQ0FySCxZQUFZLENBQUNnSixZQUFiLEdBQTRCLFFBQTVCO0FBQ0FoSixZQUFZLENBQUNzSSxjQUFiLEdBQThCLFVBQTlCO0FBQ0F0SSxZQUFZLENBQUN1SSxnQkFBYixHQUFnQyxZQUFoQztlQUtldkksWSIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRyYW5zcGlsZTptYWluXG5cbmltcG9ydCBldmVudHMgZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IEpXUHJveHksIFBST1RPQ09MUyB9IGZyb20gJ2FwcGl1bS1iYXNlLWRyaXZlcic7XG5pbXBvcnQgY3AgZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyBzeXN0ZW0sIGZzLCBsb2dnZXIgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgeyByZXRyeUludGVydmFsLCBhc3luY21hcCB9IGZyb20gJ2FzeW5jYm94JztcbmltcG9ydCB7IFN1YlByb2Nlc3MsIGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHtcbiAgZ2V0Q2hyb21lVmVyc2lvbiwgZ2V0Q2hyb21lZHJpdmVyRGlyLCBnZXRDaHJvbWVkcml2ZXJCaW5hcnlQYXRoXG59IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHNlbXZlciBmcm9tICdzZW12ZXInO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IGNvbXBhcmVWZXJzaW9ucyBmcm9tICdjb21wYXJlLXZlcnNpb25zJztcbmltcG9ydCBDaHJvbWVkcml2ZXJTdG9yYWdlQ2xpZW50IGZyb20gJy4vc3RvcmFnZS1jbGllbnQnO1xuaW1wb3J0IHsgdG9XM2NDYXBOYW1lcywgZ2V0Q2FwVmFsdWUgfSBmcm9tICcuL3Byb3RvY29sLWhlbHBlcnMnO1xuXG5cbmNvbnN0IGxvZyA9IGxvZ2dlci5nZXRMb2dnZXIoJ0Nocm9tZWRyaXZlcicpO1xuXG5jb25zdCBORVdfQ0RfVkVSU0lPTl9GT1JNQVRfTUFKT1JfVkVSU0lPTiA9IDczO1xuY29uc3QgREVGQVVMVF9IT1NUID0gJzEyNy4wLjAuMSc7XG5jb25zdCBNSU5fQ0RfVkVSU0lPTl9XSVRIX1czQ19TVVBQT1JUID0gNzU7XG5jb25zdCBERUZBVUxUX1BPUlQgPSA5NTE1O1xuY29uc3QgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HID0ge1xuICAvLyBDaHJvbWVkcml2ZXIgdmVyc2lvbjogbWludW11bSBDaHJvbWUgdmVyc2lvblxuICAnNzYuMC4zODA5LjEyNic6ICc3Ni4wLjM4MDkuMTI2JyxcbiAgJzc2LjAuMzgwOS42OCc6ICc3Ni4wLjM4MDkuNjgnLFxuICAnNzYuMC4zODA5LjI1JzogJzc2LjAuMzgwOS4yNScsXG4gICc3Ni4wLjM4MDkuMTInOiAnNzYuMC4zODA5LjEyJyxcbiAgJzc1LjAuMzc3MC4xNDAnOiAnNzUuMC4zNzcwLjE0MCcsXG4gICc3NS4wLjM3NzAuOTAnOiAnNzUuMC4zNzcwLjkwJyxcbiAgJzc1LjAuMzc3MC44JzogJzc1LjAuMzc3MC44JyxcbiAgJzc0LjAuMzcyOS42JzogJzc0LjAuMzcyOScsXG4gICc3My4wLjM2ODMuNjgnOiAnNzAuMC4zNTM4JyxcbiAgJzIuNDYnOiAnNzEuMC4zNTc4JyxcbiAgJzIuNDUnOiAnNzAuMC4wJyxcbiAgJzIuNDQnOiAnNjkuMC4zNDk3JyxcbiAgJzIuNDMnOiAnNjkuMC4zNDk3JyxcbiAgJzIuNDInOiAnNjguMC4zNDQwJyxcbiAgJzIuNDEnOiAnNjcuMC4zMzk2JyxcbiAgJzIuNDAnOiAnNjYuMC4zMzU5JyxcbiAgJzIuMzknOiAnNjYuMC4zMzU5JyxcbiAgJzIuMzgnOiAnNjUuMC4zMzI1JyxcbiAgJzIuMzcnOiAnNjQuMC4zMjgyJyxcbiAgJzIuMzYnOiAnNjMuMC4zMjM5JyxcbiAgJzIuMzUnOiAnNjIuMC4zMjAyJyxcbiAgJzIuMzQnOiAnNjEuMC4zMTYzJyxcbiAgJzIuMzMnOiAnNjAuMC4zMTEyJyxcbiAgJzIuMzInOiAnNTkuMC4zMDcxJyxcbiAgJzIuMzEnOiAnNTguMC4zMDI5JyxcbiAgJzIuMzAnOiAnNTguMC4zMDI5JyxcbiAgJzIuMjknOiAnNTcuMC4yOTg3JyxcbiAgJzIuMjgnOiAnNTUuMC4yODgzJyxcbiAgJzIuMjcnOiAnNTQuMC4yODQwJyxcbiAgJzIuMjYnOiAnNTMuMC4yNzg1JyxcbiAgJzIuMjUnOiAnNTMuMC4yNzg1JyxcbiAgJzIuMjQnOiAnNTIuMC4yNzQzJyxcbiAgJzIuMjMnOiAnNTEuMC4yNzA0JyxcbiAgJzIuMjInOiAnNDkuMC4yNjIzJyxcbiAgJzIuMjEnOiAnNDYuMC4yNDkwJyxcbiAgJzIuMjAnOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTknOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTgnOiAnNDMuMC4yMzU3JyxcbiAgJzIuMTcnOiAnNDIuMC4yMzExJyxcbiAgJzIuMTYnOiAnNDIuMC4yMzExJyxcbiAgJzIuMTUnOiAnNDAuMC4yMjE0JyxcbiAgJzIuMTQnOiAnMzkuMC4yMTcxJyxcbiAgJzIuMTMnOiAnMzguMC4yMTI1JyxcbiAgJzIuMTInOiAnMzYuMC4xOTg1JyxcbiAgJzIuMTEnOiAnMzYuMC4xOTg1JyxcbiAgJzIuMTAnOiAnMzMuMC4xNzUxJyxcbiAgJzIuOSc6ICczMS4wLjE2NTAnLFxuICAnMi44JzogJzMwLjAuMTU3MycsXG4gICcyLjcnOiAnMzAuMC4xNTczJyxcbiAgJzIuNic6ICcyOS4wLjE1NDUnLFxuICAnMi41JzogJzI5LjAuMTU0NScsXG4gICcyLjQnOiAnMjkuMC4xNTQ1JyxcbiAgJzIuMyc6ICcyOC4wLjE1MDAnLFxuICAnMi4yJzogJzI3LjAuMTQ1MycsXG4gICcyLjEnOiAnMjcuMC4xNDUzJyxcbiAgJzIuMCc6ICcyNy4wLjE0NTMnLFxufTtcbmNvbnN0IENIUk9NRV9CVU5ETEVfSUQgPSAnY29tLmFuZHJvaWQuY2hyb21lJztcbmNvbnN0IFdFQlZJRVdfQlVORExFX0lEUyA9IFtcbiAgJ2NvbS5nb29nbGUuYW5kcm9pZC53ZWJ2aWV3JyxcbiAgJ2NvbS5hbmRyb2lkLndlYnZpZXcnLFxuXTtcbmNvbnN0IENIUk9NRURSSVZFUl9UVVRPUklBTCA9ICdodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9ibG9iL21hc3Rlci9kb2NzL2VuL3dyaXRpbmctcnVubmluZy1hcHBpdW0vd2ViL2Nocm9tZWRyaXZlci5tZCc7XG5cbmNvbnN0IENEX1ZFUiA9IHByb2Nlc3MuZW52Lm5wbV9jb25maWdfY2hyb21lZHJpdmVyX3ZlcnNpb24gfHxcbiAgICAgICAgICAgICAgIHByb2Nlc3MuZW52LkNIUk9NRURSSVZFUl9WRVJTSU9OIHx8XG4gICAgICAgICAgICAgICBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyKCk7XG5cbmNvbnN0IENEX1ZFUlNJT05fVElNRU9VVCA9IDUwMDA7XG5cbmZ1bmN0aW9uIGdldE1vc3RSZWNlbnRDaHJvbWVkcml2ZXIgKG1hcHBpbmcgPSBDSFJPTUVEUklWRVJfQ0hST01FX01BUFBJTkcpIHtcbiAgaWYgKF8uaXNFbXB0eShtYXBwaW5nKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGdldCBtb3N0IHJlY2VudCBDaHJvbWVkcml2ZXIgZnJvbSBlbXB0eSBtYXBwaW5nJyk7XG4gIH1cbiAgcmV0dXJuIF8ubGFzdChfLmtleXMobWFwcGluZykuc29ydChjb21wYXJlVmVyc2lvbnMpKTtcbn1cblxuY2xhc3MgQ2hyb21lZHJpdmVyIGV4dGVuZHMgZXZlbnRzLkV2ZW50RW1pdHRlciB7XG4gIGNvbnN0cnVjdG9yIChhcmdzID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgY29uc3Qge1xuICAgICAgaG9zdCA9IERFRkFVTFRfSE9TVCxcbiAgICAgIHBvcnQgPSBERUZBVUxUX1BPUlQsXG4gICAgICB1c2VTeXN0ZW1FeGVjdXRhYmxlID0gZmFsc2UsXG4gICAgICBleGVjdXRhYmxlLFxuICAgICAgZXhlY3V0YWJsZURpciA9IGdldENocm9tZWRyaXZlckRpcigpLFxuICAgICAgYnVuZGxlSWQsXG4gICAgICBtYXBwaW5nUGF0aCxcbiAgICAgIGNtZEFyZ3MsXG4gICAgICBhZGIsXG4gICAgICB2ZXJib3NlLFxuICAgICAgbG9nUGF0aCxcbiAgICAgIGRpc2FibGVCdWlsZENoZWNrLFxuICAgICAgaXNBdXRvZG93bmxvYWRFbmFibGVkID0gZmFsc2UsXG4gICAgfSA9IGFyZ3M7XG5cbiAgICB0aGlzLnByb3h5SG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5wcm94eVBvcnQgPSBwb3J0O1xuICAgIHRoaXMuYWRiID0gYWRiO1xuICAgIHRoaXMuY21kQXJncyA9IGNtZEFyZ3M7XG4gICAgdGhpcy5wcm9jID0gbnVsbDtcbiAgICB0aGlzLnVzZVN5c3RlbUV4ZWN1dGFibGUgPSB1c2VTeXN0ZW1FeGVjdXRhYmxlO1xuICAgIHRoaXMuY2hyb21lZHJpdmVyID0gZXhlY3V0YWJsZTtcbiAgICB0aGlzLmV4ZWN1dGFibGVEaXIgPSBleGVjdXRhYmxlRGlyO1xuICAgIHRoaXMubWFwcGluZ1BhdGggPSBtYXBwaW5nUGF0aDtcbiAgICB0aGlzLmJ1bmRsZUlkID0gYnVuZGxlSWQ7XG4gICAgdGhpcy5leGVjdXRhYmxlVmVyaWZpZWQgPSBmYWxzZTtcbiAgICB0aGlzLnN0YXRlID0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQ7XG4gICAgdGhpcy5qd3Byb3h5ID0gbmV3IEpXUHJveHkoe3NlcnZlcjogdGhpcy5wcm94eUhvc3QsIHBvcnQ6IHRoaXMucHJveHlQb3J0fSk7XG4gICAgdGhpcy52ZXJib3NlID0gdmVyYm9zZTtcbiAgICB0aGlzLmxvZ1BhdGggPSBsb2dQYXRoO1xuICAgIHRoaXMuZGlzYWJsZUJ1aWxkQ2hlY2sgPSAhIWRpc2FibGVCdWlsZENoZWNrO1xuICAgIHRoaXMuc3RvcmFnZUNsaWVudCA9IGlzQXV0b2Rvd25sb2FkRW5hYmxlZFxuICAgICAgPyBuZXcgQ2hyb21lZHJpdmVyU3RvcmFnZUNsaWVudCh7IGNocm9tZWRyaXZlckRpcjogdGhpcy5leGVjdXRhYmxlRGlyIH0pXG4gICAgICA6IG51bGw7XG4gICAgdGhpcy5jYXBhYmlsaXRpZXMgPSB7fTtcbiAgICB0aGlzLmRlc2lyZWRQcm90b2NvbCA9IFBST1RPQ09MUy5NSlNPTldQO1xuICB9XG5cbiAgYXN5bmMgZ2V0TWFwcGluZyAoKSB7XG4gICAgbGV0IG1hcHBpbmcgPSBDSFJPTUVEUklWRVJfQ0hST01FX01BUFBJTkc7XG4gICAgaWYgKHRoaXMubWFwcGluZ1BhdGgpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQXR0ZW1wdGluZyB0byB1c2UgQ2hyb21lZHJpdmVyLUNocm9tZSBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nYCk7XG4gICAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyh0aGlzLm1hcHBpbmdQYXRoKSkge1xuICAgICAgICBsb2cud2FybihgTm8gZmlsZSBmb3VuZCBhdCAnJHt0aGlzLm1hcHBpbmdQYXRofScuIFVzaW5nIGRlZmF1bHQgbWFwcGluZ2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBtYXBwaW5nID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRmlsZSh0aGlzLm1hcHBpbmdQYXRoKSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGxvZy5lcnJvcihgRXJyb3IgcGFyc2luZyBtYXBwaW5nIGZyb20gJyR7dGhpcy5tYXBwaW5nUGF0aH0nOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICAgIGxvZy53YXJuKCdVc2luZyBkZWZhdWx0IG1hcHBpbmcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoZSB2YWx1ZXMgZm9yIG1pbmltdW0gY2hyb21lIHZlcnNpb24gYXJlIHNlbXZlciBjb21wbGlhbnRcbiAgICBmb3IgKGNvbnN0IFtjZFZlcnNpb24sIGNocm9tZVZlcnNpb25dIG9mIF8udG9QYWlycyhtYXBwaW5nKSkge1xuICAgICAgbWFwcGluZ1tjZFZlcnNpb25dID0gc2VtdmVyLmNvZXJjZShjaHJvbWVWZXJzaW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIG1hcHBpbmc7XG4gIH1cblxuICBhc3luYyBnZXRDaHJvbWVkcml2ZXJzIChtYXBwaW5nKSB7XG4gICAgLy8gZ28gdGhyb3VnaCB0aGUgdmVyc2lvbnMgYXZhaWxhYmxlXG4gICAgY29uc3QgZXhlY3V0YWJsZXMgPSBhd2FpdCBmcy5nbG9iKGAke3RoaXMuZXhlY3V0YWJsZURpcn0vKmApO1xuICAgIGxvZy5kZWJ1ZyhgRm91bmQgJHtleGVjdXRhYmxlcy5sZW5ndGh9IGV4ZWN1dGFibGUke2V4ZWN1dGFibGVzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBgICtcbiAgICAgIGBpbiAnJHt0aGlzLmV4ZWN1dGFibGVEaXJ9J2ApO1xuICAgIGNvbnN0IGNkcyA9IChhd2FpdCBhc3luY21hcChleGVjdXRhYmxlcywgYXN5bmMgZnVuY3Rpb24gbWFwQ2hyb21lZHJpdmVyIChleGVjdXRhYmxlKSB7XG4gICAgICBjb25zdCBsb2dFcnJvciA9ICh7bWVzc2FnZSwgc3Rkb3V0ID0gbnVsbCwgc3RkZXJyID0gbnVsbH0pID0+IHtcbiAgICAgICAgbGV0IGVyck1zZyA9IGBDYW5ub3QgcmV0cmlldmUgdmVyc2lvbiBudW1iZXIgZnJvbSAnJHtwYXRoLmJhc2VuYW1lKGV4ZWN1dGFibGUpfScgQ2hyb21lZHJpdmVyIGJpbmFyeS4gYCArXG4gICAgICAgICAgYE1ha2Ugc3VyZSBpdCByZXR1cm5zIGEgdmFsaWQgdmVyc2lvbiBzdHJpbmcgaW4gcmVzcG9uc2UgdG8gJy0tdmVyc2lvbicgY29tbWFuZCBsaW5lIGFyZ3VtZW50LiAke21lc3NhZ2V9YDtcbiAgICAgICAgaWYgKHN0ZG91dCkge1xuICAgICAgICAgIGVyck1zZyArPSBgXFxuU3Rkb3V0OiAke3N0ZG91dH1gO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGRlcnIpIHtcbiAgICAgICAgICBlcnJNc2cgKz0gYFxcblN0ZGVycjogJHtzdGRlcnJ9YDtcbiAgICAgICAgfVxuICAgICAgICBsb2cud2FybihlcnJNc2cpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG5cbiAgICAgIGxldCBzdGRvdXQ7XG4gICAgICBsZXQgc3RkZXJyO1xuICAgICAgdHJ5IHtcbiAgICAgICAgKHtzdGRvdXQsIHN0ZGVycn0gPSBhd2FpdCBleGVjKGV4ZWN1dGFibGUsIFsnLS12ZXJzaW9uJ10sIHtcbiAgICAgICAgICB0aW1lb3V0OiBDRF9WRVJTSU9OX1RJTUVPVVQsXG4gICAgICAgIH0pKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIubWVzc2FnZSB8fCAnJykuaW5jbHVkZXMoJ3RpbWVkIG91dCcpICYmICEoZXJyLnN0ZG91dCB8fCAnJykuaW5jbHVkZXMoJ1N0YXJ0aW5nIENocm9tZURyaXZlcicpKSB7XG4gICAgICAgICAgcmV0dXJuIGxvZ0Vycm9yKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGlzIGhhcyB0aW1lZCBvdXQsIGl0IGhhcyBhY3R1YWxseSBzdGFydGVkIENocm9tZWRyaXZlcixcbiAgICAgICAgLy8gaW4gd2hpY2ggY2FzZSB0aGVyZSB3aWxsIGFsc28gYmUgdGhlIHZlcnNpb24gc3RyaW5nIGluIHRoZSBvdXRwdXRcbiAgICAgICAgc3Rkb3V0ID0gZXJyLnN0ZG91dDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgbWF0Y2ggPSAvQ2hyb21lRHJpdmVyXFxzK1xcKD92PyhbXFxkLl0rKVxcKT8vaS5leGVjKHN0ZG91dCk7IC8vIGh0dHBzOi8vcmVnZXgxMDEuY29tL3IvenBqNXdBLzFcbiAgICAgIGlmICghbWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIGxvZ0Vycm9yKHttZXNzYWdlOiAnQ2Fubm90IHBhcnNlIHRoZSB2ZXJzaW9uIHN0cmluZycsIHN0ZG91dCwgc3RkZXJyfSk7XG4gICAgICB9XG4gICAgICBsZXQgdmVyc2lvbiA9IG1hdGNoWzFdO1xuICAgICAgY29uc3QgY29lcmNlZFZlcnNpb24gPSBzZW12ZXIuY29lcmNlKHZlcnNpb24pO1xuICAgICAgaWYgKGNvZXJjZWRWZXJzaW9uKSB7XG4gICAgICAgIC8vIGJlZm9yZSAyMDE5LTAzLTA2IHZlcnNpb25zIHdlcmUgb2YgdGhlIGZvcm0gbWFqb3IubWlub3JcbiAgICAgICAgaWYgKGNvZXJjZWRWZXJzaW9uLm1ham9yIDwgTkVXX0NEX1ZFUlNJT05fRk9STUFUX01BSk9SX1ZFUlNJT04pIHtcbiAgICAgICAgICB2ZXJzaW9uID0gYCR7Y29lcmNlZFZlcnNpb24ubWFqb3J9LiR7Y29lcmNlZFZlcnNpb24ubWlub3J9YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXhlY3V0YWJsZSxcbiAgICAgICAgdmVyc2lvbixcbiAgICAgICAgbWluQ2hyb21lVmVyc2lvbjogbWFwcGluZ1t2ZXJzaW9uXSxcbiAgICAgIH07XG4gICAgfSkpXG4gICAgICAuZmlsdGVyKChjZCkgPT4gISFjZClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBjb21wYXJlVmVyc2lvbnMoYi52ZXJzaW9uLCBhLnZlcnNpb24pKTtcbiAgICBpZiAoXy5pc0VtcHR5KGNkcykpIHtcbiAgICAgIGxvZy5lcnJvckFuZFRocm93KGBObyBDaHJvbWVkcml2ZXJzIGZvdW5kIGluICcke3RoaXMuZXhlY3V0YWJsZURpcn0nYCk7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgVGhlIGZvbGxvd2luZyBDaHJvbWVkcml2ZXIgZXhlY3V0YWJsZXMgd2VyZSBmb3VuZDpgKTtcbiAgICBmb3IgKGNvbnN0IGNkIG9mIGNkcykge1xuICAgICAgbG9nLmRlYnVnKGAgICAgJyR7Y2QuZXhlY3V0YWJsZX0nICh2ZXJzaW9uICcke2NkLnZlcnNpb259JywgbWluaW11bSBDaHJvbWUgdmVyc2lvbiAnJHtjZC5taW5DaHJvbWVWZXJzaW9uID8gY2QubWluQ2hyb21lVmVyc2lvbiA6ICdVbmtub3duJ30nKWApO1xuICAgIH1cbiAgICByZXR1cm4gY2RzO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q2hyb21lVmVyc2lvbiAoKSB7XG4gICAgbGV0IGNocm9tZVZlcnNpb247XG5cbiAgICAvLyBvbiBBbmRyb2lkIDcrIHdlYnZpZXdzIGFyZSBiYWNrZWQgYnkgdGhlIG1haW4gQ2hyb21lLCBub3QgdGhlIHN5c3RlbSB3ZWJ2aWV3XG4gICAgaWYgKHRoaXMuYWRiICYmIGF3YWl0IHRoaXMuYWRiLmdldEFwaUxldmVsKCkgPj0gMjQpIHtcbiAgICAgIHRoaXMuYnVuZGxlSWQgPSBDSFJPTUVfQlVORExFX0lEO1xuICAgIH1cblxuICAgIC8vIHRyeSBvdXQgd2Vidmlld3Mgd2hlbiBubyBidW5kbGUgaWQgaXMgc2VudCBpblxuICAgIGlmICghdGhpcy5idW5kbGVJZCkge1xuICAgICAgLy8gZGVmYXVsdCB0byB0aGUgZ2VuZXJpYyBDaHJvbWUgYnVuZGxlXG4gICAgICB0aGlzLmJ1bmRsZUlkID0gQ0hST01FX0JVTkRMRV9JRDtcblxuICAgICAgLy8gd2UgaGF2ZSBhIHdlYnZpZXcgb2Ygc29tZSBzb3J0LCBzbyB0cnkgdG8gZmluZCB0aGUgYnVuZGxlIHZlcnNpb25cbiAgICAgIGZvciAoY29uc3QgYnVuZGxlSWQgb2YgV0VCVklFV19CVU5ETEVfSURTKSB7XG4gICAgICAgIGNocm9tZVZlcnNpb24gPSBhd2FpdCBnZXRDaHJvbWVWZXJzaW9uKHRoaXMuYWRiLCBidW5kbGVJZCk7XG4gICAgICAgIGlmIChjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgICAgdGhpcy5idW5kbGVJZCA9IGJ1bmRsZUlkO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gaWYgd2UgZG8gbm90IGhhdmUgYSBjaHJvbWUgdmVyc2lvbiwgaXQgbXVzdCBub3QgYmUgYSB3ZWJ2aWV3XG4gICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICBjaHJvbWVWZXJzaW9uID0gYXdhaXQgZ2V0Q2hyb21lVmVyc2lvbih0aGlzLmFkYiwgdGhpcy5idW5kbGVJZCk7XG4gICAgfVxuXG4gICAgLy8gbWFrZSBzdXJlIGl0IGlzIHNlbXZlciwgc28gbGF0ZXIgY2hlY2tzIHdvbid0IGZhaWxcbiAgICByZXR1cm4gY2hyb21lVmVyc2lvbiA/IHNlbXZlci5jb2VyY2UoY2hyb21lVmVyc2lvbikgOiBudWxsO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlciAoKSB7XG4gICAgaWYgKCF0aGlzLmFkYikge1xuICAgICAgcmV0dXJuIGF3YWl0IGdldENocm9tZWRyaXZlckJpbmFyeVBhdGgoKTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXBwaW5nID0gYXdhaXQgdGhpcy5nZXRNYXBwaW5nKCk7XG4gICAgbGV0IGRpZFN0b3JhZ2VTeW5jID0gZmFsc2U7XG4gICAgY29uc3Qgc3luY0Nocm9tZWRyaXZlcnMgPSBhc3luYyAoY2hyb21lVmVyc2lvbikgPT4ge1xuICAgICAgZGlkU3RvcmFnZVN5bmMgPSB0cnVlO1xuICAgICAgY29uc3QgcmV0cmlldmVkTWFwcGluZyA9IGF3YWl0IHRoaXMuc3RvcmFnZUNsaWVudC5yZXRyaWV2ZU1hcHBpbmcoKTtcbiAgICAgIGxvZy5kZWJ1ZygnR290IGNocm9tZWRyaXZlcnMgbWFwcGluZyBmcm9tIHRoZSBzdG9yYWdlOiAnICtcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkocmV0cmlldmVkTWFwcGluZywgbnVsbCwgMikpO1xuICAgICAgY29uc3QgZHJpdmVyS2V5cyA9IGF3YWl0IHRoaXMuc3RvcmFnZUNsaWVudC5zeW5jRHJpdmVycyh7XG4gICAgICAgIG1pbkJyb3dzZXJWZXJzaW9uOiBjaHJvbWVWZXJzaW9uLm1ham9yLFxuICAgICAgfSk7XG4gICAgICBpZiAoXy5pc0VtcHR5KGRyaXZlcktleXMpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN5bmNocm9uaXplZERyaXZlcnNNYXBwaW5nID0gZHJpdmVyS2V5cy5yZWR1Y2UoKGFjYywgeCkgPT4ge1xuICAgICAgICBjb25zdCB7dmVyc2lvbiwgbWluQnJvd3NlclZlcnNpb259ID0gcmV0cmlldmVkTWFwcGluZ1t4XTtcbiAgICAgICAgYWNjW3ZlcnNpb25dID0gbWluQnJvd3NlclZlcnNpb247XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgICB9LCB7fSk7XG4gICAgICBPYmplY3QuYXNzaWduKG1hcHBpbmcsIHN5bmNocm9uaXplZERyaXZlcnNNYXBwaW5nKTtcbiAgICAgIGxldCBzaG91bGRVcGRhdGVHbG9iYWxNYXBwaW5nID0gdHJ1ZTtcbiAgICAgIGlmIChhd2FpdCBmcy5leGlzdHModGhpcy5tYXBwaW5nUGF0aCkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUodGhpcy5tYXBwaW5nUGF0aCwgSlNPTi5zdHJpbmdpZnkobWFwcGluZywgbnVsbCwgMiksICd1dGY4Jyk7XG4gICAgICAgICAgc2hvdWxkVXBkYXRlR2xvYmFsTWFwcGluZyA9IGZhbHNlO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgbG9nLndhcm4oYENhbm5vdCBzdG9yZSB0aGUgdXBkYXRlZCBjaHJvbWVkcml2ZXJzIG1hcHBpbmcgaW50byAnJHt0aGlzLm1hcHBpbmdQYXRofScuIGAgK1xuICAgICAgICAgICAgYFRoaXMgbWF5IHJlZHVjZSB0aGUgcGVyZm9ybWFuY2Ugb2YgZnVydGhlciBleGVjdXRpb25zLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzaG91bGRVcGRhdGVHbG9iYWxNYXBwaW5nKSB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24oQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HLCBtYXBwaW5nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICBkbyB7XG4gICAgICBjb25zdCBjZHMgPSBhd2FpdCB0aGlzLmdldENocm9tZWRyaXZlcnMobWFwcGluZyk7XG5cbiAgICAgIGlmICh0aGlzLmRpc2FibGVCdWlsZENoZWNrKSB7XG4gICAgICAgIGNvbnN0IHt2ZXJzaW9uLCBleGVjdXRhYmxlfSA9IGNkc1swXTtcbiAgICAgICAgbG9nLndhcm4oYENocm9tZSBidWlsZCBjaGVjayBkaXNhYmxlZC4gVXNpbmcgbW9zdCByZWNlbnQgQ2hyb21lZHJpdmVyIHZlcnNpb24gKCR7dmVyc2lvbn0sIGF0ICcke2V4ZWN1dGFibGV9JylgKTtcbiAgICAgICAgbG9nLndhcm4oYElmIHRoaXMgaXMgd3JvbmcsIHNldCAnY2hyb21lZHJpdmVyRGlzYWJsZUJ1aWxkQ2hlY2snIGNhcGFiaWxpdHkgdG8gJ2ZhbHNlJ2ApO1xuICAgICAgICByZXR1cm4gZXhlY3V0YWJsZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2hyb21lVmVyc2lvbiA9IGF3YWl0IHRoaXMuZ2V0Q2hyb21lVmVyc2lvbigpO1xuICAgICAgaWYgKCFjaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgIC8vIHVuYWJsZSB0byBnZXQgdGhlIGNocm9tZSB2ZXJzaW9uXG4gICAgICAgIGNvbnN0IHt2ZXJzaW9uLCBleGVjdXRhYmxlfSA9IGNkc1swXTtcbiAgICAgICAgbG9nLndhcm4oYFVuYWJsZSB0byBkaXNjb3ZlciBDaHJvbWUgdmVyc2lvbi4gVXNpbmcgQ2hyb21lZHJpdmVyICR7dmVyc2lvbn0gYXQgJyR7ZXhlY3V0YWJsZX0nYCk7XG4gICAgICAgIHJldHVybiBleGVjdXRhYmxlO1xuICAgICAgfVxuXG4gICAgICBsb2cuZGVidWcoYEZvdW5kIENocm9tZSBidW5kbGUgJyR7dGhpcy5idW5kbGVJZH0nIHZlcnNpb24gJyR7Y2hyb21lVmVyc2lvbn0nYCk7XG5cbiAgICAgIGNvbnN0IGF1dG9kb3dubG9hZE1zZyA9IHRoaXMuc3RvcmFnZUNsaWVudCAmJiBkaWRTdG9yYWdlU3luY1xuICAgICAgICA/ICcnXG4gICAgICAgIDogJy4gWW91IGNvdWxkIGFsc28gdHJ5IHRvIGVuYWJsZSBhdXRvbWF0ZWQgY2hyb21lZHJpdmVycyBkb3dubG9hZCBzZXJ2ZXIgZmVhdHVyZSc7XG4gICAgICBpZiAoc2VtdmVyLmd0KGNocm9tZVZlcnNpb24sIF8udmFsdWVzKG1hcHBpbmcpWzBdKSAmJiBjZHNbMF0gJiYgIWNkc1swXS5taW5DaHJvbWVWZXJzaW9uKSB7XG4gICAgICAgIGlmICh0aGlzLnN0b3JhZ2VDbGllbnQgJiYgIWRpZFN0b3JhZ2VTeW5jKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChhd2FpdCBzeW5jQ2hyb21lZHJpdmVycyhjaHJvbWVWZXJzaW9uKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2cud2FybihlLnN0YWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcyBpcyBhIGNocm9tZSBhYm92ZSB0aGUgbGF0ZXN0IHZlcnNpb24gd2Uga25vdyBhYm91dCxcbiAgICAgICAgLy8gYW5kIHdlIGhhdmUgYSBjaHJvbWVkcml2ZXIgdGhhdCBpcyBiZXlvbmQgd2hhdCB3ZSBrbm93LFxuICAgICAgICAvLyBzbyB1c2UgdGhlIG1vc3QgcmVjZW50IGNocm9tZWRyaXZlciB0aGF0IHdlIGZvdW5kXG4gICAgICAgIGNvbnN0IHt2ZXJzaW9uLCBleGVjdXRhYmxlfSA9IGNkc1swXTtcbiAgICAgICAgbG9nLndhcm4oYE5vIGtub3duIENocm9tZWRyaXZlciBhdmFpbGFibGUgdG8gYXV0b21hdGUgQ2hyb21lIHZlcnNpb24gJyR7Y2hyb21lVmVyc2lvbn0nLlxcbmAgK1xuICAgICAgICAgIGBVc2luZyBDaHJvbWVkcml2ZXIgdmVyc2lvbiAnJHt2ZXJzaW9ufScsIHdoaWNoIGhhcyBub3QgYmVlbiB0ZXN0ZWQgd2l0aCBBcHBpdW1gICtcbiAgICAgICAgICBhdXRvZG93bmxvYWRNc2cpO1xuICAgICAgICByZXR1cm4gZXhlY3V0YWJsZTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgd29ya2luZ0NkcyA9IGNkcy5maWx0ZXIoKGNkKSA9PiB7XG4gICAgICAgIGNvbnN0IHZlcnNpb25PYmogPSBzZW12ZXIuY29lcmNlKGNkLm1pbkNocm9tZVZlcnNpb24pO1xuICAgICAgICByZXR1cm4gdmVyc2lvbk9iaiAmJiBjaHJvbWVWZXJzaW9uLm1ham9yID09PSB2ZXJzaW9uT2JqLm1ham9yO1xuICAgICAgfSk7XG4gICAgICBpZiAoXy5pc0VtcHR5KHdvcmtpbmdDZHMpKSB7XG4gICAgICAgIGlmICh0aGlzLnN0b3JhZ2VDbGllbnQgJiYgIWRpZFN0b3JhZ2VTeW5jKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChhd2FpdCBzeW5jQ2hyb21lZHJpdmVycyhjaHJvbWVWZXJzaW9uKSkge1xuICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2cud2FybihlLnN0YWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYE5vIENocm9tZWRyaXZlciBmb3VuZCB0aGF0IGNhbiBhdXRvbWF0ZSBDaHJvbWUgJyR7Y2hyb21lVmVyc2lvbn0nLiBgICtcbiAgICAgICAgICBgU2VlICR7Q0hST01FRFJJVkVSX1RVVE9SSUFMfSBmb3IgbW9yZSBkZXRhaWxzYCArIGF1dG9kb3dubG9hZE1zZyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGJpblBhdGggPSB3b3JraW5nQ2RzWzBdLmV4ZWN1dGFibGU7XG4gICAgICBsb2cuZGVidWcoYEZvdW5kICR7d29ya2luZ0Nkcy5sZW5ndGh9IENocm9tZWRyaXZlciBleGVjdXRhYmxlJHt3b3JraW5nQ2RzLmxlbmd0aCA9PT0gMSA/ICcnIDogJ3MnfSBgICtcbiAgICAgICAgYGNhcGFibGUgb2YgYXV0b21hdGluZyBDaHJvbWUgJyR7Y2hyb21lVmVyc2lvbn0nLlxcbkNob29zaW5nIHRoZSBtb3N0IHJlY2VudCwgJyR7YmluUGF0aH0nLmApO1xuICAgICAgbG9nLmRlYnVnKCdJZiBhIHNwZWNpZmljIHZlcnNpb24gaXMgcmVxdWlyZWQsIHNwZWNpZnkgaXQgd2l0aCB0aGUgYGNocm9tZWRyaXZlckV4ZWN1dGFibGVgJyArXG4gICAgICAgICdkZXNpcmVkIGNhcGFiaWxpdHkuJyk7XG4gICAgICByZXR1cm4gYmluUGF0aDtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc3RhbnQtY29uZGl0aW9uXG4gICAgfSB3aGlsZSAodHJ1ZSk7XG4gIH1cblxuICBhc3luYyBpbml0Q2hyb21lZHJpdmVyUGF0aCAoKSB7XG4gICAgaWYgKHRoaXMuZXhlY3V0YWJsZVZlcmlmaWVkKSByZXR1cm47IC8vZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgLy8gdGhlIGV4ZWN1dGFibGUgbWlnaHQgYmUgc2V0IChpZiBwYXNzZWQgaW4pXG4gICAgLy8gb3Igd2UgbWlnaHQgd2FudCB0byB1c2UgdGhlIGJhc2ljIG9uZSBpbnN0YWxsZWQgd2l0aCB0aGlzIGRyaXZlclxuICAgIC8vIG9yIHdlIHdhbnQgdG8gZmlndXJlIG91dCB0aGUgYmVzdCBvbmVcbiAgICBpZiAoIXRoaXMuY2hyb21lZHJpdmVyKSB7XG4gICAgICB0aGlzLmNocm9tZWRyaXZlciA9IHRoaXMudXNlU3lzdGVtRXhlY3V0YWJsZVxuICAgICAgICA/IGF3YWl0IGdldENocm9tZWRyaXZlckJpbmFyeVBhdGgoKVxuICAgICAgICA6IGF3YWl0IHRoaXMuZ2V0Q29tcGF0aWJsZUNocm9tZWRyaXZlcigpO1xuICAgIH1cblxuICAgIGlmICghYXdhaXQgZnMuZXhpc3RzKHRoaXMuY2hyb21lZHJpdmVyKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUcnlpbmcgdG8gdXNlIGEgY2hyb21lZHJpdmVyIGJpbmFyeSBhdCB0aGUgcGF0aCBgICtcbiAgICAgICAgICAgICAgICAgICAgICBgJHt0aGlzLmNocm9tZWRyaXZlcn0sIGJ1dCBpdCBkb2Vzbid0IGV4aXN0IWApO1xuICAgIH1cbiAgICB0aGlzLmV4ZWN1dGFibGVWZXJpZmllZCA9IHRydWU7XG4gICAgbG9nLmluZm8oYFNldCBjaHJvbWVkcml2ZXIgYmluYXJ5IGFzOiAke3RoaXMuY2hyb21lZHJpdmVyfWApO1xuICB9XG5cbiAgc3luY1Byb3RvY29sIChjZFZlcnNpb24gPSBudWxsKSB7XG4gICAgY29uc3QgY29lcmNlZFZlcnNpb24gPSBzZW12ZXIuY29lcmNlKGNkVmVyc2lvbik7XG4gICAgaWYgKCFjb2VyY2VkVmVyc2lvbiB8fCBjb2VyY2VkVmVyc2lvbi5tYWpvciA8IE1JTl9DRF9WRVJTSU9OX1dJVEhfVzNDX1NVUFBPUlQpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgQ2hyb21lZHJpdmVyIHYuICR7Y2RWZXJzaW9ufSBkb2VzIG5vdCBmdWxseSBzdXBwb3J0ICR7UFJPVE9DT0xTLlczQ30gcHJvdG9jb2wuIGAgK1xuICAgICAgICBgRGVmYXVsdGluZyB0byAke1BST1RPQ09MUy5NSlNPTldQfWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjaHJvbWVPcHRpb25zID0gZ2V0Q2FwVmFsdWUodGhpcy5jYXBhYmlsaXRpZXMsICdjaHJvbWVPcHRpb25zJywge30pO1xuICAgIGlmIChjaHJvbWVPcHRpb25zLnczYyA9PT0gZmFsc2UpIHtcbiAgICAgIGxvZy5pbmZvKGBDaHJvbWVkcml2ZXIgdi4gJHtjZFZlcnNpb259IHN1cHBvcnRzICR7UFJPVE9DT0xTLlczQ30gcHJvdG9jb2wsIGAgK1xuICAgICAgICBgYnV0ICR7UFJPVE9DT0xTLk1KU09OV1B9IG9uZSBoYXMgYmVlbiBleHBsaWNpdGx5IHJlcXVlc3RlZGApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmRlc2lyZWRQcm90b2NvbCA9IFBST1RPQ09MUy5XM0M7XG4gICAgLy8gZ2l2ZW4gY2FwcyBtaWdodCBub3QgYmUgcHJvcGVybHkgcHJlZml4ZWRcbiAgICAvLyBzbyB3ZSB0cnkgdG8gZml4IHRoZW0gaW4gb3JkZXIgdG8gcHJvcGVybHkgaW5pdFxuICAgIC8vIHRoZSBuZXcgVzNDIHNlc3Npb25cbiAgICB0aGlzLmNhcGFiaWxpdGllcyA9IHRvVzNjQ2FwTmFtZXModGhpcy5jYXBhYmlsaXRpZXMpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnQgKGNhcHMsIGVtaXRTdGFydGluZ1N0YXRlID0gdHJ1ZSkge1xuICAgIHRoaXMuY2FwYWJpbGl0aWVzID0gXy5jbG9uZURlZXAoY2Fwcyk7XG5cbiAgICAvLyBzZXQgdGhlIGxvZ2dpbmcgcHJlZmVyZW5jZXMgdG8gQUxMIHRoZSBjb25zb2xlIGxvZ3NcbiAgICB0aGlzLmNhcGFiaWxpdGllcy5sb2dnaW5nUHJlZnMgPSBfLmNsb25lRGVlcChnZXRDYXBWYWx1ZShjYXBzLCAnbG9nZ2luZ1ByZWZzJywge30pKTtcbiAgICBpZiAoXy5pc0VtcHR5KHRoaXMuY2FwYWJpbGl0aWVzLmxvZ2dpbmdQcmVmcy5icm93c2VyKSkge1xuICAgICAgdGhpcy5jYXBhYmlsaXRpZXMubG9nZ2luZ1ByZWZzLmJyb3dzZXIgPSAnQUxMJztcbiAgICB9XG5cbiAgICBpZiAoZW1pdFN0YXJ0aW5nU3RhdGUpIHtcbiAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUQVJUSU5HKTtcbiAgICB9XG5cbiAgICBjb25zdCBhcmdzID0gWyctLXVybC1iYXNlPXdkL2h1YicsIGAtLXBvcnQ9JHt0aGlzLnByb3h5UG9ydH1gXTtcbiAgICBpZiAodGhpcy5hZGIgJiYgdGhpcy5hZGIuYWRiUG9ydCkge1xuICAgICAgYXJncy5wdXNoKGAtLWFkYi1wb3J0PSR7dGhpcy5hZGIuYWRiUG9ydH1gKTtcbiAgICB9XG4gICAgaWYgKF8uaXNBcnJheSh0aGlzLmNtZEFyZ3MpKSB7XG4gICAgICBhcmdzLnB1c2goLi4udGhpcy5jbWRBcmdzKTtcbiAgICB9XG4gICAgaWYgKHRoaXMubG9nUGF0aCkge1xuICAgICAgYXJncy5wdXNoKGAtLWxvZy1wYXRoPSR7dGhpcy5sb2dQYXRofWApO1xuICAgIH1cbiAgICBpZiAodGhpcy5kaXNhYmxlQnVpbGRDaGVjaykge1xuICAgICAgYXJncy5wdXNoKCctLWRpc2FibGUtYnVpbGQtY2hlY2snKTtcbiAgICB9XG4gICAgYXJncy5wdXNoKCctLXZlcmJvc2UnKTtcbiAgICAvLyB3aGF0IGFyZSB0aGUgcHJvY2VzcyBzdGRvdXQvc3RkZXJyIGNvbmRpdGlvbnMgd2hlcmVpbiB3ZSBrbm93IHRoYXRcbiAgICAvLyB0aGUgcHJvY2VzcyBoYXMgc3RhcnRlZCB0byBvdXIgc2F0aXNmYWN0aW9uP1xuICAgIGNvbnN0IHN0YXJ0RGV0ZWN0b3IgPSAoc3Rkb3V0KSA9PiB7XG4gICAgICByZXR1cm4gc3Rkb3V0LmluZGV4T2YoJ1N0YXJ0aW5nICcpID09PSAwO1xuICAgIH07XG5cbiAgICBsZXQgcHJvY2Vzc0lzQWxpdmUgPSBmYWxzZTtcbiAgICBsZXQgd2Vidmlld1ZlcnNpb247XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuaW5pdENocm9tZWRyaXZlclBhdGgoKTtcbiAgICAgIGF3YWl0IHRoaXMua2lsbEFsbCgpO1xuXG4gICAgICAvLyBzZXQgdXAgb3VyIHN1YnByb2Nlc3Mgb2JqZWN0XG4gICAgICB0aGlzLnByb2MgPSBuZXcgU3ViUHJvY2Vzcyh0aGlzLmNocm9tZWRyaXZlciwgYXJncyk7XG4gICAgICBwcm9jZXNzSXNBbGl2ZSA9IHRydWU7XG5cbiAgICAgIC8vIGhhbmRsZSBsb2cgb3V0cHV0XG4gICAgICB0aGlzLnByb2Mub24oJ291dHB1dCcsIChzdGRvdXQsIHN0ZGVycikgPT4ge1xuICAgICAgICAvLyBpZiB0aGUgY2Qgb3V0cHV0IGlzIG5vdCBwcmludGVkLCBmaW5kIHRoZSBjaHJvbWUgdmVyc2lvbiBhbmQgcHJpbnRcbiAgICAgICAgLy8gd2lsbCBnZXQgYSByZXNwb25zZSBsaWtlXG4gICAgICAgIC8vICAgRGV2VG9vbHMgcmVzcG9uc2U6IHtcbiAgICAgICAgLy8gICAgICBcIkFuZHJvaWQtUGFja2FnZVwiOiBcImlvLmFwcGl1bS5zYW1wbGVhcHBcIixcbiAgICAgICAgLy8gICAgICBcIkJyb3dzZXJcIjogXCJDaHJvbWUvNTUuMC4yODgzLjkxXCIsXG4gICAgICAgIC8vICAgICAgXCJQcm90b2NvbC1WZXJzaW9uXCI6IFwiMS4yXCIsXG4gICAgICAgIC8vICAgICAgXCJVc2VyLUFnZW50XCI6IFwiLi4uXCIsXG4gICAgICAgIC8vICAgICAgXCJXZWJLaXQtVmVyc2lvblwiOiBcIjUzNy4zNlwiXG4gICAgICAgIC8vICAgfVxuICAgICAgICBjb25zdCBvdXQgPSBzdGRvdXQgKyBzdGRlcnI7XG4gICAgICAgIGxldCBtYXRjaCA9IC9cIkJyb3dzZXJcIjogXCIoLiopXCIvLmV4ZWMob3V0KTtcbiAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgd2Vidmlld1ZlcnNpb24gPSBtYXRjaFsxXTtcbiAgICAgICAgICBsb2cuZGVidWcoYFdlYnZpZXcgdmVyc2lvbjogJyR7d2Vidmlld1ZlcnNpb259J2ApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWxzbyBwcmludCBjaHJvbWVkcml2ZXIgdmVyc2lvbiB0byBsb2dzXG4gICAgICAgIC8vIHdpbGwgb3V0cHV0IHNvbWV0aGluZyBsaWtlXG4gICAgICAgIC8vICBTdGFydGluZyBDaHJvbWVEcml2ZXIgMi4zMy41MDYxMDYgKDhhMDZjMzljNDU4MmZiZmJhYjY5NjZkYmIxYzM4YTkxNzNiZmIxYTIpIG9uIHBvcnQgOTUxNVxuICAgICAgICBtYXRjaCA9IC9TdGFydGluZyBDaHJvbWVEcml2ZXIgKFsuXFxkXSspLy5leGVjKG91dCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgQ2hyb21lZHJpdmVyIHZlcnNpb246ICcke21hdGNoWzFdfSdgKTtcbiAgICAgICAgICB0aGlzLnN5bmNQcm90b2NvbChtYXRjaFsxXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBnaXZlIHRoZSBvdXRwdXQgaWYgaXQgaXMgcmVxdWVzdGVkXG4gICAgICAgIGlmICh0aGlzLnZlcmJvc2UpIHtcbiAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIChzdGRvdXQgfHwgJycpLnRyaW0oKS5zcGxpdCgnXFxuJykpIHtcbiAgICAgICAgICAgIGlmICghbGluZS50cmltKCkubGVuZ3RoKSBjb250aW51ZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgICAgICAgICAgbG9nLmRlYnVnKGBbU1RET1VUXSAke2xpbmV9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvciAobGV0IGxpbmUgb2YgKHN0ZGVyciB8fCAnJykudHJpbSgpLnNwbGl0KCdcXG4nKSkge1xuICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKS5sZW5ndGgpIGNvbnRpbnVlOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgICAgICAgICBsb2cuZXJyb3IoYFtTVERFUlJdICR7bGluZX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBoYW5kbGUgb3V0LW9mLWJvdW5kIGV4aXQgYnkgc2ltcGx5IGVtaXR0aW5nIGEgc3RvcHBlZCBzdGF0ZVxuICAgICAgdGhpcy5wcm9jLm9uKCdleGl0JywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgICAgICBwcm9jZXNzSXNBbGl2ZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQgJiZcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgIT09IENocm9tZWRyaXZlci5TVEFURV9TVE9QUElORyAmJlxuICAgICAgICAgICAgdGhpcy5zdGF0ZSAhPT0gQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcpIHtcbiAgICAgICAgICBsZXQgbXNnID0gYENocm9tZWRyaXZlciBleGl0ZWQgdW5leHBlY3RlZGx5IHdpdGggY29kZSAke2NvZGV9LCBgICtcbiAgICAgICAgICAgICAgICAgICAgYHNpZ25hbCAke3NpZ25hbH1gO1xuICAgICAgICAgIGxvZy5lcnJvcihtc2cpO1xuICAgICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxvZy5pbmZvKGBTcGF3bmluZyBjaHJvbWVkcml2ZXIgd2l0aDogJHt0aGlzLmNocm9tZWRyaXZlcn0gYCArXG4gICAgICAgICAgICAgICBgJHthcmdzLmpvaW4oJyAnKX1gKTtcbiAgICAgIC8vIHN0YXJ0IHN1YnByb2MgYW5kIHdhaXQgZm9yIHN0YXJ0RGV0ZWN0b3JcbiAgICAgIGF3YWl0IHRoaXMucHJvYy5zdGFydChzdGFydERldGVjdG9yKTtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvck9ubGluZSgpO1xuICAgICAgYXdhaXQgdGhpcy5zdGFydFNlc3Npb24oKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLmVtaXQoQ2hyb21lZHJpdmVyLkVWRU5UX0VSUk9SLCBlKTtcbiAgICAgIC8vIGp1c3QgYmVjYXVzZSB3ZSBoYWQgYW4gZXJyb3IgZG9lc24ndCBtZWFuIHRoZSBjaHJvbWVkcml2ZXIgcHJvY2Vzc1xuICAgICAgLy8gZmluaXNoZWQ7IHdlIHNob3VsZCBjbGVhbiB1cCBpZiBuZWNlc3NhcnlcbiAgICAgIGlmIChwcm9jZXNzSXNBbGl2ZSkge1xuICAgICAgICBhd2FpdCB0aGlzLnByb2Muc3RvcCgpO1xuICAgICAgfVxuXG4gICAgICBsZXQgbWVzc2FnZSA9ICcnO1xuICAgICAgLy8gb2Z0ZW4gdGhlIHVzZXIncyBDaHJvbWUgdmVyc2lvbiBpcyB0b28gbG93IGZvciB0aGUgdmVyc2lvbiBvZiBDaHJvbWVkcml2ZXJcbiAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoJ0Nocm9tZSB2ZXJzaW9uIG11c3QgYmUnKSkge1xuICAgICAgICBtZXNzYWdlICs9ICdVbmFibGUgdG8gYXV0b21hdGUgQ2hyb21lIHZlcnNpb24gYmVjYXVzZSBpdCBpcyB0b28gb2xkIGZvciB0aGlzIHZlcnNpb24gb2YgQ2hyb21lZHJpdmVyLlxcbic7XG4gICAgICAgIGlmICh3ZWJ2aWV3VmVyc2lvbikge1xuICAgICAgICAgIG1lc3NhZ2UgKz0gYENocm9tZSB2ZXJzaW9uIG9uIHRoZSBkZXZpY2U6ICR7d2Vidmlld1ZlcnNpb259XFxuYDtcbiAgICAgICAgfVxuICAgICAgICBtZXNzYWdlICs9IGBWaXNpdCAnJHtDSFJPTUVEUklWRVJfVFVUT1JJQUx9JyB0byB0cm91Ymxlc2hvb3QgdGhlIHByb2JsZW0uXFxuYDtcbiAgICAgIH1cblxuICAgICAgbWVzc2FnZSArPSBlLm1lc3NhZ2U7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhtZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICBzZXNzaW9uSWQgKCkge1xuICAgIGlmICh0aGlzLnN0YXRlICE9PSBDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5qd3Byb3h5LnNlc3Npb25JZDtcbiAgfVxuXG4gIGFzeW5jIHJlc3RhcnQgKCkge1xuICAgIGxvZy5pbmZvKCdSZXN0YXJ0aW5nIGNocm9tZWRyaXZlcicpO1xuICAgIGlmICh0aGlzLnN0YXRlICE9PSBDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCByZXN0YXJ0IHdoZW4gd2UncmUgbm90IG9ubGluZVwiKTtcbiAgICB9XG4gICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfUkVTVEFSVElORyk7XG4gICAgYXdhaXQgdGhpcy5zdG9wKGZhbHNlKTtcbiAgICBhd2FpdCB0aGlzLnN0YXJ0KHRoaXMuY2FwYWJpbGl0aWVzLCBmYWxzZSk7XG4gIH1cblxuICBhc3luYyB3YWl0Rm9yT25saW5lICgpIHtcbiAgICAvLyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IENEIGhhc24ndCBjcmFzaGVkXG4gICAgbGV0IGNocm9tZWRyaXZlclN0b3BwZWQgPSBmYWxzZTtcbiAgICBhd2FpdCByZXRyeUludGVydmFsKDIwLCAyMDAsIGFzeW5jICgpID0+IHtcbiAgICAgIGlmICh0aGlzLnN0YXRlID09PSBDaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCkge1xuICAgICAgICAvLyB3ZSBhcmUgZWl0aGVyIHN0b3BwZWQgb3Igc3RvcHBpbmcsIHNvIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gICAgICAgIGNocm9tZWRyaXZlclN0b3BwZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBhd2FpdCB0aGlzLmdldFN0YXR1cygpO1xuICAgIH0pO1xuICAgIGlmIChjaHJvbWVkcml2ZXJTdG9wcGVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nocm9tZURyaXZlciBjcmFzaGVkIGR1cmluZyBzdGFydHVwLicpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFN0YXR1cyAoKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvc3RhdHVzJywgJ0dFVCcpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRTZXNzaW9uICgpIHtcbiAgICBjb25zdCBzZXNzaW9uQ2FwcyA9IHRoaXMuZGVzaXJlZFByb3RvY29sID09PSBQUk9UT0NPTFMuVzNDXG4gICAgICA/IHtjYXBhYmlsaXRpZXM6IHthbHdheXNNYXRjaDogdGhpcy5jYXBhYmlsaXRpZXN9fVxuICAgICAgOiB7ZGVzaXJlZENhcGFiaWxpdGllczogdGhpcy5jYXBhYmlsaXRpZXN9O1xuICAgIGxvZy5pbmZvKGBTdGFydGluZyAke3RoaXMuZGVzaXJlZFByb3RvY29sfSBDaHJvbWVkcml2ZXIgc2Vzc2lvbiB3aXRoIGNhcGFiaWxpdGllczogYCArXG4gICAgICBKU09OLnN0cmluZ2lmeShzZXNzaW9uQ2FwcywgbnVsbCwgMikpO1xuICAgIC8vIHJldHJ5IHNlc3Npb24gc3RhcnQgNCB0aW1lcywgc29tZXRpbWVzIHRoaXMgZmFpbHMgZHVlIHRvIGFkYlxuICAgIGF3YWl0IHJldHJ5SW50ZXJ2YWwoNCwgMjAwLCBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmp3cHJveHkuY29tbWFuZCgnL3Nlc3Npb24nLCAnUE9TVCcsIHNlc3Npb25DYXBzKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cud2FybihgRmFpbGVkIHRvIHN0YXJ0IENocm9tZWRyaXZlciBzZXNzaW9uOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5jaGFuZ2VTdGF0ZShDaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FKTtcbiAgfVxuXG4gIGFzeW5jIHN0b3AgKGVtaXRTdGF0ZXMgPSB0cnVlKSB7XG4gICAgaWYgKGVtaXRTdGF0ZXMpIHtcbiAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQSU5HKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcnLCAnREVMRVRFJyk7XG4gICAgICBhd2FpdCB0aGlzLnByb2Muc3RvcCgnU0lHVEVSTScsIDIwMDAwKTtcbiAgICAgIGlmIChlbWl0U3RhdGVzKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlU3RhdGUoQ2hyb21lZHJpdmVyLlNUQVRFX1NUT1BQRUQpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5lcnJvcihlKTtcbiAgICB9XG4gIH1cblxuICBjaGFuZ2VTdGF0ZSAoc3RhdGUpIHtcbiAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG4gICAgbG9nLmRlYnVnKGBDaGFuZ2VkIHN0YXRlIHRvICcke3N0YXRlfSdgKTtcbiAgICB0aGlzLmVtaXQoQ2hyb21lZHJpdmVyLkVWRU5UX0NIQU5HRUQsIHtzdGF0ZX0pO1xuICB9XG5cbiAgYXN5bmMgc2VuZENvbW1hbmQgKHVybCwgbWV0aG9kLCBib2R5KSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKHVybCwgbWV0aG9kLCBib2R5KTtcbiAgfVxuXG4gIGFzeW5jIHByb3h5UmVxIChyZXEsIHJlcykge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmp3cHJveHkucHJveHlSZXFSZXMocmVxLCByZXMpO1xuICB9XG5cbiAgYXN5bmMga2lsbEFsbCAoKSB7XG4gICAgbGV0IGNtZCA9IHN5c3RlbS5pc1dpbmRvd3MoKVxuICAgICAgPyBgd21pYyBwcm9jZXNzIHdoZXJlIFwiY29tbWFuZGxpbmUgbGlrZSAnJWNocm9tZWRyaXZlci5leGUlLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9JSdcIiBkZWxldGVgXG4gICAgICA6IGBwa2lsbCAtMTUgLWYgXCIke3RoaXMuY2hyb21lZHJpdmVyfS4qLS1wb3J0PSR7dGhpcy5wcm94eVBvcnR9XCJgO1xuICAgIGxvZy5kZWJ1ZyhgS2lsbGluZyBhbnkgb2xkIGNocm9tZWRyaXZlcnMsIHJ1bm5pbmc6ICR7Y21kfWApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCAoQi5wcm9taXNpZnkoY3AuZXhlYykpKGNtZCk7XG4gICAgICBsb2cuZGVidWcoJ1N1Y2Nlc3NmdWxseSBjbGVhbmVkIHVwIG9sZCBjaHJvbWVkcml2ZXJzJyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cud2FybignTm8gb2xkIGNocm9tZWRyaXZlcnMgc2VlbSB0byBleGlzdCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmFkYikge1xuICAgICAgbG9nLmRlYnVnKGBDbGVhbmluZyBhbnkgb2xkIGFkYiBmb3J3YXJkZWQgcG9ydCBzb2NrZXQgY29ubmVjdGlvbnNgKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAobGV0IGNvbm4gb2YgYXdhaXQgdGhpcy5hZGIuZ2V0Rm9yd2FyZExpc3QoKSkge1xuICAgICAgICAgIC8vIGNocm9tZWRyaXZlciB3aWxsIGFzayBBREIgdG8gZm9yd2FyZCBhIHBvcnQgbGlrZSBcImRldmljZUlkIHRjcDpwb3J0IGxvY2FsYWJzdHJhY3Q6d2Vidmlld19kZXZ0b29sc19yZW1vdGVfcG9ydFwiXG4gICAgICAgICAgaWYgKGNvbm4uaW5kZXhPZignd2Vidmlld19kZXZ0b29scycpICE9PSAtMSkge1xuICAgICAgICAgICAgbGV0IHBhcmFtcyA9IGNvbm4uc3BsaXQoL1xccysvKTtcbiAgICAgICAgICAgIGlmIChwYXJhbXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFkYi5yZW1vdmVQb3J0Rm9yd2FyZChwYXJhbXNbMV0ucmVwbGFjZSgvW1xcRF0qLywgJycpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBsb2cud2FybihgVW5hYmxlIHRvIGNsZWFuIGZvcndhcmRlZCBwb3J0cy4gRXJyb3I6ICcke2Vyci5tZXNzYWdlfScuIENvbnRpbnVpbmcuYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgaGFzV29ya2luZ1dlYnZpZXcgKCkge1xuICAgIC8vIHNvbWV0aW1lcyBjaHJvbWVkcml2ZXIgc3RvcHMgYXV0b21hdGluZyB3ZWJ2aWV3cy4gdGhpcyBtZXRob2QgcnVucyBhXG4gICAgLy8gc2ltcGxlIGNvbW1hbmQgdG8gZGV0ZXJtaW5lIG91ciBzdGF0ZSwgYW5kIHJlc3BvbmRzIGFjY29yZGluZ2x5XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMuandwcm94eS5jb21tYW5kKCcvdXJsJywgJ0dFVCcpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG5DaHJvbWVkcml2ZXIuRVZFTlRfRVJST1IgPSAnY2hyb21lZHJpdmVyX2Vycm9yJztcbkNocm9tZWRyaXZlci5FVkVOVF9DSEFOR0VEID0gJ3N0YXRlQ2hhbmdlZCc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBFRCA9ICdzdG9wcGVkJztcbkNocm9tZWRyaXZlci5TVEFURV9TVEFSVElORyA9ICdzdGFydGluZyc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfT05MSU5FID0gJ29ubGluZSc7XG5DaHJvbWVkcml2ZXIuU1RBVEVfU1RPUFBJTkcgPSAnc3RvcHBpbmcnO1xuQ2hyb21lZHJpdmVyLlNUQVRFX1JFU1RBUlRJTkcgPSAncmVzdGFydGluZyc7XG5cbmV4cG9ydCB7XG4gIENocm9tZWRyaXZlciwgQ0hST01FRFJJVkVSX0NIUk9NRV9NQVBQSU5HLCBnZXRNb3N0UmVjZW50Q2hyb21lZHJpdmVyLCBDRF9WRVIsXG59O1xuZXhwb3J0IGRlZmF1bHQgQ2hyb21lZHJpdmVyO1xuIl0sImZpbGUiOiJsaWIvY2hyb21lZHJpdmVyLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
