"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.installApp = installApp;
exports.removeApp = removeApp;
exports.launch = launch;
exports.spawn = spawn;
exports.spawnSubProcess = spawnSubProcess;
exports.openUrl = openUrl;
exports.terminate = terminate;
exports.shutdown = shutdown;
exports.createDevice = createDevice;
exports.getAppContainer = getAppContainer;
exports.getScreenshot = getScreenshot;
exports.deleteDevice = deleteDevice;
exports.eraseDevice = eraseDevice;
exports.getDevices = getDevices;
exports.getRuntimeForPlatformVersion = getRuntimeForPlatformVersion;
exports.bootDevice = bootDevice;
exports.setPasteboard = setPasteboard;
exports.getPasteboard = getPasteboard;
exports.addMedia = addMedia;
exports.appInfo = appInfo;
exports.getDeviceTypes = getDeviceTypes;
exports.startBootMonitor = startBootMonitor;
exports.getSimctlList = getSimctlList;

require("source-map-support/register");

var _teen_process = require("teen_process");

var _asyncbox = require("asyncbox");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _appiumXcode = require("appium-xcode");

const log = _appiumSupport.logger.getLogger('simctl');

const CMDLINE_TOOLS_CLANG_FORMAT_CHANGED_VERSION = '1001.0.46';
const XCODE_FORMAT_CHANGED_VERSION = '10.2';
const SIM_RUNTIME_NAME = 'com.apple.CoreSimulator.SimRuntime.';
const SIM_RUNTIME_NAME_SUFFIX_IOS = 'iOS';
const DEFAULT_CREATE_SIMULATOR_TIMEOUT = 10000;

async function simCommand(command, timeout, args = [], env = {}, executingFunction = _teen_process.exec, logErrors = true) {
  args = ['simctl', command, ...args];
  env = _lodash.default.defaults(_lodash.default.mapKeys(env, (value, key) => {
    return `SIMCTL_CHILD_${key}`;
  }), process.env);

  try {
    return await executingFunction('xcrun', args, {
      timeout,
      env
    });
  } catch (e) {
    if (!logErrors) {
      throw e;
    } else if (e.stderr) {
      log.errorAndThrow(`simctl error running '${command}': ${e.stderr.trim()}`);
    } else {
      log.errorAndThrow(e);
    }
  }
}

async function simExec(command, timeout, args = [], env = {}, logErrors = true) {
  return await simCommand(command, timeout, args, env, async (c, a, ob) => {
    return await (0, _teen_process.exec)(c, a, ob);
  }, logErrors);
}

async function simSubProcess(command, timeout, args = [], env = {}) {
  return await simCommand(command, timeout, args, env, (c, a, ob) => {
    return new _teen_process.SubProcess(c, a, ob);
  });
}

async function installApp(udid, appPath) {
  await simExec('install', 0, [udid, appPath]);
}

async function bootDevice(udid) {
  try {
    await simExec('boot', 0, [udid]);
  } catch (err) {
    if ((err.message || '').indexOf('Unable to boot device in current state: Booted') === -1) {
      throw err;
    }

    log.debug(`Simulator already in 'Booted' state. Continuing`);
  }
}

async function removeApp(udid, bundleId) {
  await simExec('uninstall', 0, [udid, bundleId]);
}

async function launch(udid, bundleId, tries = 5) {
  await (0, _asyncbox.retryInterval)(tries, 1000, async () => {
    await simExec('launch', 0, [udid, bundleId]);
  });
}

async function spawn(udid, args, env = {}) {
  return await simExec('spawn', 0, [udid, ...(_lodash.default.isArray(args) ? args : [args])], env);
}

async function spawnSubProcess(udid, args, env = {}) {
  return await simSubProcess('spawn', 0, [udid, ...(_lodash.default.isArray(args) ? args : [args])], env);
}

async function openUrl(udid, url) {
  return await simExec('openurl', 0, [udid, url]);
}

async function appInfo(udid, bundleId) {
  const {
    stdout
  } = await simExec('appinfo', 0, [udid, bundleId]);
  return (stdout || '').trim();
}

async function addMedia(udid, path) {
  return await simExec('addmedia', 0, [udid, path]);
}

async function terminate(udid, bundleId) {
  await simExec('terminate', 0, [udid, bundleId]);
}

async function getAppContainer(udid, bundleId, logErrors = true, containerType = null) {
  const args = [udid, bundleId];

  if (containerType) {
    args.push(containerType);
  }

  const {
    stdout
  } = await simExec('get_app_container', 0, args, {}, logErrors);
  return (stdout || '').trim();
}

async function shutdown(udid) {
  try {
    await simExec('shutdown', 0, [udid]);
  } catch (err) {
    if (!(err + '').includes('current state: Shutdown')) {
      throw err;
    }

    log.debug(`Simulator already in 'Shutdown' state. Continuing`);
  }
}

async function createDevice(name, deviceTypeId, runtimeId, opts = {}) {
  const {
    platform = SIM_RUNTIME_NAME_SUFFIX_IOS,
    timeout = DEFAULT_CREATE_SIMULATOR_TIMEOUT
  } = opts;
  let runtimeIdFromJson;

  try {
    runtimeIdFromJson = await getRuntimeForPlatformVersionViaJson(runtimeId, platform);
    runtimeId = runtimeIdFromJson;
  } catch (ign) {}

  if (!runtimeIdFromJson) {
    try {
      runtimeId = await getRuntimeForPlatformVersion(runtimeId, platform);
    } catch (err) {
      log.warn(`Unable to find runtime for iOS '${runtimeId}'. Continuing`);
    }

    const clangVersion = await (0, _appiumXcode.getClangVersion)();

    let isNewerIdFormatRequired = clangVersion && _appiumSupport.util.compareVersions(clangVersion, '>=', CMDLINE_TOOLS_CLANG_FORMAT_CHANGED_VERSION);

    if (!isNewerIdFormatRequired) {
      const xcodeVersion = await (0, _appiumXcode.getVersion)(false);
      isNewerIdFormatRequired = xcodeVersion && _appiumSupport.util.compareVersions(xcodeVersion, '>=', XCODE_FORMAT_CHANGED_VERSION);
    }

    if (isNewerIdFormatRequired) {
      runtimeId = `${SIM_RUNTIME_NAME}${platform}-${runtimeId.replace(/\./g, '-')}`;
    }
  }

  log.debug(`Creating simulator with name '${name}', device type id '${deviceTypeId}' and runtime id '${runtimeId}'`);
  let udid;

  try {
    const out = await simExec('create', 0, [name, deviceTypeId, runtimeId]);
    udid = out.stdout.trim();
  } catch (err) {
    let reason = err.message;

    if (err.stderr) {
      reason = err.stderr.trim();
    }

    log.errorAndThrow(`Could not create simulator with name '${name}', device ` + `type id '${deviceTypeId}' and runtime id '${runtimeId}'. Reason: '${reason}'`);
  }

  let retries = parseInt(timeout / 1000, 10);
  await (0, _asyncbox.retryInterval)(retries, 1000, async () => {
    let devices = await getDevices();

    for (const deviceArr of _lodash.default.values(devices)) {
      for (const device of deviceArr) {
        if (device.udid === udid) {
          if (device.state === 'Creating') {
            throw new Error('Device still being created');
          } else {
            return;
          }
        }
      }
    }
  });
  return udid;
}

async function deleteDevice(udid) {
  await simExec('delete', 0, [udid]);
}

async function eraseDevice(udid, timeout = 1000) {
  let loopFn = async () => {
    await simExec('erase', 10000, [udid]);
  };

  let retries = parseInt(timeout / 200, 10);
  await (0, _asyncbox.retryInterval)(retries, 200, loopFn);
}

async function getDevicesByParsing(platform) {
  const {
    stdout
  } = await simExec('list', 0, ['devices']);
  const deviceSectionRe = _lodash.default.isEmpty(platform) ? new RegExp(`\\-\\-\\s+(\\S+)\\s+(\\S+)\\s+\\-\\-(\\n\\s{4}.+)*`, 'mgi') : new RegExp(`\\-\\-\\s+${_lodash.default.escapeRegExp(platform)}\\s+(\\S+)\\s+\\-\\-(\\n\\s{4}.+)*`, 'mgi');
  const matches = [];
  let match;

  while (match = deviceSectionRe.exec(stdout)) {
    matches.push(match);
  }

  if (_lodash.default.isEmpty(matches)) {
    throw new Error('Could not find device section');
  }

  const lineRe = /([^\s].+) \((\w+-.+\w+)\) \((\w+\s?\w+)\)/;
  const devices = {};

  for (match of matches) {
    const sdk = platform ? match[1] : match[2];
    devices[sdk] = devices[sdk] || [];

    for (const line of match[0].split('\n').slice(1)) {
      if (line.includes('(unavailable, ')) {
        continue;
      }

      const lineMatch = lineRe.exec(line);

      if (!lineMatch) {
        throw new Error(`Could not match line: ${line}`);
      }

      devices[sdk].push({
        name: lineMatch[1],
        udid: lineMatch[2],
        state: lineMatch[3],
        sdk,
        platform: platform || match[1]
      });
    }
  }

  return devices;
}

async function getDevices(forSdk, platform) {
  let devices = {};

  try {
    const {
      stdout
    } = await simExec('list', 0, ['devices', '-j']);
    const versionMatchRe = _lodash.default.isEmpty(platform) ? new RegExp(`^([^\\s-]+)[\\s-](\\S+)`, 'i') : new RegExp(`^${_lodash.default.escapeRegExp(platform)}[\\s-](\\S+)`, 'i');

    for (let [sdkName, entries] of _lodash.default.toPairs(JSON.parse(stdout).devices)) {
      sdkName = sdkName.replace(SIM_RUNTIME_NAME, '');
      const versionMatch = versionMatchRe.exec(sdkName);

      if (!versionMatch) {
        continue;
      }

      const sdk = (platform ? versionMatch[1] : versionMatch[2]).replace('-', '.');
      devices[sdk] = devices[sdk] || [];
      devices[sdk].push(...entries.filter(el => _lodash.default.isUndefined(el.isAvailable) || el.isAvailable).map(el => {
        delete el.availability;
        return {
          sdk,
          ...el,
          platform: platform || versionMatch[1]
        };
      }));
    }
  } catch (err) {
    log.debug(`Unable to get JSON device list: ${err.stack}`);
    log.debug('Falling back to manual parsing');
    devices = await getDevicesByParsing(platform);
  }

  if (!forSdk) {
    return devices;
  }

  if (devices[forSdk]) {
    return devices[forSdk];
  }

  let errMsg = `'${forSdk}' does not exist in the list of simctl SDKs.`;

  const availableSDKs = _lodash.default.keys(devices);

  errMsg += availableSDKs.length ? ` Only the following Simulator SDK versions are available on your system: ${availableSDKs.join(', ')}` : ` No Simulator SDK versions are available on your system. Please install some via Xcode preferences.`;
  throw new Error(errMsg);
}

async function getRuntimeForPlatformVersionViaJson(platformVersion, platform = 'iOS') {
  const {
    stdout
  } = await simExec('list', 0, ['runtimes', '--json']);

  for (const {
    version,
    identifier,
    name
  } of JSON.parse(stdout).runtimes) {
    if (version === platformVersion && name.toLowerCase().startsWith(platform.toLowerCase())) {
      return identifier;
    }
  }

  throw new Error(`Could not use --json flag to parse platform version`);
}

async function getRuntimeForPlatformVersion(platformVersion, platform = 'iOS') {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['runtimes']);
    const runtimeRe = new RegExp(`${_lodash.default.escapeRegExp(platform)}\\s+(\\d+\\.\\d+)\\s+\\((\\d+\\.\\d+\\.*\\d*)`, 'i');

    for (const line of stdout.split('\n')) {
      const match = runtimeRe.exec(line);

      if (match && match[1] === platformVersion) {
        return match[2];
      }
    }
  } catch (ign) {}

  return platformVersion;
}

async function getScreenshot(udid) {
  let pathToScreenshotPng = await _appiumSupport.tempDir.path({
    prefix: `screenshot-${udid}`,
    suffix: '.png'
  });
  await simExec('io', 0, [udid, 'screenshot', pathToScreenshotPng]);
  let screenshotImg = await _appiumSupport.fs.readFile(pathToScreenshotPng);
  await _appiumSupport.fs.rimraf(pathToScreenshotPng);
  return screenshotImg.toString('base64');
}

async function setPasteboard(udid, content, encoding = 'utf-8') {
  const pbCopySubprocess = new _teen_process.SubProcess('xcrun', ['simctl', 'pbcopy', udid]);
  await pbCopySubprocess.start(0);
  const exitCodeVerifier = pbCopySubprocess.join();
  const stdin = pbCopySubprocess.proc.stdin;
  stdin.setEncoding(encoding);
  stdin.write(content);
  stdin.end();
  await exitCodeVerifier;
}

async function getPasteboard(udid, encoding = 'utf-8') {
  const args = ['simctl', 'pbpaste', udid];

  try {
    const {
      stdout
    } = await (0, _teen_process.exec)('xcrun', args, {
      timeout: 0,
      encoding
    });
    return stdout;
  } catch (e) {
    if (e.stderr) {
      log.errorAndThrow(`Error running 'xcrun ${args.join(' ')}': ${e.stderr.trim()}`);
    } else {
      log.errorAndThrow(e);
    }
  }
}

async function getDeviceTypes() {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['devicetypes', '-j']);
    const deviceTypes = JSON.parse(stdout.trim());
    return deviceTypes.devicetypes.map(type => type.name);
  } catch (err) {
    let msg = `Unable to get list of device types: ${err.message}`;

    if (err.stderr) {
      msg = `${msg}. Stderr: ${err.stderr}`;
    }

    throw new Error(msg);
  }
}

async function getSimctlList() {
  try {
    const {
      stdout
    } = await simExec('list', 0, ['-j']);
    return JSON.parse(stdout);
  } catch (err) {
    let msg = `Unable to get simctl list: ${err.message}`;

    if (err.stderr) {
      msg = `${msg}. Stderr: ${err.stderr}`;
    }

    throw new Error(msg);
  }
}

async function startBootMonitor(udid, opts = {}) {
  const {
    timeout = 240000,
    onWaitingDataMigration,
    onWaitingSystemApp,
    onFinished,
    onError
  } = opts;
  let status = '';
  let isBootingFinished = false;
  let error = null;
  let timeoutHandler = null;
  const bootMonitor = await simSubProcess('bootstatus', 0, [udid]);
  bootMonitor.on('output', (stdout, stderr) => {
    status += stdout || stderr;

    if (stdout) {
      if (stdout.includes('Waiting on Data Migration') && onWaitingDataMigration) {
        onWaitingDataMigration();
      } else if (stdout.includes('Waiting on System App') && onWaitingSystemApp) {
        onWaitingSystemApp();
      }
    }
  });
  bootMonitor.on('exit', (code, signal) => {
    if (timeoutHandler) {
      clearTimeout(timeoutHandler);
    }

    if (code === 0) {
      if (onFinished) {
        onFinished();
      }

      isBootingFinished = true;
    } else {
      status = status || signal;
      error = new Error(status);

      if (onError) {
        onError(error);
      }
    }
  });
  await bootMonitor.start(0);

  const stopMonitor = async () => {
    if (bootMonitor.isRunning) {
      try {
        await bootMonitor.stop();
      } catch (e) {
        log.warn(e.message);
      }
    }
  };

  const timeStarted = process.hrtime();

  if (onFinished) {
    timeoutHandler = setTimeout(stopMonitor, timeout);
  } else {
    try {
      await (0, _asyncbox.waitForCondition)(() => {
        if (error) {
          throw error;
        }

        return isBootingFinished;
      }, {
        waitMs: timeout,
        intervalMs: 500
      });
    } catch (err) {
      await stopMonitor();
      throw new Error(`The simulator ${udid} has failed to finish booting after ${process.hrtime(timeStarted)[0]}s. ` + `Original status: ${status}`);
    }
  }

  return bootMonitor;
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW1jdGwuanMiXSwibmFtZXMiOlsibG9nIiwibG9nZ2VyIiwiZ2V0TG9nZ2VyIiwiQ01ETElORV9UT09MU19DTEFOR19GT1JNQVRfQ0hBTkdFRF9WRVJTSU9OIiwiWENPREVfRk9STUFUX0NIQU5HRURfVkVSU0lPTiIsIlNJTV9SVU5USU1FX05BTUUiLCJTSU1fUlVOVElNRV9OQU1FX1NVRkZJWF9JT1MiLCJERUZBVUxUX0NSRUFURV9TSU1VTEFUT1JfVElNRU9VVCIsInNpbUNvbW1hbmQiLCJjb21tYW5kIiwidGltZW91dCIsImFyZ3MiLCJlbnYiLCJleGVjdXRpbmdGdW5jdGlvbiIsImV4ZWMiLCJsb2dFcnJvcnMiLCJfIiwiZGVmYXVsdHMiLCJtYXBLZXlzIiwidmFsdWUiLCJrZXkiLCJwcm9jZXNzIiwiZSIsInN0ZGVyciIsImVycm9yQW5kVGhyb3ciLCJ0cmltIiwic2ltRXhlYyIsImMiLCJhIiwib2IiLCJzaW1TdWJQcm9jZXNzIiwiU3ViUHJvY2VzcyIsImluc3RhbGxBcHAiLCJ1ZGlkIiwiYXBwUGF0aCIsImJvb3REZXZpY2UiLCJlcnIiLCJtZXNzYWdlIiwiaW5kZXhPZiIsImRlYnVnIiwicmVtb3ZlQXBwIiwiYnVuZGxlSWQiLCJsYXVuY2giLCJ0cmllcyIsInNwYXduIiwiaXNBcnJheSIsInNwYXduU3ViUHJvY2VzcyIsIm9wZW5VcmwiLCJ1cmwiLCJhcHBJbmZvIiwic3Rkb3V0IiwiYWRkTWVkaWEiLCJwYXRoIiwidGVybWluYXRlIiwiZ2V0QXBwQ29udGFpbmVyIiwiY29udGFpbmVyVHlwZSIsInB1c2giLCJzaHV0ZG93biIsImluY2x1ZGVzIiwiY3JlYXRlRGV2aWNlIiwibmFtZSIsImRldmljZVR5cGVJZCIsInJ1bnRpbWVJZCIsIm9wdHMiLCJwbGF0Zm9ybSIsInJ1bnRpbWVJZEZyb21Kc29uIiwiZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvblZpYUpzb24iLCJpZ24iLCJnZXRSdW50aW1lRm9yUGxhdGZvcm1WZXJzaW9uIiwid2FybiIsImNsYW5nVmVyc2lvbiIsImlzTmV3ZXJJZEZvcm1hdFJlcXVpcmVkIiwidXRpbCIsImNvbXBhcmVWZXJzaW9ucyIsInhjb2RlVmVyc2lvbiIsInJlcGxhY2UiLCJvdXQiLCJyZWFzb24iLCJyZXRyaWVzIiwicGFyc2VJbnQiLCJkZXZpY2VzIiwiZ2V0RGV2aWNlcyIsImRldmljZUFyciIsInZhbHVlcyIsImRldmljZSIsInN0YXRlIiwiRXJyb3IiLCJkZWxldGVEZXZpY2UiLCJlcmFzZURldmljZSIsImxvb3BGbiIsImdldERldmljZXNCeVBhcnNpbmciLCJkZXZpY2VTZWN0aW9uUmUiLCJpc0VtcHR5IiwiUmVnRXhwIiwiZXNjYXBlUmVnRXhwIiwibWF0Y2hlcyIsIm1hdGNoIiwibGluZVJlIiwic2RrIiwibGluZSIsInNwbGl0Iiwic2xpY2UiLCJsaW5lTWF0Y2giLCJmb3JTZGsiLCJ2ZXJzaW9uTWF0Y2hSZSIsInNka05hbWUiLCJlbnRyaWVzIiwidG9QYWlycyIsIkpTT04iLCJwYXJzZSIsInZlcnNpb25NYXRjaCIsImZpbHRlciIsImVsIiwiaXNVbmRlZmluZWQiLCJpc0F2YWlsYWJsZSIsIm1hcCIsImF2YWlsYWJpbGl0eSIsInN0YWNrIiwiZXJyTXNnIiwiYXZhaWxhYmxlU0RLcyIsImtleXMiLCJsZW5ndGgiLCJqb2luIiwicGxhdGZvcm1WZXJzaW9uIiwidmVyc2lvbiIsImlkZW50aWZpZXIiLCJydW50aW1lcyIsInRvTG93ZXJDYXNlIiwic3RhcnRzV2l0aCIsInJ1bnRpbWVSZSIsImdldFNjcmVlbnNob3QiLCJwYXRoVG9TY3JlZW5zaG90UG5nIiwidGVtcERpciIsInByZWZpeCIsInN1ZmZpeCIsInNjcmVlbnNob3RJbWciLCJmcyIsInJlYWRGaWxlIiwicmltcmFmIiwidG9TdHJpbmciLCJzZXRQYXN0ZWJvYXJkIiwiY29udGVudCIsImVuY29kaW5nIiwicGJDb3B5U3VicHJvY2VzcyIsInN0YXJ0IiwiZXhpdENvZGVWZXJpZmllciIsInN0ZGluIiwicHJvYyIsInNldEVuY29kaW5nIiwid3JpdGUiLCJlbmQiLCJnZXRQYXN0ZWJvYXJkIiwiZ2V0RGV2aWNlVHlwZXMiLCJkZXZpY2VUeXBlcyIsImRldmljZXR5cGVzIiwidHlwZSIsIm1zZyIsImdldFNpbWN0bExpc3QiLCJzdGFydEJvb3RNb25pdG9yIiwib25XYWl0aW5nRGF0YU1pZ3JhdGlvbiIsIm9uV2FpdGluZ1N5c3RlbUFwcCIsIm9uRmluaXNoZWQiLCJvbkVycm9yIiwic3RhdHVzIiwiaXNCb290aW5nRmluaXNoZWQiLCJlcnJvciIsInRpbWVvdXRIYW5kbGVyIiwiYm9vdE1vbml0b3IiLCJvbiIsImNvZGUiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJzdG9wTW9uaXRvciIsImlzUnVubmluZyIsInN0b3AiLCJ0aW1lU3RhcnRlZCIsImhydGltZSIsInNldFRpbWVvdXQiLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQSxNQUFNQSxHQUFHLEdBQUdDLHNCQUFPQyxTQUFQLENBQWlCLFFBQWpCLENBQVo7O0FBR0EsTUFBTUMsMENBQTBDLEdBQUcsV0FBbkQ7QUFDQSxNQUFNQyw0QkFBNEIsR0FBRyxNQUFyQztBQUVBLE1BQU1DLGdCQUFnQixHQUFHLHFDQUF6QjtBQUNBLE1BQU1DLDJCQUEyQixHQUFHLEtBQXBDO0FBQ0EsTUFBTUMsZ0NBQWdDLEdBQUcsS0FBekM7O0FBdUJBLGVBQWVDLFVBQWYsQ0FBMkJDLE9BQTNCLEVBQW9DQyxPQUFwQyxFQUE2Q0MsSUFBSSxHQUFHLEVBQXBELEVBQXdEQyxHQUFHLEdBQUcsRUFBOUQsRUFBa0VDLGlCQUFpQixHQUFHQyxrQkFBdEYsRUFBNEZDLFNBQVMsR0FBRyxJQUF4RyxFQUE4RztBQUU1R0osRUFBQUEsSUFBSSxHQUFHLENBQUMsUUFBRCxFQUFXRixPQUFYLEVBQW9CLEdBQUdFLElBQXZCLENBQVA7QUFHQUMsRUFBQUEsR0FB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Q0FBTjtBQU1ELEtBUEQsQ0FPRSxPQUFPL0ksR0FBUCxFQUFZO0FBQ1osWUFBTXdJLFdBQVcsRUFBakI7QUFDQSxZQUFNLElBQUl0RixLQUFKLENBQVcsaUJBQWdCckQsSUFBSyx1Q0FBc0NaLE9BQU8sQ0FBQzJKLE1BQVIsQ0FBZUQsV0FBZixFQUE0QixDQUE1QixDQUErQixLQUEzRixHQUNiLG9CQUFtQlosTUFBTyxFQUR2QixDQUFOO0FBRUQ7QUFDRjs7QUFDRCxTQUFPSSxXQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjLCBTdWJQcm9jZXNzIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIHdhaXRGb3JDb25kaXRpb24gfSBmcm9tICdhc3luY2JveCc7XG5pbXBvcnQgeyBsb2dnZXIsIGZzLCB0ZW1wRGlyLCB1dGlsIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IGdldENsYW5nVmVyc2lvbiwgZ2V0VmVyc2lvbiB9IGZyb20gJ2FwcGl1bS14Y29kZSc7XG5cblxuY29uc3QgbG9nID0gbG9nZ2VyLmdldExvZ2dlcignc2ltY3RsJyk7XG5cbi8vIGNvbW1hbmQgbGluZSB0b29scyBhbmQgeGNvZGUgdmVyc2lvbiBjYW4gYmUgZGlmZmVyZW50XG5jb25zdCBDTURMSU5FX1RPT0xTX0NMQU5HX0ZPUk1BVF9DSEFOR0VEX1ZFUlNJT04gPSAnMTAwMS4wLjQ2JztcbmNvbnN0IFhDT0RFX0ZPUk1BVF9DSEFOR0VEX1ZFUlNJT04gPSAnMTAuMic7XG5cbmNvbnN0IFNJTV9SVU5USU1FX05BTUUgPSAnY29tLmFwcGxlLkNvcmVTaW11bGF0b3IuU2ltUnVudGltZS4nO1xuY29uc3QgU0lNX1JVTlRJTUVfTkFNRV9TVUZGSVhfSU9TID0gJ2lPUyc7XG5jb25zdCBERUZBVUxUX0NSRUFURV9TSU1VTEFUT1JfVElNRU9VVCA9IDEwMDAwO1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIHBhcnRpY3VsYXIgc2ltY3RsIGNvbW1hbmQgYW5kIHJldHVybiB0aGUgb3V0cHV0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb21tYW5kIC0gT25lIG9mIGF2YWlsYWJsZSBzaW1jdGwgc3ViY29tbWFuZHMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIEV4ZWN1dGUgYHhjcnVuIHNpbWN0bGAgaW4gVGVybWluYWwgdG8gc2VlIHRoZSBmdWxsIGxpc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgb2YgYXZhaWxhYmxlIHN1YmNvbW1hbmRzLlxuICogQHBhcmFtIHtudW1iZXJ9IHRpbWVvdXQgLSBDb21tYW5kIGV4ZWN1dGlvbiB0aW1lb3V0IGluIG1pbGxpc2Vjb25kcy5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgU2V0IGl0IHRvIHplcm8gdG8gc2tpcCB3YWl0aW5nIGZvciBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGlvbi5cbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGFyZ3MgW1tdXSAtIFRoZSBsaXN0IG9mIGFkZGl0aW9uYWwgc3ViY29tbWFuZCBhcmd1bWVudHMuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJdCdzIGVtcHR5IGJ5IGRlZmF1bHQuXG4gKiBAcGFyYW0ge09iamVjdH0gZW52IFt7fV0gLSBFbnZpcm9ubWVudCB2YXJpYWJsZXMgbWFwcGluZy4gQWxsIHRoZXNlIHZhcmlhYmxlc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lsbCBiZSBwYXNzZWQgU2ltdWxhdG9yIGFuZCB1c2VkIGluIF9leGVjdXRpbmdGdW5jdGlvbl8uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBleGVjdXRpbmdGdW5jdGlvbiAtIEV4ZWN1dGluZyBmdW5jdGlvbiBvYmplY3QuIEVxdWFscyB0byB0ZWVuX3Byb2Nlc3Mnc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZXhlY18gYnkgZGVmYXVsdC5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nRXJyb3JzIFt0cnVlXSAtIFNldCBpdCB0byBfZmFsc2VfIHRvIHRocm93IGV4ZWN1dGlvbiBlcnJvcnNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltbWVkaWF0ZWx5IHdpdGhvdXQgbG9nZ2luZyBhbnkgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi5cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHJlc3VsdCBvZiBfZXhlY3V0aW5nRnVuY3Rpb25fLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kIGV4ZWN1dGVkIGJ5IF9leGVjdXRpbmdGdW5jdGlvbl9cbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzaW1Db21tYW5kIChjb21tYW5kLCB0aW1lb3V0LCBhcmdzID0gW10sIGVudiA9IHt9LCBleGVjdXRpbmdGdW5jdGlvbiA9IGV4ZWMsIGxvZ0Vycm9ycyA9IHRydWUpIHtcbiAgLy8gcnVuIGEgcGFydGljdWxhciBzaW1jdGwgY29tbWFuZFxuICBhcmdzID0gWydzaW1jdGwnLCBjb21tYW5kLCAuLi5hcmdzXTtcbiAgLy8gUHJlZml4IGFsbCBwYXNzZWQgaW4gZW52aXJvbm1lbnQgdmFyaWFibGVzIHdpdGggJ1NJTUNUTF9DSElMRF8nLCBzaW1jdGxcbiAgLy8gd2lsbCB0aGVuIHBhc3MgdGhlc2UgdG8gdGhlIGNoaWxkIChzcGF3bmVkKSBwcm9jZXNzLlxuICBlbnYgPSBfLmRlZmF1bHRzKF8ubWFwS2V5cyhlbnYsICh2YWx1ZSwga2V5KSA9PiB7XG4gICAgcmV0dXJuIGBTSU1DVExfQ0hJTERfJHtrZXl9YDtcbiAgfSksIHByb2Nlc3MuZW52KTtcblxuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBleGVjdXRpbmdGdW5jdGlvbigneGNydW4nLCBhcmdzLCB7dGltZW91dCwgZW52fSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoIWxvZ0Vycm9ycykge1xuICAgICAgLy8gaWYgd2UgZG9uJ3Qgd2FudCB0byBzZWUgdGhlIGVycm9ycywganVzdCB0aHJvdyBhbmQgYWxsb3cgdGhlIGNhbGxpbmdcbiAgICAgIC8vIGNvZGUgZG8gd2hhdCBpdCB3YW50c1xuICAgICAgdGhyb3cgZTtcbiAgICB9IGVsc2UgaWYgKGUuc3RkZXJyKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgc2ltY3RsIGVycm9yIHJ1bm5pbmcgJyR7Y29tbWFuZH0nOiAke2Uuc3RkZXJyLnRyaW0oKX1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coZSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gRXhlY1Jlc3VsdFxuICogQHByb3BlcnR5IHs/c3RyaW5nfSBzdGRvdXQgLSBQcm9jZXNzIHN0ZG91dC5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gc3RkZXJyIC0gUHJvY2VzcyBzdGRlcnIuXG4gKiBAcHJvcGVydHkge251bWJlcn0gY29kZSAtIFByb2Nlc3MgZXhpdCBjb2RlLlxuICovXG5cbi8qKlxuICogRXhlY3V0ZSB0aGUgcGFydGljdWxhciBzaW1jdGwgc3ViY29tbWFuZCBzeW5jaHJvbm91c2x5IGFuZFxuICogd2FpdCBmb3IgdGhlIG91dHB1dC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWFuZCAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0IC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtBcnJheS48c3RyaW5nPn0gYXJncyBbW11dIC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtPYmplY3R9IGVudiBbe31dIC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtib29sZWFufSBsb2dFcnJvcnMgW3RydWVdIC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHJldHVybiB7RXhlY1Jlc3VsdH0gVGhlIHJlc3VsdCBvZiBfZXhlY18gZnVuY3Rpb24uXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmQgZXhlY3V0ZWQgYnkgZXhlY1xuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNpbUV4ZWMgKGNvbW1hbmQsIHRpbWVvdXQsIGFyZ3MgPSBbXSwgZW52ID0ge30sIGxvZ0Vycm9ycyA9IHRydWUpIHtcbiAgcmV0dXJuIGF3YWl0IHNpbUNvbW1hbmQoY29tbWFuZCwgdGltZW91dCwgYXJncywgZW52LCBhc3luYyAoYywgYSwgb2IpID0+IHtcbiAgICByZXR1cm4gYXdhaXQgZXhlYyhjLCBhLCBvYik7XG4gIH0sIGxvZ0Vycm9ycyk7XG59XG5cbi8qKlxuICogQ3JhdGUgYSB0ZWVuX3Byb2Nlc3MncyBTdWJQcm9jZXNzIGluc3RhbmNlIGZvciB0aGUgcGFydGljdWxhclxuICogc2ltY3RsIHN1YmNvbW1hbmQgZXhlY3V0aW9uLiBUaGlzIG1pZ2h0IGJlIG5lZWRlZCB0byBnYWluIGJldHRlclxuICogY29udHJvbCBvdmVyIHRoZSBleGVjdXRpb24gcHJvY2Vzcy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29tbWFuZCAtIFNlZSB7QGxpbmsgc2ltQ29tbWFuZH0gcGFyYW1ldGVycy5cbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0IC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtBcnJheS48c3RyaW5nPn0gYXJncyBbW11dIC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHBhcmFtIHtPYmplY3R9IGVudiBbe31dIC0gU2VlIHtAbGluayBzaW1Db21tYW5kfSBwYXJhbWV0ZXJzLlxuICogQHJldHVybiB7U3ViUHJvY2Vzc30gVGhlIGluc3RhbmNlIG9mIHRlZW5fcHJvY2VzcydzIFN1YlByb2Nlc3MgY2xhc3MuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNpbVN1YlByb2Nlc3MgKGNvbW1hbmQsIHRpbWVvdXQsIGFyZ3MgPSBbXSwgZW52ID0ge30pIHtcbiAgcmV0dXJuIGF3YWl0IHNpbUNvbW1hbmQoY29tbWFuZCwgdGltZW91dCwgYXJncywgZW52LCAoYywgYSwgb2IpID0+IHtcbiAgICByZXR1cm4gbmV3IFN1YlByb2Nlc3MoYywgYSwgb2IpO1xuICB9KTtcbn1cblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYXJ0aWN1bGFyIGFwcGxpY2F0aW9uIHBhY2thZ2Ugb24gU2ltdWxhdG9yLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIEZ1bGwgcGF0aCB0byAuYXBwIHBhY2thZ2UsIHdoaWNoIGlzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvaW5nIHRvIGJlIGluc3RhbGxlZC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gaW5zdGFsbEFwcCAodWRpZCwgYXBwUGF0aCkge1xuICBhd2FpdCBzaW1FeGVjKCdpbnN0YWxsJywgMCwgW3VkaWQsIGFwcFBhdGhdKTtcbn1cblxuLyoqXG4gKiBCb290IHRoZSBwYXJ0aWN1bGFyIFNpbXVsYXRvciBpZiBpdCBpcyBub3QgcnVubmluZy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gYm9vdERldmljZSAodWRpZCkge1xuICB0cnkge1xuICAgIGF3YWl0IHNpbUV4ZWMoJ2Jvb3QnLCAwLCBbdWRpZF0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBpZiAoKGVyci5tZXNzYWdlIHx8ICcnKS5pbmRleE9mKCdVbmFibGUgdG8gYm9vdCBkZXZpY2UgaW4gY3VycmVudCBzdGF0ZTogQm9vdGVkJykgPT09IC0xKSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgU2ltdWxhdG9yIGFscmVhZHkgaW4gJ0Jvb3RlZCcgc3RhdGUuIENvbnRpbnVpbmdgKTtcbiAgfVxufVxuXG4vKipcbiAqIFJlbW92ZSB0aGUgcGFydGljdWxhciBhcHBsaWNhdGlvbiBwYWNrYWdlIGZyb20gU2ltdWxhdG9yLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUgYW5kXG4gKiB0aGUgYXBwbGljYXRpb24gd2l0aCBnaXZlbiBidW5kbGUgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluc3RhbGxlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIEJ1bmRsZSBpZGVudGlmaWVyIG9mIHRoZSBhcHBsaWNhdGlvbixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWNoIGlzIGdvaW5nIHRvIGJlIHJlbW92ZWQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHJlbW92ZUFwcCAodWRpZCwgYnVuZGxlSWQpIHtcbiAgYXdhaXQgc2ltRXhlYygndW5pbnN0YWxsJywgMCwgW3VkaWQsIGJ1bmRsZUlkXSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZSB0aGUgcGFydGljdWxhciBhcHBsaWNhdGlvbiBwYWNrYWdlIG9uIFNpbXVsYXRvci5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlIGFuZFxuICogdGhlIGFwcGxpY2F0aW9uIHdpdGggZ2l2ZW4gYnVuZGxlIGlkZW50aWZpZXIgaXMgYWxyZWFkeSBpbnN0YWxsZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBCdW5kbGUgaWRlbnRpZmllciBvZiB0aGUgYXBwbGljYXRpb24sXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGljaCBpcyBnb2luZyB0byBiZSByZW1vdmVkLlxuICogQHBhcmFtIHtudW1iZXJ9IHRyaWVzIFs1XSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiByZXRyaWVzIGJlZm9yZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93aW5nIGFuIGV4Y2VwdGlvbi5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gbGF1bmNoICh1ZGlkLCBidW5kbGVJZCwgdHJpZXMgPSA1KSB7XG4gIGF3YWl0IHJldHJ5SW50ZXJ2YWwodHJpZXMsIDEwMDAsIGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBzaW1FeGVjKCdsYXVuY2gnLCAwLCBbdWRpZCwgYnVuZGxlSWRdKTtcbiAgfSk7XG59XG5cbi8qKlxuICogU3Bhd24gdGhlIHBhcnRpY3VsYXIgcHJvY2VzcyBvbiBTaW11bGF0b3IuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEBwYXJhbSB7c3RyaW5nfEFycmF5PHN0cmluZz59IGFyZ3MgLSBTcGF3biBhcmd1bWVudHNcbiAqIEBwYXJhbSB7b2JqZWN0fSBlbnYgW3t9XSAtIEFkZGl0aW9uYWwgZW52aXJvbm1lbnQgdmFyaWFibGVzIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtFeGVjUmVzdWx0fSBDb21tYW5kIGV4ZWN1dGlvbiByZXN1bHQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNwYXduICh1ZGlkLCBhcmdzLCBlbnYgPSB7fSkge1xuICByZXR1cm4gYXdhaXQgc2ltRXhlYygnc3Bhd24nLCAwLCBbdWRpZCwgLi4uKF8uaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBbYXJnc10pXSwgZW52KTtcbn1cblxuLyoqXG4gKiBQcmVwYXJlIFN1YlByb2Nlc3MgaW5zdGFuY2UgZm9yIGEgbmV3IHByb2Nlc3MsIHdoaWNoIGlzIGdvaW5nIHRvIGJlIHNwYXduZWRcbiAqIG9uIFNpbXVsYXRvci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEBwYXJhbSB7c3RyaW5nfEFycmF5PHN0cmluZz59IGFyZ3MgLSBTcGF3biBhcmd1bWVudHNcbiAqIEBwYXJhbSB7b2JqZWN0fSBlbnYgW3t9XSAtIEFkZGl0aW9uYWwgZW52aXJvbm1lbnQgdmFyaWFibGVzIG1hcHBpbmcuXG4gKiBAcmV0dXJuIHtTdWJQcm9jZXNzfSBUaGUgaW5zdGFuY2Ugb2YgdGhlIHByb2Nlc3MgdG8gYmUgc3Bhd25lZC5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc3Bhd25TdWJQcm9jZXNzICh1ZGlkLCBhcmdzLCBlbnYgPSB7fSkge1xuICByZXR1cm4gYXdhaXQgc2ltU3ViUHJvY2Vzcygnc3Bhd24nLCAwLCBbdWRpZCwgLi4uKF8uaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBbYXJnc10pXSwgZW52KTtcbn1cblxuLyoqXG4gKiBPcGVuIFVSTCBzY2hlbWUgb24gU2ltdWxhdG9yLiBpT1Mgd2lsbCBhdXRvbWF0aWNhbGx5IHRyeVxuICogdG8gZmluZCBhIG1hdGNoaW5nIGFwcGxpY2F0aW9uLCB3aGljaCBzdXBwb3J0cyB0aGUgZ2l2ZW4gc2NoZW1lLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIC0gVGhlIFVSTCBzY2hlbWUgdG8gb3BlbiwgZm9yIGV4YW1wbGUgaHR0cDovL2FwcGlvbS5pb1xuICogICAgICAgICAgICAgICAgICAgICAgIHdpbGwgYmUgb3BlbmVkIGJ5IHRoZSBidWlsdC1pbiBtb2JpbGUgYnJvd3Nlci5cbiAqIEByZXR1cm4ge0V4ZWNSZXN1bHR9IENvbW1hbmQgZXhlY3V0aW9uIHJlc3VsdC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gb3BlblVybCAodWRpZCwgdXJsKSB7XG4gIHJldHVybiBhd2FpdCBzaW1FeGVjKCdvcGVudXJsJywgMCwgW3VkaWQsIHVybF0pO1xufVxuXG4vKipcbiAqIEludm9rZSBoaWRkZW4gYXBwaW5mbyBzdWJjb21tYW5kIHRvIGdldCB0aGUgaW5mb3JtYXRpb25cbiAqIGFib3V0IGFwcGxpY2F0aW9ucyBpbnN0YWxsZWQgb24gU2ltdWxhdG9yLCBpbmNsdWRpbmdcbiAqIHN5c3RlbSBhcHBsaWNhdGlvbnMgKHtAbGluayBnZXRBcHBDb250YWluZXJ9IGRvZXMgbm90IFwic2VlXCIgc3VjaCBhcHBzKS5cbiAqIFNpbXVsYXRvciBzZXJ2ZXIgc2hvdWxkIGJlIGluICdib290ZWQnIHN0YXRlIGZvciB0aGlzIGNhbGwgdG8gd29yayBwcm9wZXJseS5cbiAqIFRoZSB0b29sIGlzIG9ubHkgYXZhaWxhYmxlIHNpbmNlIFhjb2RlIFNESyA4LjFcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFVESUQgb2YgdGhlIHRhcmdldCBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkZW50aWZpZXIgb2YgdGhlIHRhcmdldCBhcHBsaWNhdGlvbi5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGluZm9ybWF0aW9uIGFib3V0IGluc3RhbGxlZCBhcHBsaWNhdGlvbi5cbiAqXG4gKiBFeGFtcGxlIG91dHB1dCBmb3Igbm9uLWV4aXN0aW5nIGFwcGxpY2F0aW9uIGNvbnRhaW5lcjpcbiAqIDxwcmU+XG4gKiB7XG4gKiAgIENGQnVuZGxlSWRlbnRpZmllciA9IFwiY29tLmFwcGxlLk1vYmlsZVNhZmFyaVwiO1xuICogICBHcm91cENvbnRhaW5lcnMgPSAgICAge1xuICogICB9O1xuICogICBTQkFwcFRhZ3MgPSAgICAgKFxuICogICApO1xuICogfVxuICogPC9wcmU+XG4gKlxuICogRXhhbXBsZSBvdXRwdXQgZm9yIGFuIGV4aXN0aW5nIHN5c3RlbSBhcHBsaWNhdGlvbiBjb250YWluZXI6XG4gKiA8cHJlPlxuICoge1xuICogICBBcHBsaWNhdGlvblR5cGUgPSBIaWRkZW47XG4gKiAgIEJ1bmRsZSA9IFwiZmlsZTovLy9BcHBsaWNhdGlvbnMvWGNvZGUtYmV0YS5hcHAvQ29udGVudHMvRGV2ZWxvcGVyL1BsYXRmb3Jtcy9pUGhvbmVPUy5wbGF0Zm9ybS9EZXZlbG9wZXIvTGlicmFyeS9Db3JlU2ltdWxhdG9yL1Byb2ZpbGVzL1J1bnRpbWVzL2lPUy5zaW1ydW50aW1lL0NvbnRlbnRzL1Jlc291cmNlcy9SdW50aW1lUm9vdC9TeXN0ZW0vTGlicmFyeS9Db3JlU2VydmljZXMvU3ByaW5nQm9hcmQuYXBwXCI7XG4gKiAgIENGQnVuZGxlRGlzcGxheU5hbWUgPSBTcHJpbmdCb2FyZDtcbiAqICAgQ0ZCdW5kbGVFeGVjdXRhYmxlID0gU3ByaW5nQm9hcmQ7XG4gKiAgIENGQnVuZGxlSWRlbnRpZmllciA9IFwiY29tLmFwcGxlLnNwcmluZ2JvYXJkXCI7XG4gKiAgIENGQnVuZGxlTmFtZSA9IFNwcmluZ0JvYXJkO1xuICogICBDRkJ1bmRsZVZlcnNpb24gPSA1MDtcbiAqICAgR3JvdXBDb250YWluZXJzID0gICAgIHtcbiAqICAgfTtcbiAqICAgUGF0aCA9IFwiL0FwcGxpY2F0aW9ucy9YY29kZS1iZXRhLmFwcC9Db250ZW50cy9EZXZlbG9wZXIvUGxhdGZvcm1zL2lQaG9uZU9TLnBsYXRmb3JtL0RldmVsb3Blci9MaWJyYXJ5L0NvcmVTaW11bGF0b3IvUHJvZmlsZXMvUnVudGltZXMvaU9TLnNpbXJ1bnRpbWUvQ29udGVudHMvUmVzb3VyY2VzL1J1bnRpbWVSb290L1N5c3RlbS9MaWJyYXJ5L0NvcmVTZXJ2aWNlcy9TcHJpbmdCb2FyZC5hcHBcIjtcbiAqICAgU0JBcHBUYWdzID0gICAgIChcbiAqICAgKTtcbiAqIH1cbiAqIDwvcHJlPlxuICovXG5hc3luYyBmdW5jdGlvbiBhcHBJbmZvICh1ZGlkLCBidW5kbGVJZCkge1xuICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IHNpbUV4ZWMoJ2FwcGluZm8nLCAwLCBbdWRpZCwgYnVuZGxlSWRdKTtcbiAgcmV0dXJuIChzdGRvdXQgfHwgJycpLnRyaW0oKTtcbn1cblxuLyoqXG4gKiBBZGQgdGhlIHBhcnRpY3VsYXIgbWVkaWEgZmlsZSB0byBTaW11bGF0b3IncyBsaWJyYXJ5LlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aCAtIEZ1bGwgcGF0aCB0byBhIG1lZGlhIGZpbGUgb24gdGhlIGxvY2FsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUgc3lzdGVtLlxuICogQHJldHVybiB7RXhlY1Jlc3VsdH0gQ29tbWFuZCBleGVjdXRpb24gcmVzdWx0LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBhZGRNZWRpYSAodWRpZCwgcGF0aCkge1xuICByZXR1cm4gYXdhaXQgc2ltRXhlYygnYWRkbWVkaWEnLCAwLCBbdWRpZCwgcGF0aF0pO1xufVxuXG4vKipcbiAqIFRlcm1pbmF0ZSB0aGUgZ2l2ZW4gcnVubmluZyBhcHBsaWNhdGlvbiBvbiBTaW11bGF0b3IuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIEJ1bmRsZSBpZGVudGlmaWVyIG9mIHRoZSBhcHBsaWNhdGlvbixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWNoIGlzIGdvaW5nIHRvIGJlIHRlcm1pbmF0ZWQuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHRlcm1pbmF0ZSAodWRpZCwgYnVuZGxlSWQpIHtcbiAgYXdhaXQgc2ltRXhlYygndGVybWluYXRlJywgMCwgW3VkaWQsIGJ1bmRsZUlkXSk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBmdWxsIHBhdGggdG8gdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb24gY29udGFpbmVyXG4gKiBvbiB0aGUgbG9jYWwgZmlsZSBzeXN0ZW0uIE5vdGUsIHRoYXQgdGhpcyBzdWJjb21tYW5kIHRocm93c1xuICogYW4gZXJyb3IgaWYgYnVuZGxlIGlkIG9mIGEgc3lzdGVtIGFwcGxpY2F0aW9uIGlzIHByb3ZpZGVkLFxuICogbGlrZSAnY29tLmFwcGxlLnNwcmluZ2JvYXJkJy5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIC0gVGhlIFVESUQgb2YgYW4gZXhpc3RpbmcgU2ltdWxhdG9yLlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gQnVuZGxlIGlkZW50aWZpZXIgb2YgYW4gYXBwbGljYXRpb24uXG4gKiBAcGFyYW0gez9ib29sZWFufSBsb2dFcnJvcnMgW3RydWVdIC0gV2hldGhlciB0byBpbmNsdWRlIGV4ZWMncyBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkZXJyIG91dHB1dCBpbnRvIGV4Y2VwdGlvbiBtZXNzYWdlIGlmIHRocm93bi5cbiAqIEBwYXJhbSB7P3N0cmluZ30gY29udGFpbmVyVHlwZSAtIFdoaWNoIGNvbnRhaW5lciB0eXBlIHRvIHJldHVybi4gUG9zc2libGUgdmFsdWVzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmUgJ2FwcCcsICdkYXRhJywgJ2dyb3VwcycsICc8QSBzcGVjaWZpYyBBcHAgR3JvdXAgY29udGFpbmVyPicuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGUgZGVmYXVsdCB2YWx1ZSBpcyAnYXBwJy5cbiAqIEByZXR1cm4ge3N0cmluZ30gRnVsbCBwYXRoIHRvIHRoZSBnaXZlbiBhcHBsaWNhdGlvbiBjb250YWluZXIgb24gdGhlIGxvY2FsXG4gKiAgICAgICAgICAgICAgICAgIGZpbGUgc3lzdGVtLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRBcHBDb250YWluZXIgKHVkaWQsIGJ1bmRsZUlkLCBsb2dFcnJvcnMgPSB0cnVlLCBjb250YWluZXJUeXBlID0gbnVsbCkge1xuICBjb25zdCBhcmdzID0gW3VkaWQsIGJ1bmRsZUlkXTtcbiAgaWYgKGNvbnRhaW5lclR5cGUpIHtcbiAgICBhcmdzLnB1c2goY29udGFpbmVyVHlwZSk7XG4gIH1cbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdnZXRfYXBwX2NvbnRhaW5lcicsIDAsIGFyZ3MsIHt9LCBsb2dFcnJvcnMpO1xuICByZXR1cm4gKHN0ZG91dCB8fCAnJykudHJpbSgpO1xufVxuXG4vKipcbiAqIFNodXRkb3duIHRoZSBnaXZlbiBTaW11bGF0b3IgaWYgaXQgaXMgcnVubmluZy5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc2h1dGRvd24gKHVkaWQpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzaW1FeGVjKCdzaHV0ZG93bicsIDAsIFt1ZGlkXSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmICghKGVyciArICcnKS5pbmNsdWRlcygnY3VycmVudCBzdGF0ZTogU2h1dGRvd24nKSkge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBsb2cuZGVidWcoYFNpbXVsYXRvciBhbHJlYWR5IGluICdTaHV0ZG93bicgc3RhdGUuIENvbnRpbnVpbmdgKTtcbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFNpbUNyZWF0aW9uT3B0c1xuICogQHByb3BlcnR5IHtzdHJpbmd9IHBsYXRmb3JtIFtpT1NdIC0gUGxhdGZvcm0gbmFtZSBpbiBvcmRlciB0byBzcGVjaWZ5IHJ1bnRpbWUgc3VjaCBhcyAnaU9TJywgJ3R2T1MnLCAnd2F0Y2hPUydcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lb3V0IFsxMDAwMF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0IGRldmljZSBjcmVhdGlvbiBpcyBjb21wbGV0ZWQuXG4gKi9cbi8qKlxuICogQ3JlYXRlIFNpbXVsYXRvciBkZXZpY2Ugd2l0aCBnaXZlbiBuYW1lIGZvciB0aGUgcGFydGljdWxhclxuICogcGxhdGZvcm0gdHlwZSBhbmQgdmVyc2lvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFRoZSBkZXZpY2UgbmFtZSB0byBiZSBjcmVhdGVkLlxuICogQHBhcmFtIHtzdHJpbmd9IGRldmljZVR5cGVJZCAtIERldmljZSB0eXBlLCBmb3IgZXhhbXBsZSAnaVBob25lIDYnLlxuICogQHBhcmFtIHtzdHJpbmd9IHJ1bnRpbWVJZCAtIFBsYXRmb3JtIHZlcnNpb24sIGZvciBleGFtcGxlICcxMC4zJy5cbiAqIEBwYXJhbSB7P1NpbUNyZWF0aW9uT3B0c30gb3B0cyAtIFNpbXVsYXRvciBvcHRpb25zIGZvciBjcmVhdGluZyBkZXZpY2VzLlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgVURJRCBvZiB0aGUgbmV3bHkgY3JlYXRlZCBkZXZpY2UuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZURldmljZSAobmFtZSwgZGV2aWNlVHlwZUlkLCBydW50aW1lSWQsIG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgcGxhdGZvcm0gPSBTSU1fUlVOVElNRV9OQU1FX1NVRkZJWF9JT1MsXG4gICAgdGltZW91dCA9IERFRkFVTFRfQ1JFQVRFX1NJTVVMQVRPUl9USU1FT1VUXG4gIH0gPSBvcHRzO1xuXG4gIC8vIFRyeSBnZXR0aW5nIHJ1bnRpbWVJZCB1c2luZyBKU09OIGZsYWdcbiAgbGV0IHJ1bnRpbWVJZEZyb21Kc29uO1xuICB0cnkge1xuICAgIHJ1bnRpbWVJZEZyb21Kc29uID0gYXdhaXQgZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvblZpYUpzb24ocnVudGltZUlkLCBwbGF0Zm9ybSk7XG4gICAgcnVudGltZUlkID0gcnVudGltZUlkRnJvbUpzb247XG4gIH0gY2F0Y2ggKGlnbikgeyB9XG5cbiAgaWYgKCFydW50aW1lSWRGcm9tSnNvbikge1xuICAgIC8vIGF0IGZpcnN0IG1ha2Ugc3VyZSB0aGF0IHRoZSBydW50aW1lIGlkIGlzIHRoZSByaWdodCBvbmVcbiAgICAvLyBpbiBzb21lIHZlcnNpb25zIG9mIFhjb2RlIGl0IHdpbGwgYmUgYSBwYXRjaCB2ZXJzaW9uXG4gICAgdHJ5IHtcbiAgICAgIHJ1bnRpbWVJZCA9IGF3YWl0IGdldFJ1bnRpbWVGb3JQbGF0Zm9ybVZlcnNpb24ocnVudGltZUlkLCBwbGF0Zm9ybSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2cud2FybihgVW5hYmxlIHRvIGZpbmQgcnVudGltZSBmb3IgaU9TICcke3J1bnRpbWVJZH0nLiBDb250aW51aW5nYCk7XG4gICAgfVxuXG4gICAgY29uc3QgY2xhbmdWZXJzaW9uID0gYXdhaXQgZ2V0Q2xhbmdWZXJzaW9uKCk7XG4gICAgLy8gMXN0IGNvbXBhcmlzb246IGNsYW5nVmVyc2lvblxuICAgIC8vIENvbW1hbmQgbGluZSB0b29scyB2ZXJzaW9uIGlzIDEwLjIrLCBidXQgeGNvZGUgMTAuMSBjYW4gaGFwcGVuXG4gICAgbGV0IGlzTmV3ZXJJZEZvcm1hdFJlcXVpcmVkID0gY2xhbmdWZXJzaW9uICYmIHV0aWwuY29tcGFyZVZlcnNpb25zKGNsYW5nVmVyc2lvbiwgJz49JyxcbiAgICAgIENNRExJTkVfVE9PTFNfQ0xBTkdfRk9STUFUX0NIQU5HRURfVkVSU0lPTik7XG5cbiAgICBpZiAoIWlzTmV3ZXJJZEZvcm1hdFJlcXVpcmVkKSB7XG4gICAgICAvLyAybmQgY29tcGFyaXNvbjogZ2V0VmVyc2lvblxuICAgICAgLy8gVGhlIG9wcG9zaXRlIGNhbiBhbHNvIGhhcHBlbixcbiAgICAgIC8vIGJ1dCB0aGUgY29tYmluYXRpb24gb2YgMTAuMiBjb21tYW5kIGxpbmUgdG9vbHMgYW5kIGxvd2VyIFhjb2RlIHZlcnNpb24gaGFwcGVucyBtb3JlIGZyZXF1ZW50bHlcbiAgICAgIGNvbnN0IHhjb2RlVmVyc2lvbiA9IGF3YWl0IGdldFZlcnNpb24oZmFsc2UpO1xuICAgICAgaXNOZXdlcklkRm9ybWF0UmVxdWlyZWQgPSB4Y29kZVZlcnNpb24gJiYgdXRpbC5jb21wYXJlVmVyc2lvbnMoeGNvZGVWZXJzaW9uLCAnPj0nLFxuICAgICAgICBYQ09ERV9GT1JNQVRfQ0hBTkdFRF9WRVJTSU9OKTtcbiAgICB9XG5cbiAgICBpZiAoaXNOZXdlcklkRm9ybWF0UmVxdWlyZWQpIHtcbiAgICAgIHJ1bnRpbWVJZCA9IGAke1NJTV9SVU5USU1FX05BTUV9JHtwbGF0Zm9ybX0tJHtydW50aW1lSWQucmVwbGFjZSgvXFwuL2csICctJyl9YDtcbiAgICB9XG4gIH1cblxuICBsb2cuZGVidWcoYENyZWF0aW5nIHNpbXVsYXRvciB3aXRoIG5hbWUgJyR7bmFtZX0nLCBkZXZpY2UgdHlwZSBpZCAnJHtkZXZpY2VUeXBlSWR9JyBhbmQgcnVudGltZSBpZCAnJHtydW50aW1lSWR9J2ApO1xuICBsZXQgdWRpZDtcbiAgdHJ5IHtcbiAgICBjb25zdCBvdXQgPSBhd2FpdCBzaW1FeGVjKCdjcmVhdGUnLCAwLCBbbmFtZSwgZGV2aWNlVHlwZUlkLCBydW50aW1lSWRdKTtcbiAgICB1ZGlkID0gb3V0LnN0ZG91dC50cmltKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxldCByZWFzb24gPSBlcnIubWVzc2FnZTtcbiAgICBpZiAoZXJyLnN0ZGVycikge1xuICAgICAgcmVhc29uID0gZXJyLnN0ZGVyci50cmltKCk7XG4gICAgfVxuICAgIGxvZy5lcnJvckFuZFRocm93KGBDb3VsZCBub3QgY3JlYXRlIHNpbXVsYXRvciB3aXRoIG5hbWUgJyR7bmFtZX0nLCBkZXZpY2UgYCArXG4gICAgICAgICAgICAgICAgICAgICAgYHR5cGUgaWQgJyR7ZGV2aWNlVHlwZUlkfScgYW5kIHJ1bnRpbWUgaWQgJyR7cnVudGltZUlkfScuIFJlYXNvbjogJyR7cmVhc29ufSdgKTtcbiAgfVxuXG4gIC8vIG1ha2Ugc3VyZSB0aGF0IGl0IGdldHMgb3V0IG9mIHRoZSBcIkNyZWF0aW5nXCIgc3RhdGVcbiAgbGV0IHJldHJpZXMgPSBwYXJzZUludCh0aW1lb3V0IC8gMTAwMCwgMTApO1xuICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDEwMDAsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZGV2aWNlcyA9IGF3YWl0IGdldERldmljZXMoKTtcbiAgICBmb3IgKGNvbnN0IGRldmljZUFyciBvZiBfLnZhbHVlcyhkZXZpY2VzKSkge1xuICAgICAgZm9yIChjb25zdCBkZXZpY2Ugb2YgZGV2aWNlQXJyKSB7XG4gICAgICAgIGlmIChkZXZpY2UudWRpZCA9PT0gdWRpZCkge1xuICAgICAgICAgIGlmIChkZXZpY2Uuc3RhdGUgPT09ICdDcmVhdGluZycpIHtcbiAgICAgICAgICAgIC8vIG5lZWQgdG8gcmV0cnlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGV2aWNlIHN0aWxsIGJlaW5nIGNyZWF0ZWQnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gc3RvcCBsb29raW5nLCB3ZSdyZSBkb25lXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gdWRpZDtcbn1cblxuLyoqXG4gKiBEZWxldGUgdGhlIHBhcnRpY3VsYXIgU2ltdWxhdG9yIGZyb20gYXZhaWxhYmxlIGRldmljZXMgbGlzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIFRoZSBVRElEIG9mIGFuIGV4aXN0aW5nIFNpbXVsYXRvci5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZGVsZXRlRGV2aWNlICh1ZGlkKSB7XG4gIGF3YWl0IHNpbUV4ZWMoJ2RlbGV0ZScsIDAsIFt1ZGlkXSk7XG59XG5cbi8qKlxuICogUmVzZXQgdGhlIGNvbnRlbnQgYW5kIHNldHRpbmdzIG9mIHRoZSBwYXJ0aWN1bGFyIFNpbXVsYXRvci5cbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9zaHV0ZG93bl8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcGFyYW0ge251bWJlcn0gdGltZW91dCBbMTAwMDBdIC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdCBkZXZpY2UgcmVzZXQgaXMgY29tcGxldGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBlcmFzZURldmljZSAodWRpZCwgdGltZW91dCA9IDEwMDApIHtcbiAgbGV0IGxvb3BGbiA9IGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBzaW1FeGVjKCdlcmFzZScsIDEwMDAwLCBbdWRpZF0pO1xuICB9O1xuICAvLyByZXRyeSBlcmFzZSB3aXRoIGEgc2xlZXAgaW4gYmV0d2VlbiBiZWNhdXNlIGl0J3MgZmxha2V5XG4gIGxldCByZXRyaWVzID0gcGFyc2VJbnQodGltZW91dCAvIDIwMCwgMTApO1xuICBhd2FpdCByZXRyeUludGVydmFsKHJldHJpZXMsIDIwMCwgbG9vcEZuKTtcbn1cblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBEZXZpY2VJbmZvXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBkZXZpY2UgbmFtZS5cbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSB1ZGlkIC0gVGhlIGRldmljZSBVRElELlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHN0YXRlIC0gVGhlIGN1cnJlbnQgU2ltdWxhdG9yIHN0YXRlLCBmb3IgZXhhbXBsZSAnYm9vdGVkJyBvciAnc2h1dGRvd24nLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHNkayAtIFRoZSBTREsgdmVyc2lvbiwgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICovXG5cbi8qKlxuICogUGFyc2UgdGhlIGxpc3Qgb2YgZXhpc3RpbmcgU2ltdWxhdG9yIGRldmljZXMgdG8gcmVwcmVzZW50XG4gKiBpdCBhcyBjb252ZW5pZW50IG1hcHBpbmcuXG4gKlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSByZXN1bHRpbmcgbWFwcGluZy4gRWFjaCBrZXkgaXMgcGxhdGZvcm0gdmVyc2lvbixcbiAqICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnIGFuZCB0aGUgY29ycmVzcG9uZGluZyB2YWx1ZSBpcyBhblxuICogICAgICAgICAgICAgICAgICBhcnJheSBvZiB0aGUgbWF0Y2hpbmcge0BsaW5rIERldmljZUluZm99IGluc3RhbmNlcy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlc0J5UGFyc2luZyAocGxhdGZvcm0pIHtcbiAgLy8gZ2V0IHRoZSBsaXN0IG9mIGRldmljZXNcbiAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWydkZXZpY2VzJ10pO1xuXG4gIC8vIGV4cGVjdCB0byBnZXQgYSBsaXN0aW5nIGxpa2VcbiAgLy8gLS0gaU9TIDguMSAtLVxuICAvLyAgICAgaVBob25lIDRzICgzQ0E2RTdERC0yMjBFLTQ1RTUtQjcxNi0xRTk5MkIzQTQyOUMpIChTaHV0ZG93bilcbiAgLy8gICAgIC4uLlxuICAvLyAtLSBpT1MgOC4yIC0tXG4gIC8vICAgICBpUGhvbmUgNHMgKEE5OUZGRkMzLThFMTktNERDRi1CNTg1LTdEOUQ0NkI0QzE2RSkgKFNodXRkb3duKVxuICAvLyAgICAgLi4uXG4gIC8vIHNvLCBnZXQgdGhlIGAtLSBpT1MgWC5YIC0tYCBsaW5lIHRvIGZpbmQgdGhlIHNkayAoWC5YKVxuICAvLyBhbmQgdGhlIHJlc3Qgb2YgdGhlIGxpc3RpbmcgaW4gb3JkZXIgdG8gbGF0ZXIgZmluZCB0aGUgZGV2aWNlc1xuICBjb25zdCBkZXZpY2VTZWN0aW9uUmUgPSBfLmlzRW1wdHkocGxhdGZvcm0pXG4gICAgPyBuZXcgUmVnRXhwKGBcXFxcLVxcXFwtXFxcXHMrKFxcXFxTKylcXFxccysoXFxcXFMrKVxcXFxzK1xcXFwtXFxcXC0oXFxcXG5cXFxcc3s0fS4rKSpgLCAnbWdpJylcbiAgICA6IG5ldyBSZWdFeHAoYFxcXFwtXFxcXC1cXFxccyske18uZXNjYXBlUmVnRXhwKHBsYXRmb3JtKX1cXFxccysoXFxcXFMrKVxcXFxzK1xcXFwtXFxcXC0oXFxcXG5cXFxcc3s0fS4rKSpgLCAnbWdpJyk7XG4gIGNvbnN0IG1hdGNoZXMgPSBbXTtcbiAgbGV0IG1hdGNoO1xuICAvLyBtYWtlIGFuIGVudHJ5IGZvciBlYWNoIHNkayB2ZXJzaW9uXG4gIHdoaWxlICgobWF0Y2ggPSBkZXZpY2VTZWN0aW9uUmUuZXhlYyhzdGRvdXQpKSkge1xuICAgIG1hdGNoZXMucHVzaChtYXRjaCk7XG4gIH1cbiAgaWYgKF8uaXNFbXB0eShtYXRjaGVzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgZGV2aWNlIHNlY3Rpb24nKTtcbiAgfVxuXG4gIGNvbnN0IGxpbmVSZSA9IC8oW15cXHNdLispIFxcKChcXHcrLS4rXFx3KylcXCkgXFwoKFxcdytcXHM/XFx3KylcXCkvOyAvLyBodHRwczovL3JlZ2V4MTAxLmNvbS9yL2xHN21LNi8zXG4gIC8vIGdldCBhbGwgdGhlIGRldmljZXMgZm9yIGVhY2ggc2RrXG4gIGNvbnN0IGRldmljZXMgPSB7fTtcbiAgZm9yIChtYXRjaCBvZiBtYXRjaGVzKSB7XG4gICAgY29uc3Qgc2RrID0gcGxhdGZvcm0gPyBtYXRjaFsxXSA6IG1hdGNoWzJdO1xuICAgIGRldmljZXNbc2RrXSA9IGRldmljZXNbc2RrXSB8fCBbXTtcbiAgICAvLyBzcGxpdCB0aGUgZnVsbCBtYXRjaCBpbnRvIGxpbmVzIGFuZCByZW1vdmUgdGhlIGZpcnN0XG4gICAgZm9yIChjb25zdCBsaW5lIG9mIG1hdGNoWzBdLnNwbGl0KCdcXG4nKS5zbGljZSgxKSkge1xuICAgICAgaWYgKGxpbmUuaW5jbHVkZXMoJyh1bmF2YWlsYWJsZSwgJykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICAvLyBhIGxpbmUgaXMgc29tZXRoaW5nIGxpa2VcbiAgICAgIC8vICAgIGlQaG9uZSA0cyAoQTk5RkZGQzMtOEUxOS00RENGLUI1ODUtN0Q5RDQ2QjRDMTZFKSAoU2h1dGRvd24pXG4gICAgICAvLyByZXRyaWV2ZTpcbiAgICAgIC8vICAgaVBob25lIDRzXG4gICAgICAvLyAgIEE5OUZGRkMzLThFMTktNERDRi1CNTg1LTdEOUQ0NkI0QzE2RVxuICAgICAgLy8gICBTaHV0ZG93blxuICAgICAgY29uc3QgbGluZU1hdGNoID0gbGluZVJlLmV4ZWMobGluZSk7XG4gICAgICBpZiAoIWxpbmVNYXRjaCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBtYXRjaCBsaW5lOiAke2xpbmV9YCk7XG4gICAgICB9XG4gICAgICAvLyBzYXZlIHRoZSB3aG9sZSB0aGluZyBhcyBhYiBvYmplY3QgaW4gdGhlIGxpc3QgZm9yIHRoaXMgc2RrXG4gICAgICBkZXZpY2VzW3Nka10ucHVzaCh7XG4gICAgICAgIG5hbWU6IGxpbmVNYXRjaFsxXSxcbiAgICAgICAgdWRpZDogbGluZU1hdGNoWzJdLFxuICAgICAgICBzdGF0ZTogbGluZU1hdGNoWzNdLFxuICAgICAgICBzZGssXG4gICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybSB8fCBtYXRjaFsxXSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGV2aWNlcztcbn1cblxuLyoqXG4gKiBQYXJzZSB0aGUgbGlzdCBvZiBleGlzdGluZyBTaW11bGF0b3IgZGV2aWNlcyB0byByZXByZXNlbnRcbiAqIGl0IGFzIGNvbnZlbmllbnQgbWFwcGluZyBmb3IgdGhlIHBhcnRpY3VsYXIgcGxhdGZvcm0gdmVyc2lvbi5cbiAqXG4gKiBAcGFyYW0gez9zdHJpbmd9IGZvclNkayAtIFRoZSBzZGsgdmVyc2lvbixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHdoaWNoIHRoZSBkZXZpY2VzIGxpc3Qgc2hvdWxkIGJlIHBhcnNlZCxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGV4YW1wbGUgJzEwLjMnLlxuICogQHBhcmFtIHs/c3RyaW5nfSBwbGF0Zm9ybSAtIFRoZSBwbGF0Zm9ybSBuYW1lLCBmb3IgZXhhbXBsZSAnd2F0Y2hPUycuXG4gKiBAcmV0dXJuIHtPYmplY3R8QXJyYXk8RGV2aWNlSW5mbz59IElmIF9mb3JTZGtfIGlzIHNldCB0aGVuIHRoZSBsaXN0XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mIGRldmljZXMgZm9yIHRoZSBwYXJ0aWN1bGFyIHBsYXRmb3JtIHZlcnNpb24uXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE90aGVyd2lzZSB0aGUgc2FtZSByZXN1bHQgYXMgZm9yIHtAbGluayBnZXREZXZpY2VzQnlQYXJzaW5nfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbi5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgc3ViY29tbWFuZCBjb21tYW5kXG4gKiAgICAgICAgICAgICAgICAgcmV0dXJucyBub24temVybyByZXR1cm4gY29kZSBvciBpZiBubyBtYXRjaGluZ1xuICogICAgICAgICAgICAgICAgIHBsYXRmb3JtIHZlcnNpb24gaXMgZm91bmQgaW4gdGhlIHN5c3RlbS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlcyAoZm9yU2RrLCBwbGF0Zm9ybSkge1xuICBsZXQgZGV2aWNlcyA9IHt9O1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnbGlzdCcsIDAsIFsnZGV2aWNlcycsICctaiddKTtcbiAgICAvKiBKU09OIHNob3VsZCBiZVxuICAgICAqIHtcbiAgICAgKiAgIFwiZGV2aWNlc1wiIDoge1xuICAgICAqICAgICBcImlPUyA8c2RrPlwiIDogWyAvLyBvclxuICAgICAqICAgICBcImNvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbVJ1bnRpbWUuaU9TLTxzZGs+IDogW1xuICAgICAqICAgICAgIHtcbiAgICAgKiAgICAgICAgIFwic3RhdGVcIiA6IFwiQm9vdGVkXCIsXG4gICAgICogICAgICAgICBcImF2YWlsYWJpbGl0eVwiIDogXCIoYXZhaWxhYmxlKVwiLFxuICAgICAqICAgICAgICAgXCJpc0F2YWlsYWJsZVwiIDogdHJ1ZSxcbiAgICAgKiAgICAgICAgIFwibmFtZVwiIDogXCJpUGhvbmUgNlwiLFxuICAgICAqICAgICAgICAgXCJ1ZGlkXCIgOiBcIjc1RTM0MTQwLTE4RTgtNEQxQS05RjQ1LUFBQzczNURGNzVERlwiXG4gICAgICogICAgICAgfVxuICAgICAqICAgICBdXG4gICAgICogICB9XG4gICAgICogfVxuICAgICAqL1xuICAgIGNvbnN0IHZlcnNpb25NYXRjaFJlID0gXy5pc0VtcHR5KHBsYXRmb3JtKVxuICAgICAgPyBuZXcgUmVnRXhwKGBeKFteXFxcXHMtXSspW1xcXFxzLV0oXFxcXFMrKWAsICdpJylcbiAgICAgIDogbmV3IFJlZ0V4cChgXiR7Xy5lc2NhcGVSZWdFeHAocGxhdGZvcm0pfVtcXFxccy1dKFxcXFxTKylgLCAnaScpO1xuICAgIGZvciAobGV0IFtzZGtOYW1lLCBlbnRyaWVzXSBvZiBfLnRvUGFpcnMoSlNPTi5wYXJzZShzdGRvdXQpLmRldmljZXMpKSB7XG4gICAgICAvLyB0aGVyZSBjb3VsZCBiZSBhIGxvbmdlciBuYW1lLCBzbyByZW1vdmUgaXRcbiAgICAgIHNka05hbWUgPSBzZGtOYW1lLnJlcGxhY2UoU0lNX1JVTlRJTUVfTkFNRSwgJycpO1xuICAgICAgY29uc3QgdmVyc2lvbk1hdGNoID0gdmVyc2lvbk1hdGNoUmUuZXhlYyhzZGtOYW1lKTtcbiAgICAgIGlmICghdmVyc2lvbk1hdGNoKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyB0aGUgc2RrIGNhbiBoYXZlIGRhc2hlcyAoYDEyLTJgKSBvciBkb3RzIChgMTIuMWApXG4gICAgICBjb25zdCBzZGsgPSAocGxhdGZvcm0gPyB2ZXJzaW9uTWF0Y2hbMV0gOiB2ZXJzaW9uTWF0Y2hbMl0pLnJlcGxhY2UoJy0nLCAnLicpO1xuICAgICAgZGV2aWNlc1tzZGtdID0gZGV2aWNlc1tzZGtdIHx8IFtdO1xuICAgICAgZGV2aWNlc1tzZGtdLnB1c2goLi4uZW50cmllcy5maWx0ZXIoKGVsKSA9PiBfLmlzVW5kZWZpbmVkKGVsLmlzQXZhaWxhYmxlKSB8fCBlbC5pc0F2YWlsYWJsZSlcbiAgICAgICAgLm1hcCgoZWwpID0+IHtcbiAgICAgICAgICBkZWxldGUgZWwuYXZhaWxhYmlsaXR5O1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzZGssXG4gICAgICAgICAgICAuLi5lbCxcbiAgICAgICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybSB8fCB2ZXJzaW9uTWF0Y2hbMV0sXG4gICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsb2cuZGVidWcoYFVuYWJsZSB0byBnZXQgSlNPTiBkZXZpY2UgbGlzdDogJHtlcnIuc3RhY2t9YCk7XG4gICAgbG9nLmRlYnVnKCdGYWxsaW5nIGJhY2sgdG8gbWFudWFsIHBhcnNpbmcnKTtcbiAgICBkZXZpY2VzID0gYXdhaXQgZ2V0RGV2aWNlc0J5UGFyc2luZyhwbGF0Zm9ybSk7XG4gIH1cblxuICBpZiAoIWZvclNkaykge1xuICAgIHJldHVybiBkZXZpY2VzO1xuICB9XG4gIC8vIGlmIGEgYGZvclNka2Agd2FzIHBhc3NlZCBpbiwgcmV0dXJuIG9ubHkgdGhlIGNvcnJlc3BvbmRpbmcgbGlzdFxuICBpZiAoZGV2aWNlc1tmb3JTZGtdKSB7XG4gICAgcmV0dXJuIGRldmljZXNbZm9yU2RrXTtcbiAgfVxuXG4gIGxldCBlcnJNc2cgPSBgJyR7Zm9yU2RrfScgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGxpc3Qgb2Ygc2ltY3RsIFNES3MuYDtcbiAgY29uc3QgYXZhaWxhYmxlU0RLcyA9IF8ua2V5cyhkZXZpY2VzKTtcbiAgZXJyTXNnICs9IGF2YWlsYWJsZVNES3MubGVuZ3RoXG4gICAgPyBgIE9ubHkgdGhlIGZvbGxvd2luZyBTaW11bGF0b3IgU0RLIHZlcnNpb25zIGFyZSBhdmFpbGFibGUgb24geW91ciBzeXN0ZW06ICR7YXZhaWxhYmxlU0RLcy5qb2luKCcsICcpfWBcbiAgICA6IGAgTm8gU2ltdWxhdG9yIFNESyB2ZXJzaW9ucyBhcmUgYXZhaWxhYmxlIG9uIHlvdXIgc3lzdGVtLiBQbGVhc2UgaW5zdGFsbCBzb21lIHZpYSBYY29kZSBwcmVmZXJlbmNlcy5gO1xuICB0aHJvdyBuZXcgRXJyb3IoZXJyTXNnKTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIHJ1bnRpbWUgZm9yIHRoZSBwYXJ0aWN1bGFyIHBsYXRmb3JtIHZlcnNpb24gdXNpbmcgLS1qc29uIGZsYWdcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGxhdGZvcm1WZXJzaW9uIC0gVGhlIHBsYXRmb3JtIHZlcnNpb24gbmFtZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZXhhbXBsZSAnMTAuMycuXG4gKiBAcGFyYW0gez9zdHJpbmd9IHBsYXRmb3JtIC0gVGhlIHBsYXRmb3JtIG5hbWUsIGZvciBleGFtcGxlICd3YXRjaE9TJy5cbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIGNvcnJlc3BvbmRpbmcgcnVudGltZSBuYW1lIGZvciB0aGUgZ2l2ZW5cbiAqICAgICAgICAgICAgICAgICAgcGxhdGZvcm0gdmVyc2lvbi5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvblZpYUpzb24gKHBsYXRmb3JtVmVyc2lvbiwgcGxhdGZvcm0gPSAnaU9TJykge1xuICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IHNpbUV4ZWMoJ2xpc3QnLCAwLCBbJ3J1bnRpbWVzJywgJy0tanNvbiddKTtcbiAgZm9yIChjb25zdCB7dmVyc2lvbiwgaWRlbnRpZmllciwgbmFtZX0gb2YgSlNPTi5wYXJzZShzdGRvdXQpLnJ1bnRpbWVzKSB7XG4gICAgaWYgKHZlcnNpb24gPT09IHBsYXRmb3JtVmVyc2lvbiAmJiBuYW1lLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChwbGF0Zm9ybS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgcmV0dXJuIGlkZW50aWZpZXI7XG4gICAgfVxuICB9XG4gIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IHVzZSAtLWpzb24gZmxhZyB0byBwYXJzZSBwbGF0Zm9ybSB2ZXJzaW9uYCk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBydW50aW1lIGZvciB0aGUgcGFydGljdWxhciBwbGF0Zm9ybSB2ZXJzaW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwbGF0Zm9ybVZlcnNpb24gLSBUaGUgcGxhdGZvcm0gdmVyc2lvbiBuYW1lLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBleGFtcGxlICcxMC4zJy5cbiAqIEBwYXJhbSB7P3N0cmluZ30gcGxhdGZvcm0gLSBUaGUgcGxhdGZvcm0gbmFtZSwgZm9yIGV4YW1wbGUgJ3dhdGNoT1MnLlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgY29ycmVzcG9uZGluZyBydW50aW1lIG5hbWUgZm9yIHRoZSBnaXZlblxuICogICAgICAgICAgICAgICAgICBwbGF0Zm9ybSB2ZXJzaW9uLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRSdW50aW1lRm9yUGxhdGZvcm1WZXJzaW9uIChwbGF0Zm9ybVZlcnNpb24sIHBsYXRmb3JtID0gJ2lPUycpIHtcbiAgLy8gVHJ5IHdpdGggcGFyc2luZ1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgc2ltRXhlYygnbGlzdCcsIDAsIFsncnVudGltZXMnXSk7XG4gICAgLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci9VeWtqUVovMVxuICAgIGNvbnN0IHJ1bnRpbWVSZSA9IG5ldyBSZWdFeHAoYCR7Xy5lc2NhcGVSZWdFeHAocGxhdGZvcm0pfVxcXFxzKyhcXFxcZCtcXFxcLlxcXFxkKylcXFxccytcXFxcKChcXFxcZCtcXFxcLlxcXFxkK1xcXFwuKlxcXFxkKilgLCAnaScpO1xuICAgIGZvciAoY29uc3QgbGluZSBvZiBzdGRvdXQuc3BsaXQoJ1xcbicpKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IHJ1bnRpbWVSZS5leGVjKGxpbmUpO1xuICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdID09PSBwbGF0Zm9ybVZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoWzJdO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoaWduKSB7fVxuXG4gIC8vIGlmIG5vdGhpbmcgd2FzIGZvdW5kLCBwYXNzIHBsYXRmb3JtIHZlcnNpb24gYmFja1xuICByZXR1cm4gcGxhdGZvcm1WZXJzaW9uO1xufVxuXG4vKipcbiAqIEdldHMgYmFzZTY0IHNjcmVlbnNob3QgZm9yIGRldmljZSAoeGNvZGUgPj0gOC4xIG9ubHkpLlxuICogSXQgaXMgcmVxdWlyZWQgdGhhdCBTaW11bGF0b3IgaXMgaW4gX2Jvb3RlZF8gc3RhdGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgLSBUaGUgVURJRCBvZiBhbiBleGlzdGluZyBTaW11bGF0b3IuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEJhc2U2NC1lbmNvZGVkIFNpbXVsYXRvciBzY3JlZW5zaG90LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRTY3JlZW5zaG90ICh1ZGlkKSB7XG4gIGxldCBwYXRoVG9TY3JlZW5zaG90UG5nID0gYXdhaXQgdGVtcERpci5wYXRoKHtwcmVmaXg6IGBzY3JlZW5zaG90LSR7dWRpZH1gLCBzdWZmaXg6ICcucG5nJ30pO1xuICBhd2FpdCBzaW1FeGVjKCdpbycsIDAsIFt1ZGlkLCAnc2NyZWVuc2hvdCcsIHBhdGhUb1NjcmVlbnNob3RQbmddKTtcbiAgbGV0IHNjcmVlbnNob3RJbWcgPSBhd2FpdCBmcy5yZWFkRmlsZShwYXRoVG9TY3JlZW5zaG90UG5nKTtcbiAgYXdhaXQgZnMucmltcmFmKHBhdGhUb1NjcmVlbnNob3RQbmcpO1xuICByZXR1cm4gc2NyZWVuc2hvdEltZy50b1N0cmluZygnYmFzZTY0Jyk7XG59XG5cbi8qKlxuICogU2V0IHRoZSBjb250ZW50IG9mIFNpbXVsYXRvciBwYXN0ZWJvYXJkICh4Y29kZSA+PSA4LjEgb25seSkuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIERldmljZSBVRElELlxuICogQHBhcmFtIHtzdHJpbmd9IGNvbnRlbnQgLSBUaGUgYWN0dWFsIHN0cmluZyBjb250ZW50IHRvIGJlIHNldC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBlbmNvZGluZyBbJ3V0Zi04J10gLSBUaGUgZW5jb2Rpbmcgb2YgdGhlIGdpdmVuIHBhc3RlYm9hcmQgY29udGVudC5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBVVEYtOCBieSBkZWZhdWx0LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICovXG5hc3luYyBmdW5jdGlvbiBzZXRQYXN0ZWJvYXJkICh1ZGlkLCBjb250ZW50LCBlbmNvZGluZyA9ICd1dGYtOCcpIHtcbiAgY29uc3QgcGJDb3B5U3VicHJvY2VzcyA9IG5ldyBTdWJQcm9jZXNzKCd4Y3J1bicsIFsnc2ltY3RsJywgJ3BiY29weScsIHVkaWRdKTtcbiAgYXdhaXQgcGJDb3B5U3VicHJvY2Vzcy5zdGFydCgwKTtcbiAgY29uc3QgZXhpdENvZGVWZXJpZmllciA9IHBiQ29weVN1YnByb2Nlc3Muam9pbigpO1xuICBjb25zdCBzdGRpbiA9IHBiQ29weVN1YnByb2Nlc3MucHJvYy5zdGRpbjtcbiAgc3RkaW4uc2V0RW5jb2RpbmcoZW5jb2RpbmcpO1xuICBzdGRpbi53cml0ZShjb250ZW50KTtcbiAgc3RkaW4uZW5kKCk7XG4gIGF3YWl0IGV4aXRDb2RlVmVyaWZpZXI7XG59XG5cbi8qKlxuICogR2V0IHRoZSBjb250ZW50IG9mIFNpbXVsYXRvciBwYXN0ZWJvYXJkICh4Y29kZSA+PSA4LjEgb25seSkuXG4gKiBJdCBpcyByZXF1aXJlZCB0aGF0IFNpbXVsYXRvciBpcyBpbiBfYm9vdGVkXyBzdGF0ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIERldmljZSBVRElELlxuICogQHBhcmFtIHtzdHJpbmd9IGVuY29kaW5nIFsndXRmLTgnXSAtIFRoZSBlbmNvZGluZyBvZiB0aGUgcmV0dXJuZWQgcGFzdGVib2FyZCBjb250ZW50LlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVURi04IGJ5IGRlZmF1bHQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEN1cnJlbnQgY29udGVudCBvZiBTaW11bGF0b3IgcGFzdGVib2FyZCBvciBhbiBlbXB0eSBzdHJpbmcuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIHN1YmNvbW1hbmQgY29tbWFuZFxuICogICAgICAgICAgICAgICAgIHJldHVybnMgbm9uLXplcm8gcmV0dXJuIGNvZGUuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFBhc3RlYm9hcmQgKHVkaWQsIGVuY29kaW5nID0gJ3V0Zi04Jykge1xuICBjb25zdCBhcmdzID0gWydzaW1jdGwnLCAncGJwYXN0ZScsIHVkaWRdO1xuICB0cnkge1xuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygneGNydW4nLCBhcmdzLCB7dGltZW91dDogMCwgZW5jb2Rpbmd9KTtcbiAgICByZXR1cm4gc3Rkb3V0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUuc3RkZXJyKSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgRXJyb3IgcnVubmluZyAneGNydW4gJHthcmdzLmpvaW4oJyAnKX0nOiAke2Uuc3RkZXJyLnRyaW0oKX1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLmVycm9yQW5kVGhyb3coZSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogR2V0IHRoZSBsaXN0IG9mIGRldmljZSB0eXBlcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgWGNvZGUgaW5zdGFsbGF0aW9uXG4gKlxuICogQHJldHVybiB7QXJyYXk8c3RyaW5nPn0gTGlzdCBvZiB0aGUgdHlwZXMgb2YgZGV2aWNlcyBhdmFpbGFibGVcbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29ycmVzcG9uZGluZyBzaW1jdGwgY29tbWFuZCBmYWlsc1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXREZXZpY2VUeXBlcyAoKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWydkZXZpY2V0eXBlcycsICctaiddKTtcbiAgICAvKlxuICAgICAqIEpTT04gd2lsbCBiZSBsaWtlOlxuICAgICAqICAge1xuICAgICAqICAgICBcImRldmljZXR5cGVzXCIgOiBbXG4gICAgICogICAgICAge1xuICAgICAqICAgICAgICAgXCJuYW1lXCIgOiBcImlQaG9uZSA0c1wiLFxuICAgICAqICAgICAgICAgXCJpZGVudGlmaWVyXCIgOiBcImNvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbURldmljZVR5cGUuaVBob25lLTRzXCJcbiAgICAgKiAgICAgICB9LFxuICAgICAqICAgICAgIC4uLlxuICAgICAqICAgfVxuICAgICAqL1xuICAgIGNvbnN0IGRldmljZVR5cGVzID0gSlNPTi5wYXJzZShzdGRvdXQudHJpbSgpKTtcbiAgICByZXR1cm4gZGV2aWNlVHlwZXMuZGV2aWNldHlwZXMubWFwKCh0eXBlKSA9PiB0eXBlLm5hbWUpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBsZXQgbXNnID0gYFVuYWJsZSB0byBnZXQgbGlzdCBvZiBkZXZpY2UgdHlwZXM6ICR7ZXJyLm1lc3NhZ2V9YDtcbiAgICBpZiAoZXJyLnN0ZGVycikge1xuICAgICAgbXNnID0gYCR7bXNnfS4gU3RkZXJyOiAke2Vyci5zdGRlcnJ9YDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKG1zZyk7XG4gIH1cbn1cblxuXG4vKipcbiAqIEdldCB0aGUgZnVsbCBsaXN0IG9mIHJ1bnRpbWVzLCBkZXZpY2V0eXBlcywgZGV2aWNlcyBhbmQgcGFpcnMgYXMgT2JqZWN0XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSBPYmplY3QgY29udGFpbmluZyBkZXZpY2UgdHlwZXMsIHJ1bnRpbWVzIGRldmljZXMgYW5kIHBhaXJzXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGNvcnJlc3BvbmRpbmcgc2ltY3RsIGNvbW1hbmQgZmFpbHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0U2ltY3RsTGlzdCAoKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCBzaW1FeGVjKCdsaXN0JywgMCwgWyctaiddKTtcbiAgICAvKlxuICAgICAqIEpTT04gd2lsbCBiZSBsaWtlXG4gICAgICogICB7XG4gICAgICogICAgIFwiZGV2aWNldHlwZXNcIiA6IFtcbiAgICAgKiAgICAgICB7XG4gICAgICogICAgICAgICBcIm5hbWVcIiA6IFwiaVBob25lIDRzXCIsXG4gICAgICogICAgICAgICBcImlkZW50aWZpZXJcIiA6IFwiY29tLmFwcGxlLkNvcmVTaW11bGF0b3IuU2ltRGV2aWNlVHlwZS5pUGhvbmUtNHNcIlxuICAgICAqICAgICAgIH0sXG4gICAgICogICAgICAgLi4uXG4gICAgICogICAgICBdLFxuICAgICAqICAgICBcInJ1bnRpbWVzXCIgOiBbXG4gICAgICogICAgICAge1xuICAgICAqICAgICAgICAgXCJ2ZXJzaW9uXCIgOiAnMTMuMCcsXG4gICAgICogICAgICAgICBcImJ1bmRsZVBhdGhcIiA6ICcvQXBwbGljYXRpb25zL1hjb2RlMTFiZXRhNC5hcHAvQ29udGVudHMvRGV2ZWxvcGVyL1BsYXRmb3Jtcy9pUGhvbmVPUy5wbGF0Zm9ybS9MaWJyYXJ5L0RldmVsb3Blci9Db3JlU2ltdWxhdG9yL1Byb2ZpbGVzL1J1bnRpbWVzL2lPUy5zaW1ydW50aW1lJyxcbiAgICAgKiAgICAgICAgIFwiaXNBdmFpbGFibGVcIiA6IHRydWUsXG4gICAgICogICAgICAgICBcIm5hbWVcIiA6ICdpT1MgMTMuMCcsXG4gICAgICogICAgICAgICBcImlkZW50aWZpZXJcIiA6ICdjb20uYXBwbGUuQ29yZVNpbXVsYXRvci5TaW1SdW50aW1lLmlPUy0xMy0wJyxcbiAgICAgKiAgICAgICAgIFwiYnVpbGR2ZXJzaW9uXCIgOiAnMTdBNTUzNGQnXG4gICAgICogICAgICAgfSxcbiAgICAgKiAgICAgICAuLi5cbiAgICAgKiAgICAgIH0sXG4gICAgICogICAgIFwiZGV2aWNlc1wiIDpcbiAgICAgKiAgICAgICB7XG4gICAgICogICAgICAgICAnY29tLmFwcGxlLkNvcmVTaW11bGF0b3IuU2ltUnVudGltZS5pT1MtMTMtMCc6IFsgW09iamVjdF0sIFtPYmplY3RdIF0gfSxcbiAgICAgKiAgICAgICAgIC4uLlxuICAgICAqICAgICAgIH0sXG4gICAgICogICAgIFwicGFpcnNcIiA6IHt9IH1cbiAgICAgKlxuICAgICAqICAgfVxuICAgICAqL1xuICAgIHJldHVybiBKU09OLnBhcnNlKHN0ZG91dCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxldCBtc2cgPSBgVW5hYmxlIHRvIGdldCBzaW1jdGwgbGlzdDogJHtlcnIubWVzc2FnZX1gO1xuICAgIGlmIChlcnIuc3RkZXJyKSB7XG4gICAgICBtc2cgPSBgJHttc2d9LiBTdGRlcnI6ICR7ZXJyLnN0ZGVycn1gO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgfVxufVxuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEJvb3RNb25pdG9yT3B0aW9uc1xuICogQHByb3BlcnR5IHs/bnVtYmVyfSB0aW1lb3V0IFsyNDAwMDBdIC0gU2ltdWxhdG9yIGJvb3RpbmcgdGltZW91dCBpbiBtcy5cbiAqIEBwcm9wZXJ0eSB7P0Z1bmN0aW9ufSBvbldhaXRpbmdEYXRhTWlncmF0aW9uIC0gVGhpcyBldmVudCBpcyBmaXJlZCB3aGVuIGRhdGEgbWlncmF0aW9uIHN0YWdlIHN0YXJ0cy5cbiAqIEBwcm9wZXJ0eSB7P0Z1bmN0aW9ufSBvbldhaXRpbmdTeXN0ZW1BcHAgLSBUaGlzIGV2ZW50IGlzIGZpcmVkIHdoZW4gc3lzdGVtIGFwcCB3YWl0IHN0YWdlIHN0YXJ0cy5cbiAqIEBwcm9wZXJ0eSB7P0Z1bmN0aW9ufSBvbkZpbmlzaGVkIC0gVGhpcyBldmVudCBpcyBmaXJlZCB3aGVuIFNpbXVsYXRvciBpcyBmdWxseSBib290ZWQuXG4gKiBAcHJvcGVydHkgez9GdW5jdGlvbn0gb25FcnJvciAtIFRoaXMgZXZlbnQgaXMgZmlyZWQgd2hlbiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgbW9uaXRvcmluZyB0aGUgYm9vdGluZyBwcm9jZXNzXG4gKiBvciB3aGVuIHRoZSB0aW1lb3V0IGhhcyBleHBpcmVkLlxuICovXG5cbi8qKlxuICogU3RhcnQgbW9uaXRvcmluZyBmb3IgYm9vdCBzdGF0dXMgb2YgdGhlIHBhcnRpY3VsYXIgU2ltdWxhdG9yLlxuICogSWYgb25GaW5pc2hlZCBwcm9wZXJ0eSBpcyBub3Qgc2V0IHRoZW4gdGhlIG1ldGhvZCB3aWxsIGJsb2NrXG4gKiB1bnRpbCBTaW11bGF0b3IgYm9vdGluZyBpcyBjb21wbGV0ZWQuXG4gKiBUaGUgbWV0aG9kIGlzIG9ubHkgYXZhaWxhYmxlIHNpbmNlIFhjb2RlOC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCAtIERldmljZSBVRElELlxuICogQHBhcmFtIHs/Qm9vdE1vbml0b3JPcHRpb25zfSBvcHRzIC0gTW9uaXRvcmluZyBvcHRpb25zLlxuICogQHJldHVybnMge1N1YlByb2Nlc3N9IFRoZSBpbnN0YW5jZSBvZiB0aGUgY29ycmVzcG9uZGluZyBtb25pdG9yaW5nIHByb2Nlc3MuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIFNpbXVsYXRvciBmYWlscyB0byBmaW5pc2ggYm9vdGluZyB3aXRoaW4gdGhlIGdpdmVuIHRpbWVvdXQgYW5kIG9uRmluaXNoZWRcbiAqIHByb3BlcnR5IGlzIG5vdCBzZXQuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0Qm9vdE1vbml0b3IgKHVkaWQsIG9wdHMgPSB7fSkge1xuICBjb25zdCB7XG4gICAgdGltZW91dCA9IDI0MDAwMCxcbiAgICBvbldhaXRpbmdEYXRhTWlncmF0aW9uLFxuICAgIG9uV2FpdGluZ1N5c3RlbUFwcCxcbiAgICBvbkZpbmlzaGVkLFxuICAgIG9uRXJyb3IsXG4gIH0gPSBvcHRzO1xuXG4gIGxldCBzdGF0dXMgPSAnJztcbiAgbGV0IGlzQm9vdGluZ0ZpbmlzaGVkID0gZmFsc2U7XG4gIGxldCBlcnJvciA9IG51bGw7XG4gIGxldCB0aW1lb3V0SGFuZGxlciA9IG51bGw7XG4gIGNvbnN0IGJvb3RNb25pdG9yID0gYXdhaXQgc2ltU3ViUHJvY2VzcygnYm9vdHN0YXR1cycsIDAsIFt1ZGlkXSk7XG4gIGJvb3RNb25pdG9yLm9uKCdvdXRwdXQnLCAoc3Rkb3V0LCBzdGRlcnIpID0+IHtcbiAgICBzdGF0dXMgKz0gc3Rkb3V0IHx8IHN0ZGVycjtcbiAgICBpZiAoc3Rkb3V0KSB7XG4gICAgICBpZiAoc3Rkb3V0LmluY2x1ZGVzKCdXYWl0aW5nIG9uIERhdGEgTWlncmF0aW9uJykgJiYgb25XYWl0aW5nRGF0YU1pZ3JhdGlvbikge1xuICAgICAgICBvbldhaXRpbmdEYXRhTWlncmF0aW9uKCk7XG4gICAgICB9IGVsc2UgaWYgKHN0ZG91dC5pbmNsdWRlcygnV2FpdGluZyBvbiBTeXN0ZW0gQXBwJykgJiYgb25XYWl0aW5nU3lzdGVtQXBwKSB7XG4gICAgICAgIG9uV2FpdGluZ1N5c3RlbUFwcCgpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIGJvb3RNb25pdG9yLm9uKCdleGl0JywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgIGlmICh0aW1lb3V0SGFuZGxlcikge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRIYW5kbGVyKTtcbiAgICB9XG4gICAgaWYgKGNvZGUgPT09IDApIHtcbiAgICAgIGlmIChvbkZpbmlzaGVkKSB7XG4gICAgICAgIG9uRmluaXNoZWQoKTtcbiAgICAgIH1cbiAgICAgIGlzQm9vdGluZ0ZpbmlzaGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdHVzID0gc3RhdHVzIHx8IHNpZ25hbDtcbiAgICAgIGVycm9yID0gbmV3IEVycm9yKHN0YXR1cyk7XG4gICAgICBpZiAob25FcnJvcikge1xuICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBhd2FpdCBib290TW9uaXRvci5zdGFydCgwKTtcbiAgY29uc3Qgc3RvcE1vbml0b3IgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKGJvb3RNb25pdG9yLmlzUnVubmluZykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgYm9vdE1vbml0b3Iuc3RvcCgpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cud2FybihlLm1lc3NhZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgdGltZVN0YXJ0ZWQgPSBwcm9jZXNzLmhydGltZSgpO1xuICBpZiAob25GaW5pc2hlZCkge1xuICAgIHRpbWVvdXRIYW5kbGVyID0gc2V0VGltZW91dChzdG9wTW9uaXRvciwgdGltZW91dCk7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHdhaXRGb3JDb25kaXRpb24oKCkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNCb290aW5nRmluaXNoZWQ7XG4gICAgICB9LCB7d2FpdE1zOiB0aW1lb3V0LCBpbnRlcnZhbE1zOiA1MDB9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGF3YWl0IHN0b3BNb25pdG9yKCk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBzaW11bGF0b3IgJHt1ZGlkfSBoYXMgZmFpbGVkIHRvIGZpbmlzaCBib290aW5nIGFmdGVyICR7cHJvY2Vzcy5ocnRpbWUodGltZVN0YXJ0ZWQpWzBdfXMuIGAgK1xuICAgICAgICBgT3JpZ2luYWwgc3RhdHVzOiAke3N0YXR1c31gKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGJvb3RNb25pdG9yO1xufVxuXG5cbmV4cG9ydCB7XG4gIGluc3RhbGxBcHAsIHJlbW92ZUFwcCwgbGF1bmNoLCBzcGF3biwgc3Bhd25TdWJQcm9jZXNzLCBvcGVuVXJsLCB0ZXJtaW5hdGUsXG4gIHNodXRkb3duLCBjcmVhdGVEZXZpY2UsIGdldEFwcENvbnRhaW5lciwgZ2V0U2NyZWVuc2hvdCwgZGVsZXRlRGV2aWNlLFxuICBlcmFzZURldmljZSwgZ2V0RGV2aWNlcywgZ2V0UnVudGltZUZvclBsYXRmb3JtVmVyc2lvbiwgYm9vdERldmljZSxcbiAgc2V0UGFzdGVib2FyZCwgZ2V0UGFzdGVib2FyZCwgYWRkTWVkaWEsIGFwcEluZm8sIGdldERldmljZVR5cGVzLFxuICBzdGFydEJvb3RNb25pdG9yLCBnZXRTaW1jdGxMaXN0XG59O1xuIl0sImZpbGUiOiJsaWIvc2ltY3RsLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uIn0=
